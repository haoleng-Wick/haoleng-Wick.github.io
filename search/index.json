[{"content":"Gentoo æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç°ä»£åŒ–çš„ Linux å‘è¡Œç‰ˆï¼Œå®ƒçš„è®¾è®¡ç®€æ´ã€çµæ´»ã€‚Gentoo å›´ç»•è‡ªç”±è½¯ä»¶å»ºç«‹ï¼Œå®ƒä¸ä¼šå¯¹å®ƒçš„ç”¨æˆ·éšç’â€œå¼•æ“ç›–ä¸‹çš„ç»†èŠ‚â€ã€‚Gentoo æ‰€ä½¿ç”¨çš„è½¯ä»¶åŒ…ç»´æŠ¤ç³»ç»Ÿ Portage æ˜¯ç”¨ Python ç¼–å†™çš„ï¼Œè¿™æ„å‘³ç€ç”¨æˆ·å¯ä»¥è½»æ¾åœ°æŸ¥çœ‹å’Œä¿®æ”¹å®ƒçš„æºä»£ç ã€‚ Gentoo çš„è½¯ä»¶åŒ…ç®¡ç†ç³»ç»Ÿä½¿ç”¨æºä»£ç åŒ…ï¼ˆè™½ç„¶ä¹Ÿæ”¯æŒé¢„ç¼–è¯‘è½¯ä»¶åŒ…ï¼‰ï¼Œå¹¶é€šè¿‡æ ‡å‡†çš„æ–‡æœ¬æ–‡ä»¶é…ç½®Gentooã€‚æ¢å¥è¯è¯´ï¼Œå¼€æ”¾æ— å¤„ä¸åœ¨ã€‚ \u0026mdash;\u0026mdash;- æ‘˜æŠ„è‡ªGentoo Wiki\nå®‰è£…çš„æ€»æµç¨‹ å¼ºçƒˆå»ºè®®å‚è€ƒWiki\næˆ‘åœ¨è¿™é‡Œåªæ˜¯åšäº†ä¸€äº›ç®€å•çš„è®°å½•ï¼Œè€Œä¸”å¯èƒ½å› ä¸ºç‰ˆæœ¬è¿­ä»£ä¸å†é€‚ç”¨ï¼Œå¼ºçƒˆå»ºè®®å‚è€ƒå®˜æ–¹Wikiã€‚\nå‡†å¤‡å¥½é•œåƒå’Œç¯å¢ƒ äº’è”ç½‘è¿æ¥ å®Œæˆåˆ†åŒº å¹¶æŒ‚è½½ chrootï¼Œå®‰è£…æ ¸å¿ƒéƒ¨ä»¶ é…ç½®å¹¶ç¼–è¯‘å†…æ ¸ åˆ›å»ºå¤§éƒ¨åˆ†Gentooçš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ å¿…è¦çš„ç³»ç»Ÿå·¥å…·å®‰è£… å¼•å¯¼ç¨‹åºå®‰è£… é€€å‡ºlivecdç¯å¢ƒå¹¶è¿›å…¥æ–°ç³»ç»Ÿ æ·»åŠ ç”¨æˆ·é…ç½®å›¾å½¢ç•Œé¢ç­‰ ä¸‹è½½é•œåƒå¹¶è¿›å…¥LiveCD æœ¬äººæ˜¯åœ¨æ¸…åå¤§å­¦é•œåƒç«™ä¸‹è½½çš„isoé•œåƒï¼Œé“¾æ¥å¦‚ä¸‹\né•œåƒä¼ é€é—¨ï¼Œé€‰æ‹©åˆé€‚çš„é•œåƒä¸‹è½½ã€‚\nç„¶ååˆ¶ä½œUç›˜å¯åŠ¨å™¨ï¼Œæ¨èä½¿ç”¨Ventoy\nUç›˜æ’å…¥ç”µè„‘é€‰æ‹©å¯åŠ¨é¡¹å¯åŠ¨ï¼Œé€‰æ‹©gentooé»˜è®¤å†…æ ¸å¯åŠ¨\nå‰ç½®å‡†å¤‡ è”ç½‘ping www.baidu.com\næœ‰çº¿ç½‘çš„è¯æœ¬äººä½¿ç”¨æ‰‹æœºè”ç½‘é€šè¿‡USBå…±äº«ç»™LiveCDï¼Œä½¿ç”¨dhcpcdå‘½ä»¤ æ— çº¿ç½‘çš„è¯å¯ä»¥ä½¿ç”¨wpa_supplicant -i \u0026lt;dev\u0026gt; -c \u0026lt;(wpa_passphrase [SSID] [passwd])\u0026gt; ç¡¬ç›˜åˆ†åŒº\nåˆ†åŒºå·¥å…·å»ºè®®ä½¿ç”¨fdiskï¼Œåˆ†åŒºå‰å»ºè®®ä½¿ç”¨lsblkæŸ¥çœ‹\nUEFI or BIOS å¼•å¯¼åˆ†åŒºï¼ˆUEFIå»ºè®®256MBåŠä»¥ä¸Šï¼‰ swap ï¼ˆå¦‚æœå†…å­˜è¶³å¤Ÿå¯ä»¥ä¸è¦ï¼Œå¦‚æœå†…å­˜ä¸è¶³ï¼Œå»ºè®®è®¾ç½®ä¸ºRAMx2ï¼‰ root æ ¹ç›®å½•ï¼ˆå…¶å®æœ¬äººå¹¶ä¸å»ºè®®ä¸ºhomeç›®å½•å•ç‹¬åˆ†ä¸€ä¸ªåˆ†åŒºï¼Œå› ä¸ºæˆ‘è§‰å¾—å¯¹äºssdæ¥è¯´æ²¡å¿…è¦ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªå…±ç”¨åŒºntfç»™Windowsï¼‰ åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿï¼ˆä»¥sdaä¸ºä¾‹ï¼‰\nUEFIåˆ†åŒºmkfs.vfat -F 32 /dev/sda1 swapåˆ†åŒºï¼šåˆå§‹åŒ–mkswap /dev/sda2ï¼Œæ¿€æ´»swapon /dev/sda2 rootåˆ†åŒºmkfs.ext4 /dev/sda3 å¼€å§‹å®‰è£… æŒ‚è½½\n1 2 3 4 5 mkdir --parents /mnt/gentoo mount /dev/sda3 /mnt/gentoo # å¦‚æœ/tmp/éœ€è¦æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„åˆ†åŒºï¼Œè¯·ç¡®ä¿å…¶åœ¨æŒ‚è½½åæœ‰å¯¹åº”çš„æƒé™ chmod 1777 /mnt/gentoo/tmp å®‰è£…Gentooå®‰è£…æ–‡ä»¶\nç¡®ä¿æ—¶é—´æ­£ç¡®dateï¼Œä»äº’è”ç½‘ä¸‹è½½stage3å½’æ¡£æ–‡ä»¶ï¼Œå»ºè®®ä½¿ç”¨links https://mirrors.tuna.tsinghua.edu.cn/gentoo/å‘½ä»¤è¡Œæµè§ˆå™¨è¿›å…¥tuiç•Œé¢è¿›è¡Œä¸‹è½½ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ç”¨å…¶ä»–çš„ç”µè„‘ä¸‹è½½åˆ°ç¡¬ç›˜åç›´æ¥æŒ‚è½½å¯¼å…¥åˆ°å½“å‰åœ°å€\nä¸‹è½½å®Œæˆä¹‹åå°†ä¸‹è½½çš„å½’æ¡£æ–‡ä»¶è§£å‹åˆ°æ–°ç³»ç»Ÿæ ¹ç›®å½•\n1 tar xpvf stage3-amd64-desktop-openrc-20230521T160357Z.tar.xz --xattrs-include=\u0026#39;*.*\u0026#39; --numeric-owner ç„¶åé…ç½®ç¼–è¯‘é€‰é¡¹\nnano -w /mnt/gentoo/etc/portage/make.conf\næœ¬äººçš„make.confæ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 # These settings were set by the catalyst build script that automatically # built this stage. # Please consult /usr/share/portage/config/make.conf.example for a more # detailed example. COMMON_FLAGS=\u0026#34;-march=native -O2 -pipe\u0026#34; CFLAGS=\u0026#34;${COMMON_FLAGS}\u0026#34; CXXFLAGS=\u0026#34;${COMMON_FLAGS}\u0026#34; FCFLAGS=\u0026#34;${COMMON_FLAGS}\u0026#34; FFLAGS=\u0026#34;${COMMON_FLAGS}\u0026#34; # NOTE: This stage was built with the bindist Use flag enabled # This sets the language of build output to English. # Please keep this setting intact when reporting bugs. LC_MESSAGES=C.utf8 MAKEOPTS=\u0026#34;-j4\u0026#34; ACCEPT_LICENSE=\u0026#34;*\u0026#34; ACCEPT_KEYWORDS=\u0026#34;amd64\u0026#34; GENTOO_MIRRORS=\u0026#34;https://mirrors.aliyun.com/gentoo/ http://mirrors.aliyun.com/gentoo/ https://mirrors.tuna.tsinghua.edu.cn/gentoo\u0026#34; GRUB_PLATFORMS=\u0026#34;efi-64\u0026#34; # USE USE=\u0026#34;networkmanager savedconfig X elogind alsa icu zsh-completion -systemd\u0026#34; # Xorg # support for touchpad, mouse, and keyboard INPUT_DEVICES=\u0026#34;synaptics libinput\u0026#34; é…ç½®å¹¶Chrootè¿›å…¥æ–°ç³»ç»Ÿç¯å¢ƒ\né€‰æ‹©é•œåƒmirroselect -i -o \u0026gt;\u0026gt; /mnt/gentoo/etc/portage/make.confï¼Œ\né…ç½®è½¯ä»¶ä»“åº“mkdir --parents /mnt/gentoo/etc/portage/repos.confï¼Œ\nå¤åˆ¶Portageæä¾›çš„Gentooä»“åº“é…ç½®æ–‡ä»¶åˆ°æ–°åˆ›å»ºçš„ç›®å½•cp /mnt/gentoo/usr/share/portage/config/repos.conf /mnt/gentoo/etc/portage/repos.conf/gentoo.conf\nå¤åˆ¶DNSä¿¡æ¯ï¼Œä¸ç„¶è¿›æ–°ç¯å¢ƒåä¼šæ²¡æœ‰ç½‘ç»œcp --dereference /etc/resolv.conf /mnt/gentoo/etc/\næŒ‚è½½å¿…è¦çš„æ–‡ä»¶ç³»ç»Ÿ\n1 2 3 4 5 6 7 mount --types proc /proc /mnt/gentoo/proc mount --rbind /sys /mnt/gentoo/sys mount --make-rslave /mnt/gentoo/sys mount --rbind /dev /mnt/gentoo/dev mount --make-rslave /mnt/gentoo/dev mount --bind /run /mnt/gentoo/run mount --make-slave /mnt/gentoo/run #----# ä¸ºsystemdæä¾›çš„ Chroot\n1 2 3 4 5 6 chroot /mnt/gentoo /bin/bash source /etc/profile export PS1=\u0026#34;(chroot) ${PS1}\u0026#34; # æŒ‚è½½bootåˆ†åŒº mount /dev/sda1 /boot é…ç½®Portage\nä»ç½‘ç«™å®‰è£…ebuildæ•°æ®åº“å¿«ç…§emerge-webrsync æ›´æ–°ebuildæ•°æ®åº“emerge --sync é€‰æ‹©æ­£ç¡®çš„é…ç½®æ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 eselect profile list Available profile symlink targets: [1] default/linux/amd64/17.1 (stable) [2] default/linux/amd64/17.1/selinux (stable) [3] default/linux/amd64/17.1/hardened (stable) [4] default/linux/amd64/17.1/hardened/selinux (stable) [5] default/linux/amd64/17.1/desktop (stable) * [6] default/linux/amd64/17.1/desktop/gnome (stable) [7] default/linux/amd64/17.1/desktop/gnome/systemd (stable) [8] default/linux/amd64/17.1/desktop/gnome/systemd/merged-usr (stable) ...... eselect profile set 5\næ›´æ–°@worldé›†åˆemerge --ask --verbose --update --deep --newuse @world æˆ–è€… emerge -avuDN @world é…ç½®USEå˜é‡ è§æˆ‘ä¸Šé¢å±•ç¤ºçš„make.conf æ—¶åŒºã€åŒºåŸŸé…ç½®ï¼ˆOpenRCï¼‰\né€‰æ‹©ç³»ç»Ÿæ—¶åŒºecho \u0026quot;Asia/Shanghai\u0026quot; \u0026gt; /etc/timezoneï¼Œemerge --config sys-libs/timezone-data åŒºåŸŸé…ç½®nano -w /etc/locale.gen å¯ç”¨en_US.UTF-8 UTF-8å’Œzh_CN.UTF-8 UTF-8ï¼Œç„¶åæ‰§è¡Œlocale-gen é€‰æ‹©åŒºåŸŸeselect locale listæˆ‘é€‰çš„æ˜¯en_US.utf8 é‡æ–°åŠ è½½ç¯å¢ƒenv-update \u0026amp;\u0026amp; source /etc/profile \u0026amp;\u0026amp; export PS1=\u0026quot;(chroot) ${PS1}\u0026quot; å®‰è£…å¾®ç å’Œå›ºä»¶\nå›ºä»¶ emerge --ask sys-kernel/linux-firmware\nå¾®ç  emerge --ask sys-firmware/intel-microcode\nå…¶ä¸­ï¼ŒAMDå¤„ç†å™¨çš„å¾®ç å·²ç»åœ¨linux-firmwareå›ºä»¶é‡Œé¢åŒ…å«äº†\nç¼–è¯‘å†…æ ¸ï¼ˆå†²ï¼ï¼ï¼‰\næˆ‘ä½¿ç”¨çš„æ˜¯Genkernel\næ¥å—ç³»ç»ŸèŒƒå›´ä»»æ„è½¯ä»¶çš„è®¸å¯è¯ï¼Œä¹Ÿå¯ä»¥åœ¨/etc/portage/make.confä¸­è®¾ç½®ã€‚ mkdir /etc/portage/package.license\nå®‰è£…genkernelåŒ… emerge --ask sys-kernel/genkernel\nç¼–è¯‘å†…æ ¸æºç å¹¶å®‰è£… genkernel --mountboot --install all\nç¬¬ä¸€æ¬¡å¯èƒ½æ¯”è¾ƒæ…¢ï¼Œå½“ç„¶å¦‚æœä½ çš„ç”µè„‘æ€§èƒ½å¥½ï¼Œä¹Ÿå¯èƒ½ä¼šç¼–è¯‘çš„å¾ˆå¿«ï¼ŒHowerverï¼Œç­‰åˆ°ç¼–è¯‘æµè§ˆå™¨çš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°æ˜¯å¤„ç†å™¨æ€§èƒ½å’Œå†…å­˜å¤§å°å¯¹è¿™å½±å“è¿˜æ˜¯å¾ˆå¤§çš„ (ç¡®ä¿¡) ã€‚\né…ç½®ç³»ç»Ÿå¹¶å®Œæˆå®‰è£… fstab\nå»ºè®®ä½¿ç”¨UUIDï¼Œ blkidå‘½ä»¤å¯ä»¥æŸ¥çœ‹UUID å†…é™„æˆ‘çš„fstabæ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 # \u0026lt;fs\u0026gt; \u0026lt;mountpoint\u0026gt; \u0026lt;type\u0026gt; \u0026lt;opts\u0026gt; \u0026lt;dump/pass\u0026gt; # NOTE: If your BOOT partition is ReiserFS, add the notail option to opts. # # NOTE: Even though we list ext4 as the type here, it will work with ext2/ext3 # filesystems. This just tells the kernel to use the ext4 driver. # # NOTE: You can use full paths to devices like /dev/sda3, but it is often # more reliable to use filesystem labels or UUIDs. See your filesystem # documentation for details on setting a label. To obtain the UUID, use # the blkid(8) command. #LABEL=boot /boot ext4 noauto,noatime 1 2 #UUID=58e72203-57d1-4497-81ad-97655bd56494 / ext4 noatime 0 1 #LABEL=swap none swap sw 0 0 #/dev/cdrom /mnt/cdrom auto noauto,ro 0 0 # /dev/sda1 UUID=\u0026#34;80AE-02C2\u0026#34; /boot vfat defaults,noatime 0 2 # /dev/sda2 UUID=\u0026#34;711c9bab-9f43-4ebf-8817-1712928b6a89\u0026#34; / ext4 defaults,noatime,discard 0 1 # /dev/sda3 UUID=\u0026#34;6676917276914429\u0026#34; /home/haoleng/Public ntfs defaults,noatime,discard 0 1 ç½‘ç»œé…ç½®\nrootå¯†ç passwd\nOpenRC\næŸ¥çœ‹/etc/rc.confçš„æ³¨é‡Šå¹¶æ ¹æ®éœ€æ±‚ä¿®æ”¹\nå®‰è£…ç³»ç»Ÿæ—¥å¿—å·¥å…·emerge --ask app-admin/sysklogdï¼Œæ›´æ–°åº”ç”¨é…ç½®rc-update add sysklogd default\næ—¶é—´åŒæ­¥emerge --ask net-misc/chronyï¼Œè¿è¡Œrc-update add chronyd default\nç½‘ç»œå·¥å…·NetworkManager\nå¼•å¯¼ç¨‹åºGRUBï¼ˆUEFIï¼‰\nå®‰è£…Grub echo 'GRUB_PLATFORMS=\u0026quot;efi-64\u0026quot;' \u0026gt;\u0026gt; /etc/portage/make.confï¼Œ emerge --ask sys-boot/grub\næ¿€æ´»Grub grub-install --target=x86_64-efi --efi-directory=/boot --removable\nç”ŸæˆGrubé…ç½®æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 sudo grub-mkconfig -o /boot/grub/grub.cfg å¯†ç ï¼š æ­£åœ¨ç”Ÿæˆ grub é…ç½®æ–‡ä»¶ ... æ‰¾åˆ°ä¸»é¢˜ï¼š/usr/share/grub/themes/Cyberpunk/theme.txt æ‰¾åˆ° Linux é•œåƒï¼š/boot/vmlinuz-6.1.28-gentoo-x86_64 æ‰¾åˆ° initrd é•œåƒï¼š/boot/initramfs-6.1.28-gentoo-x86_64.img è­¦å‘Šï¼š os-prober will not be executed to detect other bootable partitions. Systems on them will not be added to the GRUB boot configuration. Check GRUB_DISABLE_OS_PROBER documentation entry. Adding boot menu entry for UEFI Firmware Settings ... å®Œæˆ ç„¶åå°±å¯ä»¥é‡å¯è¿›å…¥æ–°ç³»ç»Ÿäº†ã€‚\né‡æ–°å¯åŠ¨æ­£å¸¸å°†è¿›å…¥ç³»ç»Ÿä¹‹åï¼Œå°±è¦è‡ªå·±åˆ›å»ºä¸€ä¸ªæ—¥å¸¸ä½¿ç”¨çš„ç”¨æˆ·äº†ï¼Œç„¶åè®°å¾—å®‰è£…sudo å¹¶ä¸”ä¿®æ”¹ç”¨æˆ·æƒé™ã€‚ æ­å–œä½ ï¼Œå®Œæˆäº†Gentoo Linux çš„å®‰è£…å·¥ä½œï¼Œç„¶åå°±è¦å¼€å§‹è¿›è¡Œä¸ªäººçš„é…ç½®å·¥ä½œäº†ã€‚ä¸‹é¢æ˜¯ä¸€äº›æˆ‘è‡ªå·±çš„éšæ‰‹å°è®°ï¼Œæƒ³è¦äº†è§£çš„è¯å¯ä»¥ç»§ç»­é˜…è¯»ã€‚\nå®‰è£…åç›¸å…³é—®é¢˜è®°å½• åŒ…ç®¡ç†å™¨ Portageæ˜¯ç”¨Pythonå’ŒBashä¸¤ç§è¯­è¨€ç¼–å†™çš„ï¼ŒPortageè½¯ä»¶ç³»ç»Ÿæ˜¯Gentooæœ€æ˜¾è‘—çš„ç‰¹è‰²ä¹‹ä¸€ã€‚\nGentooæ˜¯æ»šåŠ¨å‘è¡Œç‰ˆï¼Œéœ€è¦å°†è½¯ä»¶ä»“åº“ä¸ä¸Šæ¸¸åŒæ­¥:\nsudo emaint --auto sync\nç„¶åå†æ›´æ–°æ•´ä¸ªç³»ç»Ÿ:\nsudo emerge --ask --verbose --update --deep --newuse @world\nå†…æ ¸çš„æ›´æ–°å¯ä»¥å‚è€ƒ\u0026ndash;\u0026gt;æ›´æ–°å†…æ ¸\nè·å–æ–°çš„å†…æ ¸æºç ï¼ˆä¸€èˆ¬ä¼šåœ¨æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…çš„æ—¶å€™è‡ªè¡Œä¸‹è½½å®Œæˆï¼‰\nå½“ç„¶æ‚¨ä¹Ÿå¯ä»¥å•ç‹¬ä¸‹è½½\nsudo emerge --ask sys-kernel/gentoo-sources\nä½¿ç”¨eselectè®¾ç½®ä¸€ä¸ªç¬¦å·é“¾æ¥åˆ°æ–°çš„å†…æ ¸æºç \n1 2 3 4 â¯ sudo eselect kernel list Available kernel symlink targets: [1] linux-6.1.31-gentoo * â¯ sudo eselect kernel set 1 å½“ç„¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨é“¾æ¥\nln -sf /usr/src/linux-6.1.31-gentoo /usr/src/linux\nç§»åŠ¨åˆ°æ–°å†…æ ¸æ–‡ä»¶å¤¹å¹¶é…ç½®\nç§»åŠ¨åˆ°æ–°å†…æ ¸æ–‡ä»¶å¤¹cd /usr/src/linux\né…ç½®æ–°å†…æ ¸make menuconfigï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨æ—§å†…æ ¸çš„é…ç½®make olddefconfigï¼Œè¯¥å‘½ä»¤ä¼šä¿æŒæ‰€æœ‰æ—§çš„.configçš„é€‰é¡¹å¹¶å°†æ—§å†…æ ¸æ²¡æœ‰åŒ…æ‹¬çš„æ–°çš„å†…æ ¸é€‰é¡¹è®¾ç½®ä¸ºé»˜è®¤å€¼\nç„¶åç¼–è¯‘å†…æ ¸ï¼Œæœ¬äººæ¯”è¾ƒèœï¼Œé‡‡ç”¨çš„æ˜¯è‡ªåŠ¨ç¼–è¯‘çš„å·¥å…·genkernel\nGenkernelè‡ªåŠ¨æ„å»ºå’Œå®‰è£…\ngenkernel allå¯ä»¥è‡ªåŠ¨æ„å»ºå’Œå®‰è£…å†…æ ¸åˆ°/usr/src/linuxç¬¦å·é“¾æ¥æŒ‡å‘çš„$BOOTDIRå’Œå¼•å¯¼ç¨‹åº\nå¦‚æœè¿˜æœ‰å¤–éƒ¨å†…æ ¸æ¨¡å—å¦‚nvidiaç­‰éœ€è¦å†é‡æ–°ç¼–è¯‘ä¸€æ¬¡\nsudo make modules_prepare sudo emerge --ask @module-rebuid\næœ€åå°†å†…æ ¸æ›´æ–°åˆ°å¼•å¯¼ç¨‹åº\nsudo grub-mkconfig -o /boot/grub/grub.cfg\nå®‰è£…å’Œå¸è½½è½¯ä»¶ï¼ˆä»¥mpvä¸ºä¾‹ï¼‰ å®‰è£…mpvæ’­æ”¾å™¨\nsudo emerge --ask media-video/mpv\nè¯¥è¿‡ç¨‹ä¼šä»è½¯ä»¶æºä¸‹è½½æºä»£ç å¹¶é»˜è®¤å­˜åœ¨/var/cache/distfiles/ä¸­ï¼Œç„¶åè§£å‹ç¼©ã€ç¼–è¯‘å’Œå®‰è£…è¯¥è½¯ä»¶åŒ…ã€‚å¦‚æœä»…ä¸‹è½½æºä»£ç è€Œä¸å®‰è£…ï¼Œå¯ä»¥æ·»åŠ --fetchonlyåˆ°emergeå‘½ä»¤\nå¸è½½mpvæ’­æ”¾å™¨\nsudo emerge --deselect media-video/mpv\nè¯¥å‘½ä»¤å‘Šè¯‰Protageè¿™ä¸ªè½¯ä»¶åŒ…ç°åœ¨ä¸éœ€è¦äº†ï¼Œå¯ä»¥é€šè¿‡--depcleanæ¸…ç†æ‰ æ³¨æ„emerge --depcleanæ˜¯ä¸€é¡¹å±é™©çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ª-pé€‰é¡¹æ¥åªåˆ—å‡ºè¿™äº›åŒ…è€Œä¸åˆ é™¤ä»–ä»¬ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š\nsudo emerge -p --depclean\nttyè‡ªåŠ¨ç™»å½• æˆ‘ç”¨çš„initæ˜¯OpenRCï¼Œåœ¨å®‰è£…ç³»ç»Ÿæ—¶å·²ç»é™„å¸¦å®‰è£…äº†sysvinit å› æ­¤ç›´æ¥ç¼–è¾‘/etc/inittabæ–‡ä»¶ä¿®æ”¹ä¸ºå¦‚ä¸‹æ ·å¼ï¼š\n1 2 3 4 5 6 7 # TERMINALS c1:12345:respawn:/sbin/agetty --autologin \u0026lt;username\u0026gt; --noclear 38400 tty1 linux c2:2345:respawn:/sbin/agetty 38400 tty2 linux c3:2345:respawn:/sbin/agetty 38400 tty3 linux c4:2345:respawn:/sbin/agetty 38400 tty4 linux c5:2345:respawn:/sbin/agetty 38400 tty5 linux c6:2345:respawn:/sbin/agetty 38400 tty6 linux åŒç³»ç»Ÿæ—¶é—´åŒæ­¥é—®é¢˜ sudo nvim /etc/conf.d/hwclockå¯¹åº”é¡¹ä¿®æ”¹ä¸ºclock=\u0026quot;local\u0026quot;\nç¦ç”¨ nouveau å¹¶å®‰è£… Nvidia é©±åŠ¨ ç¼–è¾‘é…ç½®æ–‡ä»¶ /etc/modprobe.d/blacklist.conf ä»¥ç¦ç”¨nouveaué©±åŠ¨\n1 2 3 blacklist nouveau blacklist lbm-nouveau options nouveau modeset=0 å®‰è£…nvidiaé©±åŠ¨\nsudo emerge --ask x11-drivers/nvidia-drivers\nå›¾å½¢ç•Œé¢ é™„ä¸Šæˆ‘çš„xorgç¯å¢ƒä¸‹çš„dwmé…ç½®å’Œæºç ï¼Œé…ç½®ç®€å•ï¼ŒåŸºæœ¬ä¸Šcloneä¸‹æ¥ä¹‹åmake clean installå°±å¯ä»¥ä½¿ç”¨ã€‚\nFirefoxæµè§ˆå™¨ä¸‹æŒ‡å®šç½‘ç«™ç¦ç”¨æ’ä»¶ åŸç†æ˜¯Firefxä¸ºäº†ä¿æŠ¤ç”¨æˆ·éšç§ï¼Œæœ‰äº›å®˜æ–¹çš„åŸŸåæ˜¯å¼ºåˆ¶ä¸å¼€å¯æ‰©å±•çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨è¿™äº›åŸŸåååŠ æˆ–è€…åˆ é™¤åŸŸå\nå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š\né¦–å…ˆåœ¨åœ°å€æ è¾“å…¥about:configç„¶åæ— è§†é£é™©ç»§ç»­æµè§ˆï¼Œè¿›å…¥ä¹‹ååœ¨æœç´¢æ¡†è¾“å…¥extensions.webextensions.restrictedDomainsï¼Œåœ¨é‡Œé¢æ·»åŠ æŒ‡å®šåŸŸåå³å¯ï¼Œæ³¨æ„ä½¿ç”¨,éš”å¼€ã€‚\nLinuxä¸‹ä¸€äº›å®ç”¨çš„è½¯ä»¶ä»‹ç» Androidè®¾å¤‡æŠ•å±è½¯ä»¶scrcpy è¯¥è½¯ä»¶åœ¨gentooçš„è½¯ä»¶æºé‡Œæœ‰ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ACCEPT_KEYWORDS=\u0026quot;amd64\u0026quot;æˆ–è€…æˆ‘éœ€è¦æŠŠè½¯ä»¶åŒ…åŠ å…¥accept_keywordsä¸­ï¼Œæ“ä½œå¦‚ä¸‹\nç¼–è¾‘/etc/portage/package.accept_keywordsï¼š\n1 2 # Always use unstable packages app-mobilephone/scrcpy ~amd64 æˆ–è€…å°†å…¶ACCEPT_KEYWORDS=\u0026quot;amd64\u0026quot;æ”¹ä¸º\u0026quot;~amd64\u0026quot;ï¼Œä¸ªäººä¸å»ºè®®è¿™æ ·\nç„¶åå°±å¯ä»¥å®‰è£…è½¯ä»¶åŒ…äº†ï¼Œ ä½†æ˜¯å®‰è£…ä¹‹åæœ‰ä¸ªå‘ï¼Œå°±æ˜¯adbæ— æ³•è¿æ¥usbæ‰‹æœº\nä¼šæŠ¥é”™å¦‚ä¸‹ï¼š\n1 adb no permissions(user xxx is not in the plugdev group);.... æˆ‘ä»¬éœ€è¦å°†ç”¨æˆ·åŠ å…¥plugdevç»„ä¸­ï¼Œ\n1 root #usermod -aG plugdev $LOGNAME ç„¶åè¿˜æ˜¯ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç¼–è¾‘androidè§„åˆ™æ–‡ä»¶\nsudo nvim /etc/udev/rules.d/android.rules\nå†…å®¹å¦‚ä¸‹ï¼š\n1 SUBSYSTEM==\u0026#34;usb\u0026#34;, ENV{DEVTYPE}==\u0026#34;usb_device\u0026#34;, MODE=\u0026#34;0666\u0026#34; ç„¶åå°±å¯ä»¥é¡ºåˆ©ä½¿ç”¨ä½¿ç”¨scrcpyäº†ã€‚\nadb tcpip 5037 adb connect 192.168.0.4:5037 scrcpy -S\nscrcpyçš„ä¸€äº›å¿«æ·é”®(Modé»˜è®¤ä¸ºALTé”®)\nå¿«æ·é”® è¿è¡Œå‘½ä»¤ Mod + f åˆ‡æ¢å…¨å± Mod + g é‡ç½®å±å¹•å°ºå¯¸åˆ°åƒç´ æ¯”1ï¼š1 Mod + w é‡ç½®å±å¹•å°ºå¯¸æ¶ˆé™¤é»‘è¾¹ Mod + p ç›¸å½“äºç”µæºæŒ‰é”® Mod + o å…³é—­å±å¹• Mod + Shift + o ç‚¹äº®å…³é—­çš„å±å¹• Mod + c åŒæ­¥å¤åˆ¶åˆ°ç”µè„‘å‰ªåˆ‡æ¿ Mod + v åŒæ­¥ç²˜è´´å‰ªåˆ‡æ¿çš„å†…å®¹ Mod + i å¯ç”¨æˆ–è€…ç¦ç”¨FPSç›‘è§†å™¨ ","date":"2023-05-21T21:38:04+08:00","image":"https://haoleng-wick.github.io/p/gentoo%E9%9A%8F%E6%89%8B%E8%AE%B0/gentoo_hu15065158252994307299.png","permalink":"https://haoleng-wick.github.io/p/gentoo%E9%9A%8F%E6%89%8B%E8%AE%B0/","title":"Gentooéšæ‰‹è®°"},{"content":"æ¯•ä¸š æ—¶é—´è¿‡å¾—å¥½å¿«å•Šï¼Œä¸çŸ¥ä¸è§‰å·²ç»æ¯•ä¸šäº†3ä¸ªå¤šæœˆäº†ï¼Œå›é¡¾è¿™ä¸‰å¹´ï¼Œä½†ä¹Ÿç®—æ˜¯ä¸°å¯Œå¤šå½©å§ï¼Œæœ‰ç”¨çš„çŸ¥è¯†ä¹Ÿæ²¡å­¦å¤šå°‘ï¼Œæ²¡ç”¨çš„çŸ¥è¯†ä¹Ÿæ²¡å°‘å­¦ï¼Œèƒ½æ‘†ç»å¯¹æ²¡å·ï¼Œåæ­£ç¨€é‡Œç³Šæ¶‚å°±è¿‡äº†ä¸‰å¹´ï¼Œç§‹æ‹›ä¹Ÿç®—æ‰¾äº†ä¸ªå·¥ä½œå§ï¼Œæ¯•ä¸šåå’Œå…„å¼Ÿä»¬ä¹Ÿè”ç³»å°‘äº†ï¼Œå¤§ä¼™ä»¬éƒ½ä¸Šç­æŒºå¿™çš„â€¦â€¦\nä¸Šç­ å·¥ä½œä¹‹åæ‰çŸ¥é“åŸæ¥æ—¶é—´æ˜¯çœŸçš„ä¸å¤Ÿç”¨ï¼Œæå¾—æˆ‘ç°åœ¨éƒ½ç”µå­é˜³ç—¿äº†ï¼Œæ˜æ˜æœ‰å¾ˆå¤šæƒ³ç©çš„æ¸¸æˆï¼Œå¯æ˜¯ä¸‹ç­å›æ¥ä¹‹åå°±ç¡¬æ˜¯ä¸æƒ³æ‰“å¼€ã€‚è€Œä¸”å·¥ä½œæå¾—ä¸œè¥¿å’Œå­¦æ ¡å­¦çš„ä¸œè¥¿ä¹Ÿæœ‰å¾ˆå¤§å‡ºå…¥ï¼Œæ‰€ä»¥è¿˜éœ€è¦å­¦ä¹ å¾ˆå¤šä¸œè¥¿ï¼Œç°åœ¨å…ˆå­¦Cè¯­è¨€å’Œè®¡ç®—æœºç½‘ç»œåè®®ï¼Œå¦å¤–æˆ‘æœ¬äººå‡ºäºå…´è¶£è¿˜æƒ³å­¦äº›Rustè¯­è¨€ç›¸å…³çš„çŸ¥è¯†ã€‚ç°åœ¨æˆ‘çš„æƒ…å†µå°±æ˜¯ï¼Œä¸Šç­æ—¶é—´å°±å®Œæˆé¢†å¯¼å®‰æ’çš„å·¥ä½œï¼Œé—²æš‡ä¹‹ä½™å­¦ç‚¹ä¸œè¥¿ï¼Œæœ‰æ—¶å€™æ— èŠäº†æ‰“ä¸¤æŠŠæ¸¸æˆï¼ˆä¸¤æŠŠä¹‹åå°±çªç„¶é—´ä¸æƒ³ç©äº†ï¼Œè¿™æˆ–è®¸å°±æ˜¯ç”µå­é˜³ç—¿å§ï¼‰ï¼Œä¸‹å‘¨è¿˜è¦å‡ºå·®ï¼Œä¼°è®¡ä¼šæ›´ç´¯ï¼Œå…ˆè¿™ä¹ˆç€å§ã€‚\nå¸Œæœ› å¤šå­¦ç‚¹ä¸œè¥¿è‚¯å®šæ²¡é”™çš„ï¼Œä¼°è®¡ä»¥åå¾ˆé•¿ä¸€æ®µæ—¶é—´éƒ½åœ¨æç›®å‰æçš„è¿™äº›è®¾å¤‡å¼€å‘ï¼Œæ‰€ä»¥ï¼Œå¸Œæœ›å¤§å®¶éƒ½èƒ½è¶Šæ¥è¶Šå¥½å§ï¼\nä¹Ÿä¸çŸ¥é“è‡ªå·±å†™äº†äº›ä»€ä¹ˆä¸œè¥¿ï¼Œåæ­£ä¹Ÿæ²¡äººçœ‹ã€‚ã€‚\n","date":"2024-10-24T10:24:10+08:00","image":"https://haoleng-wick.github.io/p/%E5%8D%81%E6%9C%88%E5%B0%8F%E8%AE%B0/1024_hu6820670817370559309.jpg","permalink":"https://haoleng-wick.github.io/p/%E5%8D%81%E6%9C%88%E5%B0%8F%E8%AE%B0/","title":"åæœˆå°è®°"},{"content":"æ±‰æ˜ç ç®€ä»‹ æ±‰æ˜ç ï¼ˆä¹Ÿå«æµ·æ˜ç ï¼‰ï¼Œå¸¸ç”¨äºæ•°æ®ä¼ è¾“ä¸­çš„æ ¡éªŒç¼–ç ã€‚æ±‰æ˜ç å…·æœ‰ä¸€ä½çº é”™èƒ½åŠ›ï¼Œå…¶ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š\næ•°æ®åˆ†ç»„æ ¡éªŒ\næ ¡éªŒä½åœ¨$2^x$ä½\næ ¡éªŒä½ä¸ªæ•°å’Œå€¼çš„ç¡®å®š\næ ¡éªŒç çš„è§£ç å’Œçº æ­£\nè¯´ç™½äº†å°±æ˜¯æ¯ä¸ªæ ¡éªŒä½è´Ÿè´£ä¸€ç»„æ•°æ®çš„å¥‡å¶æ ¡éªŒï¼Œç„¶åæ•´ä¸ªæ•°æ®åˆ†æˆäº†å¥½å‡ ç»„ï¼Œæœ€åå°†å„ç»„çš„æ ¡éªŒæ•´åˆå¾—åˆ°æ•´ä¸ªæ•°æ®ä¸­å‡ºç°é”™è¯¯çš„é‚£ä¸€ä½ã€‚\nç¼–ç  å‡è®¾æ•°æ®æœ‰nä½ï¼Œå…¶ä¸­æ ¡éªŒç æœ‰xä½ï¼Œé‚£ä¹ˆç¼–ç åçš„æ•°æ®åº”è¯¥æœ‰n+xä½ã€‚xä½æ ¡éªŒç ä¸€å…±æœ‰$2^x$ç§å–å€¼ï¼Œå…¶ä¸­ä¸€ç§å–å€¼è¡¨ç¤ºæ•°æ®æ­£ç¡®ï¼Œåˆ™å‰©ä¸‹çš„$((2^x) - 1)$ç§å–å€¼è¡¨ç¤ºæœ‰ä¸€ä½æ•°æ®å‡ºé”™ã€‚ä¸éš¾æ¨å‡ºå¦‚ä¸‹ä¸ç­‰å¼ï¼š\n$$ ((2^x) - 1) \u0026gt;= (n+x) $$\nä½¿å¾—ä¸ç­‰å¼æˆç«‹çš„xçš„æœ€å°å€¼å°±æ˜¯æ±‰æ˜ç çš„æ ¡éªŒä½æ•°ã€‚\nä¾‹å¦‚0101 0011æ•°æ®æœ‰8ä½ï¼Œåˆ™ä»£å…¥ä¸ç­‰å¼å¯ä»¥å¾—åˆ°â€œ$((2^x) - 1) \u0026gt;= (8+x)$â€ï¼Œæ‰€ä»¥x=4ã€‚\nåŸå§‹æ•°æ®0101 0011ç»è¿‡ç¼–ç ä¹‹åå˜æˆäº†12ä½æ•°æ®ï¼Œå…¶ä¸­ç¬¬$2^k$ä½æ˜¯æ ¡éªŒä½ï¼Œå…¶ä½™ä½ä¸ºæ•°æ®ä½ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 P1 P2 D1 P4 D2 D3 D4 P8 D5 D6 D7 D8 ç„¶åå¯¹ä»–ä»¬è¿›è¡Œåˆ†ç»„ï¼Œé¦–å…ˆè§‚å¯Ÿå…¶ä½ç½®ç¼–ç ï¼š ä½ç½® äºŒè¿›åˆ¶è¡¨ç¤º å¯¹åº”æ•°æ® å¯¹åº”å–å€¼ 1 0001 P1 å¾…å®š 2 0010 P2 å¾…å®š 3 0011 D1 0 4 0100 P4 å¾…å®š 5 0101 D2 1 6 0110 D3 0 7 0111 D4 1 8 1000 P8 å¾…å®š 9 1001 D5 0 10 1010 D6 0 11 1011 D7 1 12 1100 D8 1 å°†æœ€ä½ä½æ˜¯1çš„æ•°æ®åˆ†ä¸ºç¬¬ä¸€ç»„ï¼šP1, D1, D2, D4, D5, D7\nå°†ç¬¬äºŒä½ä½æ˜¯1çš„æ•°æ®åˆ†ä¸ºç¬¬äºŒç»„ï¼šP2, D1, D3, D4, D6, D7\nå°†æœ€ä¸‰ä½ä½æ˜¯1çš„æ•°æ®åˆ†ä¸ºç¬¬ä¸‰ç»„ï¼šP4, D2, D3, D4, D8\nå°†æœ€é«˜ä½æ˜¯1çš„æ•°æ®åˆ†ä¸ºç¬¬å››ç»„ï¼šP8, D5, D6, D7, D8\nå†æ ¹æ®æ¯ä¸ªåˆ†ç»„çš„æ•°æ®ä½å’Œå¶æ ¡éªŒçš„è§„åˆ™è®¡ç®—æ ¡éªŒä½å…·ä½“æ•°å€¼\n1 2 3 4 5 P1 = D1 ^ D2 ^ D4 ^ D5 ^ D7 // 0 ^ 1 ^ 1 ^ 0 ^ 1 P2 = D1 ^ D3 ^ D4 ^ D6 ^ D7 // 0 ^ 0 ^ 1 ^ 0 ^ 1 P3 = D2 ^ D3 ^ D4 ^ D8 // 1 ^ 0 ^ 1 ^ 1 P4 = D5 ^ D6 ^ D7 ^ D8 // 0 ^ 0 ^ 1 ^ 1 // è®¡ç®—å¾—åˆ°ï¼šP1 = 1, P2 = 0, P3 = 1, P4 = 0 åŸå§‹æ•°æ®0101 0011ç»è¿‡ç¼–ç å˜æˆ1001 1010 0011 è§£ç  æ±‰æ˜ç åªèƒ½å¯¹ä¸€ä½æ•°æ®è¿›è¡Œæ£€æµ‹å’Œçº æ­£ï¼ˆä½†æ˜¯åœ¨è®¡ç®—æœºç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œç»å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯ä»…å‘ç”Ÿä¸€ä½æ•°æ®é”™è¯¯ï¼Œå› æ­¤æ±‰æ˜ç æ ¡éªŒä»ç„¶åœ¨å¹¿æ³›ä½¿ç”¨ï¼‰ï¼Œå‡è®¾æ”¶åˆ°çš„æ•°æ®ä¸º1001 1010 0010ï¼Œæ­¤æ—¶æ¥æ”¶æ–¹å¹¶ä¸çŸ¥é“æ•°æ®æ˜¯å¦æœ‰æ•ˆï¼Œéœ€è¦å¯¹è¯¥æ•°æ®è¿›è¡Œæ±‰æ˜ç æ ¡éªŒï¼Œå…·ä½“å¦‚ä¸‹ï¼š\né¦–å…ˆå¯¹æ ¡éªŒç è¿›è¡Œæ ¡éªŒè®¡ç®—\n1 2 3 4 5 P1_Check = P1 ^ D1 ^ D2 ^ D4 ^ D5 ^ D7 // 1 ^ 0 ^ 1 ^ 1 ^ 0 ^ 1 P2_Check = P2 ^ D1 ^ D3 ^ D4 ^ D6 ^ D7 // 0 ^ 0 ^ 0 ^ 1 ^ 0 ^ 1 P3_Check = P3 ^ D2 ^ D3 ^ D4 ^ D8 // 1 ^ 1 ^ 0 ^ 1 ^ 0 P4_Check = P4 ^ D5 ^ D6 ^ D7 ^ D8 // 0 ^ 0 ^ 0 ^ 1 ^ 0 // è®¡ç®—å¾—åˆ°ï¼šP1_Check = 0, P2_Check = 0, P3_Check = 1, P4_Check = 1 æŒ‰ç…§å¯¹åº”é«˜ä½ä½å°†æ ¡éªŒè®¡ç®—çš„ç»“æœè¿›è¡Œæ’åˆ—ï¼Œå¾—åˆ°P4P3P2P1 = 1100ï¼Œ\nè¯¥æ•°æ®è¡¨ç¤ºP4å’ŒP3æ ¡éªŒä½æ£€æµ‹åˆ°æ•°æ®å‡ºé”™ï¼Œè€ŒP1å’ŒP2æ ¡éªŒä½æ£€æµ‹åˆ°æ•°æ®æ­£å¸¸ï¼ˆå³D2, D3, D4 D8å’ŒD5, D6, D7, D8ä¸­å„æœ‰ä¸€ä¸ªæ•°æ®å‡ºç°é”™è¯¯ï¼Œè€ŒD1, D2, D4, D5å’ŒD1, D3, D4, D6, D7å‡æ­£å¸¸ï¼‰\næ‰€ä»¥å¯ä»¥æ¨æµ‹å‡ºå‡ºç°é”™è¯¯çš„æ˜¯D8è¡¨ç¤ºçš„æ•°æ®ï¼Œå³ç¬¬12ä½æ•°æ®ä½å‡ºé”™ï¼Œ0b1100å¯¹åº”åè¿›åˆ¶æ­£å¥½ä¸º12ï¼Œåªéœ€è¦å°†å¯¹åº”ä½å–åå³å¯å¾—åˆ°æ­£ç¡®æ•°æ®ã€‚\n","date":"2024-08-04T14:02:04+08:00","image":"https://haoleng-wick.github.io/p/%E6%B1%89%E6%98%8E%E7%A0%81%E6%A0%A1%E9%AA%8C/HanMing_hu1783845554367520671.png","permalink":"https://haoleng-wick.github.io/p/%E6%B1%89%E6%98%8E%E7%A0%81%E6%A0%A1%E9%AA%8C/","title":"æ±‰æ˜ç æ ¡éªŒ"},{"content":"å¸¸è§çš„C99å¤´æ–‡ä»¶ stdio.h : æ ‡å‡†IOæ¥å£ printf(), scanf()\nstdlib.h : é€šç”¨å·¥å…· malloc(), free(), atoi()\nstdarg.h : å¯å˜å‚æ•°å¤„ç† va_list\nstddef.h : å¸¸ç”¨ç±»å‹ä»¥åŠå®çš„å®šä¹‰ size_t, NULL\nstring.h/strings.h : å­—ç¬¦ä¸²æ“ä½œå‡½æ•° strcat(), strcasecmp()\nctype.h : å­—ç¬¦æ“ä½œå‡½æ•°æˆ–å® toupper()\ntime.h : æ—¶é—´å’Œæ—¶åŒºæ“ä½œå‡½æ•° time()\nstdint.h : æ•´æ•°ç±»å‹åŠå„æ•´æ•°ç±»å‹çš„æå€¼\nstdbool.h : trueã€falseç­‰boolç±»å‹\nmath.h : æ•°å­¦å‡½æ•°\nå‡½æ•° å«ä¹‰ abs(x) è¿”å›xçš„ç»å¯¹å€¼ sin(x) è¿”å›xçš„æ­£å¼¦å€¼ï¼ˆå¼§åº¦åˆ¶ï¼‰ cos(x) è¿”å›xçš„ä½™å¼¦å€¼ tan(x) è¿”å›xçš„æ­£åˆ‡å€¼ exp(x) è¿”å›Exçš„å€¼ asin(x) è¿”å›xçš„åæ­£å¼¦å€¼ acos(x) è¿”å›xçš„åä½™å¼¦å€¼ atan(x) è¿”å›xçš„åæ­£åˆ‡å€¼ cbrt(x) è¿”å›xçš„ç«‹æ–¹æ ¹ å¸¸è§Cè¯­è¨€é¢„å¤„ç†å™¨æŒ‡ä»¤ #include : åŒ…å«ä¸€ä¸ªæºä»£ç æ–‡ä»¶\n#define : å®šä¹‰å®\n#undef : å–æ¶ˆå·²å®šä¹‰çš„å®\n#ifdef : å¦‚æœå®å·²ç»å®šä¹‰ï¼Œåˆ™è¿”å›çœŸ\n#ifndef : å¦‚æœå®æ²¡æœ‰å®šä¹‰ï¼Œåˆ™è¿”å›çœŸ\n#if : å¦‚æœç»™å®šæ¡ä»¶ä¸ºçœŸï¼Œåˆ™ç¼–è¯‘ä¸‹é¢çš„ä»£ç \n#else : #if çš„ä»£æ›¿æ–¹æ¡ˆ\n#elif : å¦‚æœå‰é¢çš„ #if ç»™å®šæ¡ä»¶ä¸ä¸ºçœŸï¼Œå½“å‰æ¡ä»¶ä¸ºçœŸï¼Œåˆ™ç¼–è¯‘ä¸‹é¢ä»£ç \n#endif : ç»“æŸä¸€ä¸ª #ifâ€¦â€¦#else æ¡ä»¶ç¼–è¯‘å—\n#error : å½“é‡åˆ°æ ‡å‡†é”™è¯¯æ—¶ï¼Œè¾“å‡ºé”™è¯¯æ¶ˆæ¯\n#pragma : ä½¿ç”¨æ ‡å‡†åŒ–æ–¹æ³•ï¼Œå‘ç¼–è¯‘å™¨å‘å¸ƒç‰¹æ®Šçš„å‘½ä»¤åˆ°ç¼–è¯‘å™¨ä¸­\nä½è¿ç®—ç¬¦ è¿ç®—ç¬¦ æè¿° å®ä¾‹ \u0026amp; æŒ‰ä½â€œä¸â€ | æŒ‰ä½â€œæˆ–â€ ^ â€œå¼‚æˆ–â€ ~ æŒ‰ä½â€œå–åâ€ \u0026lt;\u0026lt; äºŒè¿›åˆ¶â€œå·¦ç§»â€ \u0026gt;\u0026gt; äºŒè¿›åˆ¶â€œå³ç§»â€ æ•°æ®ç±»å‹ æ•°æ®ç±»å‹ å¤§å°Size char 1å­—èŠ‚ int 2~4å­—èŠ‚ short int 2å­—èŠ‚ long int 4å­—èŠ‚ float 4å­—èŠ‚ double 8å­—èŠ‚ long double 10å­—èŠ‚ Cä¸­çš„æšä¸¾Enum ç®€å•çš„ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #include \u0026lt;stdio.h\u0026gt; int main(int argc, char *argv[]) { enum week{ Mon = 1, Tues, Wed, Thurs, Fri, Sat, Sun } day; scanf(\u0026#34;%d\u0026#34;, \u0026amp;day); switch(day){ case Mon: puts(\u0026#34;Monday\u0026#34;); break; case Tues: puts(\u0026#34;Tuesday\u0026#34;); break; case Wed: puts(\u0026#34;Wednesday\u0026#34;); break; case Thurs: puts(\u0026#34;Thursday\u0026#34;); break; case Fri: puts(\u0026#34;Friday\u0026#34;); break; case Sat: puts(\u0026#34;Saturday\u0026#34;); break; case Sun: puts(\u0026#34;Sunday\u0026#34;); break; default: puts(\u0026#34;Error!\u0026#34;); } return 0; } æŒ‡é’ˆã€å¯æ€•çš„æŒ‡é’ˆ æŒ‡é’ˆæ˜¯ä¸€ä¸ªå˜é‡ï¼Œå®ƒå­˜å‚¨å¦ä¸€ä¸ªå˜é‡çš„å†…å­˜åœ°å€ä½œä¸ºå…¶å€¼ã€‚\nå‡½æ•°æŒ‡é’ˆï¼ˆç”¨æ¥å­˜æ”¾å‡½æ•°çš„åœ°å€ï¼‰ æŒ‡é’ˆå‡½æ•°ï¼ˆè¿”å›å€¼æ˜¯æŒ‡é’ˆçš„å‡½æ•°ï¼‰ ä¾‹å¦‚strcpy(char *str1, const char *str2)è¿”å›str1\nå¦å¤–éœ€è¦æ³¨æ„çš„æ‚é¡¹ ä½¿ç”¨constä¿®é¥°çš„åªè¯»å˜é‡ä¸å…·æœ‰â€œå¸¸é‡è¡¨è¾¾å¼â€å±æ€§ï¼Œå› æ­¤æ— æ³•ç”¨æ¥è¡¨ç¤ºå®šé•¿æ•°ç»„çš„å¤§å°ï¼Œæˆ–è€…åœ¨caseè¯­å¥ä¸­ä½¿ç”¨ã€‚â€œå¸¸é‡è¡¨è¾¾å¼â€æœ¬èº«ä¼šåœ¨ç¨‹åºç¼–è¯‘æ—¶è¢«æ±‚å€¼ï¼Œè€Œâ€œåªè¯»å˜é‡â€åªèƒ½åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰è¢«å¾—çŸ¥ã€‚\nå˜é‡å­˜å‚¨ç±»å‹ï¼š\nautoé»˜è®¤ï¼› registerå£°æ˜å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œå®ƒæ‰€å£°æ˜çš„å˜é‡åœ¨ç¨‹åºä¸­ä½¿ç”¨é¢‘ç‡è¾ƒé«˜ï¼Œå› æ­¤å¯ä»¥å°†registerå˜é‡æ”¾åœ¨æœºå™¨çš„å¯„å­˜å™¨ä¸­ï¼Œä½¿ç¨‹åºæ›´å°ã€æ‰§è¡Œé€Ÿåº¦æ›´å¿«ï¼Œï¼ˆä½†æ˜¯ç¼–è¯‘å™¨å¯ä»¥å¿½ç•¥æ­¤é€‰é¡¹ï¼‰ï¼› static extern *p++é—®é¢˜\nè‹¥æœ‰å®šä¹‰int i =2, a[10], *p=\u0026amp;a[i];ï¼Œåˆ™*p++ç­‰ä»·äºa[i++]ã€‚\n++çš„ä¼˜å…ˆçº§æ¯”*é«˜ï¼Œä½†æ˜¯++æ˜¯åç¼€ï¼Œå…ˆä½¿ç”¨å€¼å†åŠ åŠ ï¼Œæ‰€ä»¥æ˜¯åŠ ä¹‹å‰çš„å€¼å»è§£å¼•ç”¨ã€‚\nå¾…ç»­æœªå®Œâ€¦â€¦æ­¤å¤–ï¼Œå¦‚æœ‰ä¾µæƒï¼Œæ·±æ„Ÿæ­‰æ„ï¼Œçƒ¦è¯·é‚®ç®±è”ç³»ã€‚\n","date":"2024-07-09T21:01:04+08:00","image":"https://haoleng-wick.github.io/p/c%E8%AF%AD%E8%A8%80%E6%9D%82%E8%AE%B0/CLanguage_hu13100799662827422430.jpg","permalink":"https://haoleng-wick.github.io/p/c%E8%AF%AD%E8%A8%80%E6%9D%82%E8%AE%B0/","title":"Cè¯­è¨€æ‚è®°"},{"content":"Gentoo On RaspberryPi è¯¥éƒ¨åˆ†ä¸»è¦å‚è€ƒGentoo Wikiï¼Œéƒ¨åˆ†å†…å®¹ä»…åšç®€è¦æè¿°ã€‚\nSDåˆ†åŒº å¯¹SDè¿›è¡Œåˆ†åŒº 1 fdisk /dev/mmcblk0 åˆ›å»ºDOSæ ‡ç­¾\nåˆ›å»ºå¯åŠ¨åˆ†åŒº\nåˆ›å»ºäº¤æ¢åˆ†åŒº\nåˆ›å»ºè·Ÿåˆ†åŒº\nè®¾ç½®æ–‡ä»¶ç³»ç»Ÿ\næœ€ç»ˆæ£€æŸ¥\n1 2 3 4 5 6 7 8 9 10 11 12 13 Command (m for help): p Disk /dev/sda: 59.48 GiB, 63864569856 bytes, 124735488 sectors Disk model: Storage Device Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0x4fe0c75b Device Boot Start End Sectors Size Id Type /dev/mmcblk0p1 2048 526335 524288 256M b W95 FAT32 /dev/mmcblk0p2 526336 17303551 16777216 8G 82 Linux swap / Solaris /dev/mmcblk0p3 17303552 124735487 107431936 51.2G 83 Linux å†™å…¥å¹¶æ ¼å¼åŒ– 1 2 3 mkfs -t vfat /dev/mmcblk0p1 mkswap --pagesize 16384 /dev/mmcblk0p2 mkfs -t ext4 /dev/mmcblk0p3 GentooåŸºæœ¬ç³»ç»Ÿ 1. æŒ‚è½½è·Ÿåˆ†åŒº 1 2 mount /dev/mmcblk0p3 /mnt/gentoo cd /mnt/gentoo/ 2. å®‰è£…åŸºæœ¬ç³»ç»Ÿå’Œportageå¿«ç…§ ä¸‹è½½æœ€æ–°çš„stageæ–‡ä»¶ï¼Œè§£å‹åˆ°è·Ÿåˆ†åŒº\n1 tar xpf /path/to/stage3-arm64-desktop-openrc-20240317T232028Z.tar.xz --xattrs-include=\u0026#39;*.*\u0026#39; --numeric-owner å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œé‚£ä¹ˆ/mnt/gentoo/ç›®å½•ä¸‹åº”è¯¥æ˜¯å¦‚ä¸‹çš„æ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡ç»“æ„\n1 2 3 Johnson /mnt/gentoo # ls bin dev home lib64 media opt root sbin tmp var boot etc lib lost+found mnt proc run sys usr ä¸‹è½½æœ€æ–°çš„portageå¿«ç…§ï¼Œè§£å‹åˆ°è½¯ä»¶ä»“åº“ç›®å½•\n1 2 mkdir -p /mnt/gentoo/var/db/repos/gentoo tar xpf /path/to/portage-latest.tar.bz2 --strip-components=1 -C /mnt/gentoo/var/db/repos/gentoo 3. å®‰è£…å†…æ ¸ã€æ¨¡å—å’Œå›ºä»¶ å…‹éš†æ ‘è“æ´¾å®˜æ–¹å›ºä»¶å­˜å‚¨ä»“åº“git clone --depth=1 https://github.com/raspberrypi/firmware.git\nå°†å›ºä»¶æ”¾å…¥boot\n1 2 3 4 5 6 7 8 9 10 mount /dev/mmcblk0p1 /mnt/gentoo/boot cp /path/to/firmware/boot/bcm2712-rpi-5-b.dtb /mnt/gentoo/boot/ cp /path/to/firmware/boot/fixup_cd.dat /mnt/gentoo/boot/ cp /path/to/firmware/boot/fixup.dat /mnt/gentoo/boot/ cp /path/to/firmware/boot/start_cd.elf /mnt/gentoo/boot/ cp /path/to/firmware/boot/start.elf /mnt/gentoo/boot/ cp /path/to/firmware/boot/bootcode.bin /mnt/gentoo/boot/ cp /path/to/firmware/boot/kernel8.img /mnt/gentoo/boot/ cp -r /path/to/firmware/boot/overlays/ /mnt/gentoo/boot/ å¦ä¸€ç§æ–¹æ³•æ˜¯åˆ©ç”¨äº¤å‰ç¼–è¯‘çš„æ–¹æ³•ä»æºç å¼€å§‹è£å‰ªç¼–è¯‘å†…æ ¸ï¼Œè¯¦è§æ ‘è“æ´¾å†…æ ¸æŒ‡å—\nå¼•å¯¼é…ç½®æ–‡ä»¶(ç¼–å†™/mnt/gentoo/boot/cmdline.txt å’Œ /mnt/gentoo/boot/config.txt)\n4. å®‰è£…æ— çº¿ç½‘ç»œModule ä»githubä¸Šå°†äºŒè¿›åˆ¶å›ºä»¶å¤åˆ¶åˆ°/mnt/gentoo/lib/firmware/brcm/ç›®å½•ä¸­å¹¶ä½œè½¯è¿æ¥\nå…‹éš†å›ºä»¶åº“git clone --depth=1 https://github.com/RPi-Distro/firmware-nonfree.git\nç„¶ååˆ›å»ºå­˜æ”¾å›ºä»¶çš„ç›®å½•mkdir -p /mnt/gentoo/lib/firmware/brcm\næ ‘è“æ´¾5çš„wifiæ¨¡å¼æ˜¯brcmfmc43455ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å¤åˆ¶brcmfmc43455çš„æ–‡ä»¶å³å¯ã€‚\n1 2 3 cp /path/to/raspberrypi/firmware-nonfree/debian/config/brcm80211/cypress/cyfmac43455-sdio-standard.bin /mnt/gentoo/lib/firmware/brcm/brcmfmac43455-sdio.bin root #cp /path/to/raspberrypi/firmware-nonfree/debian/config/brcm80211/cypress/cyfmac43455-sdio.clm_blob /mnt/gentoo/lib/firmware/brcm/brcmfmac43455-sdio.clm_blob cp /path/to/raspberrypi/firmware-nonfree/debian/config/brcm80211/brcm/brcmfmac43455-sdio.txt /mnt/gentoo/lib/firmware/brcm/ ç„¶åå†å¯¹ä»–ä»¬åšè½¯è¿æ¥ï¼Œæœ€åè¿æ¥å®Œçš„ç›®å½•å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 root #ls -l /mnt/gentoo/lib/firmware/brcm/ -rw-r--r-- 1 root root 643651 Jan 21 12:20 brcmfmac43455-sdio.bin -rw-r--r-- 1 root root 2676 Jan 21 12:18 brcmfmac43455-sdio.clm_blob lrwxrwxrwx 1 root root 22 Jan 21 12:23 brcmfmac43455-sdio.raspberrypi,5-model-b.bin -\u0026gt; brcmfmac43455-sdio.bin lrwxrwxrwx 1 root root 27 Jan 21 12:23 brcmfmac43455-sdio.raspberrypi,5-model-b.clm_blob -\u0026gt; brcmfmac43455-sdio.clm_blob lrwxrwxrwx 1 root root 22 Jan 21 12:24 brcmfmac43455-sdio.raspberrypi,5-model-b.txt -\u0026gt; brcmfmac43455-sdio.txt -rw-r--r-- 1 root root 2074 å¹´ 1 æœˆ 21 æ—¥ 12:19 brcmfmac43455-sdio.txt 5. å®‰è£…è“ç‰™Module å…‹éš†å›ºä»¶åº“git clone --depth=1 https://github.com/RPi-Distro/bluez-firmware.git\næ ‘è“æ´¾5çš„è“ç‰™åªéœ€è¦BCM4345C0.hcdï¼ŒæŠŠä»–å¤åˆ¶åˆ°ç›®å½•ç„¶ååšè½¯è¿æ¥ã€‚\n1 2 3 cp /home/darthjoker/raspberrypi/bluez-firmware/debian/firmware/broadcom/BCM4345C0.hcd /mnt/gentoo/lib/firmware/brcm/ ln -s /mnt/gentoo/lib/firmware/brcm/BCM4345C0.hcd /mnt/gentoo/lib/firmware/brcm/BCM4345C0.raspberrypi,5-model-b.hcd 6. ç¼–è¾‘ç³»ç»ŸæŒ‚è½½è¡¨æ–‡ä»¶ /mnt/gentoo/etc/fstab\n1 2 3 /dev/mmcblk0p1 /boot vfat noatime,noauto,nodev,nosuid,noexec\t1 2 /dev/mmcblk0p2 swap swap defaults 0 0 /dev/mmcblk0p3 / ext4 noatime 0 0 è‡³æ­¤ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„å›ºä»¶éƒ½è£…å®Œäº†ã€‚å¦‚æœæ‚¨è¿«ä¸åŠå¾…çš„è¯ï¼Œç°åœ¨å°±å¯ä»¥å¸è½½SDå¡ç„¶ååœ¨RaspberryPi 5ä¸Šå¯åŠ¨è‡ªå·±çš„Gentooäº†ï¼Œä½†æ˜¯æ‚¨çŸ¥é“çš„ï¼ŒGentooè¿™ä¸ªç³»ç»Ÿéœ€è¦é…ç½®çš„åœ°æ–¹ç‰¹åˆ«å¤šï¼Œæ¥ä¸‹æ¥è¯·è€å¿ƒçœ‹å®Œã€‚\n7. å¯åŠ¨å‰çš„è®¾ç½® å¦‚æœä½ æœ‰ä»¥å¤ªç½‘çš„è¯ï¼Œç›´æ¥å°±å¯ä»¥å†™åœ¨SDå¡å¹¶å¯åŠ¨æ ‘è“æ´¾ï¼Œé€šè¿‡æœ‰çº¿ç½‘ç»œå®ŒæˆåŸºæœ¬çš„é…ç½®äº†ã€‚\nå¦‚æœæ²¡æœ‰ï¼Œé‚£å°±åªèƒ½å…ˆè®¾ç½®å¥½æ— çº¿ç½‘ç»œäº†ï¼Œå…ˆå°†Networkmanagerè½¯ä»¶æ‰€éœ€è¦çš„æ–‡ä»¶ä¸‹è½½åˆ°è½¯ä»¶ç¼“å­˜åº“/var/cache/distfilesï¼Œç„¶åå¯åŠ¨æ ‘è“æ´¾å†æœ¬åœ°å®‰è£…Networkmanagerã€‚\nåœ¨ç™»å½•æ ‘è“æ´¾ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ”¹rootç”¨æˆ·çš„å¯†ç ã€‚ç›´æ¥ç®€å•ç²—æš´çš„å°†/mnt/gentoo/etc/shadowä¸­rootè¿™ä¸€è¡Œæ”¹ä¸ºå¦‚ä¸‹\n1 root:::::::: å¦‚æ­¤ä¸€æ¥ï¼Œé¦–æ¬¡ç™»å½•æ—¶ç›´æ¥ä½¿ç”¨rootç”¨æˆ·ç™»å½•ï¼Œä¸éœ€è¦å¯†ç å°±å¯ä»¥ç›´æ¥ç™»å½•ï¼Œè¿›å…¥ç³»ç»Ÿä¹‹åå†passwdè‡ªå·±è®¾ç½®å¯†ç ã€‚\nå¯åŠ¨ä¹‹åçš„é…ç½® åˆšå¯åŠ¨çš„æ ‘è“æ´¾ç³»ç»Ÿæ—¶é—´è‚¯å®šæ˜¯å¯¹ä¸ä¸Šçš„ï¼Œå»ºè®®ä½¿ç”¨date -s \u0026quot;2024-03-20 16:13\u0026quot;æ‰‹åŠ¨è®¾ç½®ä¸€ä¸‹ï¼Œä¸ç„¶portageå¯†é’¥å¯¹ä¸ä¸Šï¼Œæ ¹æœ¬å®‰è£…ä¸äº†è½¯ä»¶åŒ…ã€‚\nå¦å¤–æ³¨æ„å›½å†…ç¯å¢ƒä¸‹å¯èƒ½éœ€è¦æ¢æºï¼Œå»ºè®®å‚è€ƒæ¸…åå¤§å­¦å¼€æºé•œåƒç«™\nè¯¥éƒ¨åˆ†æ¶‰åŠåˆ°äº†/etc/portage/make.confæ–‡ä»¶ï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„æ ‘è“æ´¾5çš„make.confæ–‡ä»¶ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 $ sudo cat /etc/portage/make.conf # These settings were set by the catalyst build script that automatically # built this stage. # Please consult /usr/share/portage/config/make.conf.example for a more # detailed example. COMMON_FLAGS=\u0026#34;-mcpu=cortex-a76+crc+crypto -mtune=cortex-a76 -O2 -pipe\u0026#34; CFLAGS=\u0026#34;${COMMON_FLAGS}\u0026#34; CXXFLAGS=\u0026#34;${COMMON_FLAGS}\u0026#34; FCFLAGS=\u0026#34;${COMMON_FLAGS}\u0026#34; FFLAGS=\u0026#34;${COMMON_FLAGS}\u0026#34; # This sets the language of build output to English. # Please keep this setting intact when reporting bugs. LC_MESSAGES=C.utf8 # WARNING: Changing your CHOST is not something that should be done lightly. # Please consult https://wiki.gentoo.org/wiki/Changing_the_CHOST_variable before changing. CHOST=\u0026#34;aarch64-unknown-linux-gnu\u0026#34; GENTOO_MIRRORS=\u0026#34;https://mirrors.tuna.tsinghua.edu.cn/gentoo\u0026#34; # NOTE: This stage was built with the bindist Use flag enabled USE=\u0026#34;X zsh-completion elogind -systemd\u0026#34; VIDEO_CARDS=\u0026#34;fbdev vc4 v3d\u0026#34; 1. iwd å¯¹æ¯”Networkmanagerï¼Œæˆ‘ä¸ªäººæ›´å–œæ¬¢iwdï¼Œå› æ­¤ç›´æ¥emergeå®‰è£…iwdè¿›è¡Œé…ç½®ã€‚\n1 2 3 emerge --ask iwd rc-update add iwd default rc-update add dhcpcd default sshd\n1 rc-update add sshd default æ³¨æ„ä½¿ç”¨kittyè¿›è¡Œsshæ—¶ï¼Œè¦å…ˆkitty +kitten ssh root@192.168.8.88ï¼Œä¸ç„¶ä¼šå‡ºç°éš¾ä»¥å¿å—çš„é—®é¢˜(è¯•è¯•å°±çŸ¥é“äº†)\n2. æ—¶åŒºä¸æ—¶é—´åŒæ­¥ Openrcä¸­æ—¶åŒºçš„è®¾ç½®æ˜¯é€šè¿‡/etc/timezoneæ–‡ä»¶è®¾ç½®çš„\nä»¥ä¸­å›½ä¸ºä¾‹ï¼Œæ—¶åŒºçš„è®¾ç½®å¦‚ä¸‹ï¼š\n1 2 3 echo \u0026#34;Asia/Shanghai\u0026#34; \u0026gt; /etc/timezone emerge --config sys-libs/timezone-data æ—¶é—´è‡ªåŠ¨æ›´æ–°å¯ä»¥ä½¿ç”¨Chrony\n3. add user 1 2 3 useradd -m -G users,wheel,video -s /bin/bash haoleng passwd haoleng 4. å®‰è£…sudo å®‰è£…sudo emerge --ask sudoï¼Œç„¶åç¼–è¾‘æ–‡ä»¶/etc/sudoerså°†# %wheel ALL=(ALL:ALL) ALLçš„æ³¨é‡Šå–æ¶ˆæ‰ã€‚å°±å¯ä»¥åœ¨æ™®é€šç”¨æˆ·ç¯å¢ƒä¸‹ä½¿ç”¨sudoææƒäº†ã€‚\n5. zsh ä¸ªäººæ¯”è¾ƒå–œæ¬¢ç”¨zshï¼Œå¯ä»¥é€šè¿‡emerge --ask zsh app-shells/gentoo-zsh-completionså®‰è£…ï¼Œä¸‹é¢æ˜¯æˆ‘åœ¨gentooç³»ç»Ÿä¸‹çš„.zshrcæ–‡ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 # history HISTSIZE=1000 SAVEHIST=1000 HISTFILE=~/.histfile setopt INC_APPEND_HISTORY setopt HIST_IGNORE_DUPS setopt AUTO_PUSHD setopt PUSHD_IGNORE_DUPS setopt HIST_IGNORE_SPACE setopt SHARE_HISTORY # gentoo-zsh-completions autoload -U compinit promptinit compinit promptinit; prompt gentoo # alias alias ra=\u0026#39;yazi\u0026#39; alias ne=\u0026#39;neofetch\u0026#39; # plugins eval \u0026#34;$(starship init zsh)\u0026#34; source /usr/share/zsh-autosuggestions/zsh-autosuggestions.zsh # ssh if [ -n \u0026#34;$SSH_CONNECTION\u0026#34; ]; then echo \u0026#34; \u0026#34; echo $( shuf ~/.local/share/dwm/script/messages.txt -n 1 | awk \u0026#39;{ print(\u0026#34;ó°•ƒ \u0026#34; $0) }\u0026#39; ) fi è®°å¾—å®‰è£…git sudo emerge --ask dev-vcs/gitï¼Œç„¶åå°†zsh-autosuggestionsæ’ä»¶cloneåˆ°/usr/share/ç›®å½•ä¸‹ã€‚\nå¦å¤–æ¨èä¿©å·¥å…·starshipå’Œyaziï¼Œç”¨è¿‡éƒ½è¯´å¥½ğŸ‘ï¼\n6. å®‰è£…æ¡Œé¢ç¯å¢ƒ Xorgæ¡Œé¢ç¯å¢ƒ å®‰è£…dwmçª—å£ç®¡ç†å™¨ æœ¬äººä½¿ç”¨çš„dwmæºç :é“¾æ¥åœ°å€ï¼Œå¦‚æœè¦ä½¿ç”¨çš„è¯ï¼Œè®°å¾—å®‰è£…ä¾èµ–xorg-server, x11-libs/libXineramaï¼Œè¿˜æœ‰hack-nerd-fontï¼Œç„¶åç›´æ¥è¿›ç›®å½•sudo make clean installå°±å¥½äº†ã€‚\nå†åœ¨å®¶ç›®å½•æ·»åŠ xinitrcæ–‡ä»¶ã€‚echo \u0026quot;exec dwm\u0026quot; \u0026gt; ~/.xinitrc\nå¼€æœºè‡ªå¯éœ€è¦ç¼–è¾‘ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 # å¼€æœºè‡ªåŠ¨ç™»å½• # Openrc /etc/inittab ...... #x1:12345:respawn:/sbin/agetty 38400 console linux c1:12345:respawn:/sbin/agetty --autologin haoleng --noclear 38400 tty1 linux c2:2345:respawn:/sbin/agetty 38400 tty2 linux ...... # ç™»å½•åæ‰§è¡Œstartx # zsh ~/.zprofile if [ -z \u0026#34;${DISPLAY}\u0026#34; ] \u0026amp;\u0026amp; [ \u0026#34;${XDG_VTNR}\u0026#34; -eq 1 ]; then exec startx fi å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ ‘è“æ´¾5ä¸­ä½¿ç”¨xorgéœ€è¦æ‰‹åŠ¨åˆ›å»ºé…ç½®æ–‡ä»¶/etc/X11/xorg.conf.d/99-vc4.confg\n1 2 3 4 5 6 7 8 # Shamelessly copied from PiOS Section \u0026#34;OutputClass\u0026#34; Identifier \u0026#34;vc4\u0026#34; MatchDriver \u0026#34;vc4\u0026#34; Driver \u0026#34;modesetting\u0026#34; Option \u0026#34;PrimaryGPU\u0026#34; \u0026#34;true\u0026#34; EndSection é…ç½®VNCè¿œç¨‹æ¡Œé¢ ä»‹äºRealVNCæ”¶è´¹çš„ç¼˜æ•…ï¼Œæœ¬äººé€‰æ‹©äº†TigerVNCä½œä¸ºVNCå·¥å…·ï¼Œè¯¦ç»†å¯ä»¥å‚è€ƒWIKIï¼Œæœ¬äººåœ¨æ­¤åªåšç®€è¦ä»‹ç»ã€‚\næœ¬äººå¹¶æ²¡æœ‰ä½¿ç”¨TigerVNCçš„æœåŠ¡å™¨è½¯ä»¶åŒ…ï¼Œåªæ˜¯ä»¥æœ€ç®€å•çš„æ–¹å¼å®ç°äº†VNCåŠŸèƒ½ï¼Œä¸‹é¢æ˜¯æœ¬äººè®¤ä¸ºå…³é”®çš„æ­¥éª¤ï¼š\n1 2 3 4 5 6 7 sudo emerge --ask net-misc/tigervnc vnc passwd ~/.vnc/passwd # æœ€åä¸€ä¸ªé€‰n # ç„¶åå†åœ¨dwmå¯åŠ¨è„šæœ¬ä¸­åŠ å…¥ x0vncserver -PasswordFile ~/.vnc/passwd \u0026amp; # å°±å¯ä»¥åœ¨dwmå¯åŠ¨åæ‰§è¡ŒVNCæœåŠ¡ Waylandæ¡Œé¢ç¯å¢ƒ æœ¬äººé€‰æ‹©ç¨³å®šçš„SwayWMï¼Œç›´æ¥emerge --ask gui-wm/swayå®‰è£…å³å¯ï¼Œéœ€è¦æ³¨æ„çš„å°±æ˜¯è®°å¾—ä»¥drmUSEæ ‡å¿—å®‰è£…wlrootsï¼Œå¦‚ä¸‹ï¼š\n1 2 3 4 emerge --info wlroots â†“â†“â†“â†“â†“â†“ gui-libs/wlroots-0.17.2::gentoo was built with the following: USE=\u0026#34;X drm libinput session vulkan -liftoff -tinywl -x11-backend -xcb-errors\u0026#34; ç„¶åå¯èƒ½æ‰èƒ½å¯åŠ¨Waylandï¼Œå¦å¤–Waylandä¸‹çš„VNCéœ€è¦å®‰è£…wayvncï¼Œç„¶åå†ä»¥headlessæ¨¡å¼å¯åŠ¨Swayï¼Œæˆ‘çš„é…ç½®æ–‡ä»¶åœ¨è¿™é‡Œ\nGPIO æ ‘è“æ´¾çš„å¤‡ä»½ æš‚æ—¶å…ˆè®°è¿™æ¡ï¼š sudo dd if=/dev/mmcblk0 |gzip\u0026gt;/home/haoleng/raspberrypi.gz status=progress sudo gzip -dc raspberrypi.gz | sudo dd of=/dev/mmcblk0 status=progress\nå¾…ç»­æœªå®Œâ€¦â€¦\n","date":"2024-03-20T10:16:13+08:00","image":"https://haoleng-wick.github.io/p/raspberrypi-5-and-gentoo/Cover_hu10193379931846734990.png","permalink":"https://haoleng-wick.github.io/p/raspberrypi-5-and-gentoo/","title":"RaspberryPi 5 and Gentoo"},{"content":"Gentoo Linux ç³»ç»Ÿä¸‹ Tenosorflow-gpu çš„å®‰è£… å®‰è£… nvidia é©±åŠ¨ å¯ä»¥å‚è€ƒæˆ‘çš„è¿™ç¯‡æ–‡ç« \nä½¿ç”¨ nvidia-smiå‘½ä»¤ éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ\næˆ‘çš„ç”µè„‘è¾“å‡ºå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Mon Jul 17 10:54:53 2023 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 525.125.06 Driver Version: 525.125.06 CUDA Version: 12.0 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 NVIDIA GeForce ... Off | 00000000:01:00.0 Off | N/A | | N/A 37C P0 N/A / 80W | 6MiB / 6144MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | |=============================================================================| | 0 N/A N/A 3640 G /usr/bin/X 4MiB | +-----------------------------------------------------------------------------+ å®‰è£…cuda å®‰è£…è½¯ä»¶åŒ…\nsudo emerge --ask dev-util/nvidia-cuda-toolkit\nä¸‹è½½cudnn\nå°†ä¸‹è½½åçš„æ–‡ä»¶è§£å‹ç¼©å¹¶å¤åˆ¶åˆ°æŒ‡å®šä½ç½®\n1 2 3 4 5 6 7 tar xvzf cudnn-linux-x86_64-8.9.3.28_cuda12-archive.tar.xz cd cudnn-linux-x86_64-8.9.3.28_cuda12-archive sudo cp include/cudnn.h /opt/cuda/include sudo cp lib/libcudnn* /opt/cuda/lib64 sudo chmod a+r /opt/cuda/include/cudnn.h sudo chmod a+r /opt/cuda/lib64/libcudnn* å®‰è£…Anaconda ä¸‹è½½å®‰è£…è„šæœ¬Download\nç»™äºˆæ‰§è¡Œæƒé™chomd +x Anaconda3-*.sh\næ‰§è¡Œ./Download/Anaconda3-*.sh\nç„¶åé…ç½®å®‰è£…ç›®å½•ï¼Œæ˜¯å¦åœ¨å½“å‰shellç¯å¢ƒä¸­æ¿€æ´»ï¼Œå»ºè®®æ˜¯ã€‚\nå®‰è£…Tensorflow åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\nconda create --name tensorflow python=3.10\næ¿€æ´»è™šæ‹Ÿç¯å¢ƒ\nconda activate tensorflow\nå®‰è£…è½¯ä»¶åŒ…\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # condaç¯å¢ƒä¸‹çš„cudaå’Œcudnn conda install -c conda-forge cudatoolkit=11.8.0 cudnn=8.9.2.26 # condaè™šæ‹Ÿç¯å¢ƒçš„ç¯å¢ƒå˜é‡é…ç½® # ä¸´æ—¶è®¾ç½® export LD_LIBRARY_PATH=$CONDA_PREFIX/lib/:$CUDNN_PATH/lib:$LD_LIBRARY_PATH export XLA_FLAGS=--xla_gpu_cuda_data_dir=/opt/cuda # æ°¸ä¹…é…ç½®ï¼ˆå»ºè®®ä¸´æ—¶è®¾ç½®æµ‹è¯•tensorflowç¯å¢ƒï¼ŒæˆåŠŸä¹‹åå†è¿›è¡Œæ°¸ä¹…æ€§é…ç½®ï¼‰ mkdir -p $CONDA_PREFIX/etc/conda/activate.d echo \u0026#39;export LD_LIBRARY_PATH=$CONDA_PREFIX/lib/:$CUDNN_PATH/lib:$LD_LIBRARY_PATH\u0026#39; \u0026gt;\u0026gt; $CONDA_PREFIX/etc/conda/activate.d/env_vars.sh echo \u0026#39;export XLA_FLAGS=--xla_gpu_cuda_data_dir=/opt/cuda\u0026#39; \u0026gt;\u0026gt; $CONDA_PREFIX/etc/conda/activate.d/env_vars.sh # pipå®‰è£…tensorflow pip install --upgrade pip pip install tensorflow éªŒè¯\n1 python3 -c \u0026#34;import tensorflow as tf; print(\u0026#39;GPU\u0026#39;, tf.test.is_gpu_available())\u0026#34; æœ¬äººç”µè„‘ä¸Šè¾“å‡ºå¦‚ä¸‹ï¼š\n1 2 3 4 **** 2023-07-17 11:14:12.266188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /device:GPU:0 with 4069 MB memory: -\u0026gt; device: 0, name: NVIDIA GeForce RTX 3060 Laptop GPU, pci bus id: 0000:01:00.0, compute capability: 8.6 GPU True **** è‡³æ­¤ï¼ŒTensorflowå®‰è£…å®Œæ¯•ã€‚\nTensorflow Object Detection API å®‰è£… å®‰è£…æ•™ç¨‹å‚è€ƒ tensorflow2 od install\nå…‹éš†tensorflowæ¨¡å‹å­˜å‚¨åº“\n1 git clone https://github.com/tensorflow/models.git pipå®‰è£…\n1 2 3 4 5 6 cd models/research # éœ€è¦å®‰è£… protos åœ¨ç¯å¢ƒå½“ä¸­ protoc object_detection/protos/*.proto --python_out=. # å®‰è£… TensorFlow Object Detection API cp object_detection/packages/tf2/setup.py . pip install . æµ‹è¯•\n1 2 # Test the installation. python object_detection/builders/model_builder_tf2_test.py æ­å–œæ‚¨ï¼Œå·²ç»å®Œæˆäº†å®‰è£…ï¼Œä¸‹æ¥è¯•è¯•ä¸€ä¸ªå°ä¾‹å­å§ã€‚\nä¸€ä¸ªæµ£ç†Šæ£€æµ‹å°æ¨¡å‹\n","date":"2023-07-17T10:50:29+08:00","image":"https://haoleng-wick.github.io/p/tensorflow%E5%85%A5%E9%97%A8/Tensorflow_hu10989047162192874471.jpg","permalink":"https://haoleng-wick.github.io/p/tensorflow%E5%85%A5%E9%97%A8/","title":"Tensorflowå…¥é—¨"},{"content":"è§†è§‰å¯¼èˆª å®¤å†…å¯¼èˆª å…³é”®æŠ€æœ¯ï¼š\nä¼ æ„Ÿå™¨ä¿¡æ¯é‡‡é›†åˆ†æ\nSLAMå»ºå›¾çš„å‡†ç¡®æ€§ã€åŠæ—¶æ€§ï¼Œå‡å–å†³äºä¼ æ„Ÿå™¨è·å¾—æ•°æ®çš„å®Œå¤‡æ€§ã€‚\nè§†è§‰é‡Œç¨‹è®¡ä¸å›ç¯æ£€æµ‹åˆ†æ\nä¼ ç»ŸVOæ¡†æ¶æ­é…å›ç¯æ£€æµ‹æ¶ˆé™¤è¯¯å·®ã€‚\n3Då»ºå›¾\nâ€‹\tä¼ ç»Ÿçš„ORB-SLAMåªèƒ½æ„å»ºç¨€ç–äº‘ç‚¹åœ°å›¾ï¼Œæ— æ³•åº”ç”¨ä¸å¯¼èˆªä»»åŠ¡ï¼Œéœ€è¦æ„å»ºç«‹ä½“è§†è§‰æƒ¯æ€§SLAMï¼Œç”Ÿæˆä¸‰ç»´è¯­ä¹‰æ‹“æ‰‘å›¾ï¼Œæœ€åç”Ÿæˆè·¯å¾„è§„åˆ’åœ°å›¾ï¼Œå®ç°è‡ªä¸»å¯¼èˆªã€‚\nåŸºäºæ·±åº¦è§†è§‰æ„ŸçŸ¥çš„SLAMå¯¼èˆª æ·±åº¦è§†è§‰çš„SLAMå·¥ä½œåŸç†å›¾ï¼š stateDiagram-v2 direction LR [*] --\u003e operation state operation{ direction LR ä¼ æ„Ÿå™¨æ•°æ® --\u003e ï¼ˆå‰ç«¯ï¼‰è§†è§‰é‡Œç¨‹è®¡ ï¼ˆå‰ç«¯ï¼‰è§†è§‰é‡Œç¨‹è®¡ --\u003eï¼ˆåç«¯ï¼‰éçº¿æ€§ä¼˜åŒ– ï¼ˆåç«¯ï¼‰éçº¿æ€§ä¼˜åŒ– --\u003e å»ºå›¾ } ä¼ æ„Ÿå™¨æ•°æ® --\u003e å›ç¯æ£€æµ‹ å›ç¯æ£€æµ‹ --\u003e ï¼ˆåç«¯ï¼‰éçº¿æ€§ä¼˜åŒ– å»ºå›¾ --\u003e [*] è§†è§‰å¤„ç†ä¸»è¦å‰ç«¯å¤„ç†ç®—æ³•ï¼š graph LR A([å‰ç«¯å¤„ç†]) --\u003e BB[ç‰¹å¾æ³•] \u0026 C[ç›´æ¥æ³•] BB --\u003e B1(å…³é”®ç‚¹æå–) B1 --\u003e b11([\"ORB(å…·æœ‰è‰¯å¥½çš„å¹³ç§»æ—‹è½¬ä¸å˜æ€§ï¼Œæå–æ—¶é—´å¿«)\"]) B1 --\u003e b12([\"SIFT(é²æ£’æ€§å¼º,å…‰ç…§,æ—‹è½¬ç­‰å‡ä¸æ•æ„Ÿ)\"]) B1 --\u003e b13([\"FAST(Fastè§’ç‚¹ï¼Œå™ªå£°æ•æ„Ÿï¼Œé€Ÿåº¦å¿«)\"]) B1 --\u003e b14([\"SURF(è®¡ç®—é‡æ¯”SIFTæ˜¾è‘—é™ä½,åŒæ—¶é²æ£’æ€§ä¹Ÿé™ä½)\"]) BB --\u003e B2(æè¿°å­) B2 --\u003e b21([æ¢¯åº¦è®¡ç®—HOGæè¿°å­]) B2 --\u003e b22([äºŒè¿›åˆ¶BRISKæè¿°å­]) BB --\u003e B3(ç‰¹å¾åŒ¹é…-FLANNç®—æ³•) BB --\u003e B4(æ•°æ®å…³è”) B4 --\u003e b41(\"2D-2D(å¤šè§†å›¾å‡ ä½•)\") B4 --\u003e b42(\"2D-3D(çº¿æ€§åŒ–(PNP)ã€éçº¿æ€§æ±‚è§£(BA))\") B4 --\u003e b43(\"3D-3D\") C --\u003e C1[\"åŠç›´æ¥æ³•(å…‰æµ)\"] C --\u003e C2[ç›´æ¥æ³•] C1 \u0026 C2 --\u003e c(\"(ä½¿ç”¨æœ€å°åŒ–å…‰åº¦è¯¯å·®ï¼Œéçº¿æ€§ä¼˜åŒ–æ±‚è§£)\") â€‹\tç‰¹å¾æ³•ï¼š ç‰¹å¾æ³•è§†è§‰é‡Œç¨‹è®¡ï¼Œå°†æ•°æ®å…³è”å’Œä½å§¿ä¼°è®¡é—®é¢˜åˆ†å¼€è€ƒè™‘ã€ç‹¬ç«‹è§£å†³ï¼Œä½†æ˜¯ç‰¹å¾è®¡ç®—å’Œç‰¹å¾åŒ¹é…éå¸¸è€—æ—¶ï¼Œåœ¨ç‰¹å¾ç¼ºå¤±ã€çº¹ç†é‡å¤çš„ç¯å¢ƒä¸­å®¹æ˜“è·Ÿè¸ªä¸¢å¤±ï¼Œå¹¶ä¸”ç¨€ç–çš„ç‚¹äº‘åœ°å›¾åªèƒ½ç”¨äºå®šä½ï¼Œè€Œæ— æ³•æä¾›å¯¼èˆªã€é¿éšœç­‰è¯¸å¤šåŠŸèƒ½ã€‚\nâ€‹\tç›´æ¥æ³•ï¼š ç›´æ¥æ³•è§†è§‰é‡Œç¨‹è®¡ä»¥ä¸€ç§æ›´æ•´ä½“ã€æ›´ä¼˜é›…çš„æ–¹å¼ï¼Œå¤„ç†æ•°æ®å…³è”å’Œä½å§¿ä¼°è®¡é—®é¢˜ï¼Œä»…ä½¿ç”¨åƒç´ çš„ç°åº¦ä¿¡æ¯ï¼Œè®¡ç®—æ•ˆç‡é«˜ï¼Œå¹¶ä¸”åœ¨ç‰¹å¾ç¼ºå¤±çš„ç¯å¢ƒä¸­ï¼Œä¹Ÿæœ‰å¾ˆå¥½çš„è¡¨ç°ã€‚å…¶ä¸è¶³åœ¨äºï¼Œå¯¹å…‰ç…§å˜åŒ–éå¸¸æ•æ„Ÿï¼Œæ‰€å»ºç«‹çš„åœ°å›¾æ— ç‰¹å¾æè¿°å­ï¼Œå¯¼è‡´éš¾ä»¥è¿›è¡Œåœ°å›¾çš„å¤ç”¨ã€‚å› æ­¤ï¼Œç›´æ¥æ³•æ›´æ“…é•¿ç«¯åˆ°ç«¯çš„è§£å†³è¿ç»­ç¼“æ…¢çš„å®šä½é—®é¢˜ï¼Œè€Œç‰¹å¾æ³•æ›´é€‚åˆé‡å®šä½ä¸å›ç¯æ£€æµ‹ã€‚\nè§†è§‰å¤„ç†ä¸»è¦åç«¯å¤„ç†ç®—æ³•ï¼š\ngraph LR A([åç«¯ä¼˜åŒ–]) --\u003e B(åŸºäºæ»¤æ³¢çš„æ–¹æ³•) \u0026 C(åŸºäºä¼˜åŒ–çš„æ–¹æ³•) \u0026 D(å›ç¯æ£€æµ‹) B --\u003e B1([\"EKFç®—æ³•(æ‰©å±•å¡å°”æ›¼æ»¤æ³¢)\"]) B --\u003e B2([\"PKFç®—æ³•(ç²’å­æ»¤æ³¢ç®—æ³•)\"]) B --\u003e B3([\"MSCKFç®—æ³•(å¤šçŠ¶æ€çº¦æŸå¡å°”æ›¼)\"]) C --\u003e C1(BAä¼˜åŒ–) C1 --\u003e c11([\"PTAM\"]) C1 --\u003e c12([\"ORB-SLAM\"]) C --\u003e C2(ä½å§¿å›¾ä¼˜åŒ–,èˆå¼ƒå¯¹äºè·¯æ ‡ç‚¹çš„ä¼˜åŒ–) C2 --\u003e c21([Vins-Mono]) C2 --\u003e c22([OKVIS]) C --\u003e C3(å› å­å›¾ä¼˜åŒ–) C3 --\u003e c31([ISAMä»¥åŠå…¶å¯¹åº”çš„gtsamç®—æ³•åº“]) D --\u003e D1(åŸºäºæ·±åº¦å­¦ä¹ ) D --\u003e D2(åŸºäºè¯è¢‹æ¨¡å‹) â€‹\t**æ»¤æ³¢å™¨æ³•ï¼š**è™½ç„¶æ»¤æ³¢å™¨çš„å…¨å±€ä¼˜åŒ–å‡è®¾äº†çŠ¶æ€é‡ä¹‹é—´çš„é©¬å°”å¯å¤«æ€§ï¼Œå­˜åœ¨è¾ƒå¤§çš„çº¿æ€§è¯¯å·®ï¼Œä½†ç›¸æ¯”éçº¿æ€§ä¼˜åŒ–æ³•åœ¨è®¡ç®—èµ„æºå—é™å¹³å°æˆ–ç»“æ„åŒ–åœºæ™¯ä¸­ï¼Œä»ç„¶æ˜¯ä¸€ç§éå¸¸æœ‰æ•ˆçš„æ–¹æ³•ã€‚\nâ€‹\t**ä¼˜åŒ–ç®—æ³•ï¼š**éçº¿æ€§ä¼˜åŒ–æ³•æ˜¯åˆ©ç”¨çº¦æŸæ¡ä»¶æ„é€ ç›®æ ‡å‡½æ•°ï¼Œé€šè¿‡æœ€ä¼˜åŒ–çš„ç®—æ³•å¯»æ‰¾ä½å§¿å’Œåœ°å›¾ç‚¹çš„æœ€ä¼˜è§£ã€‚é›†æŸè°ƒæ•´å’Œå›¾ä¼˜åŒ–éƒ½æ˜¯éçº¿æ€§ä¼˜åŒ–æ³•ï¼Œä½†æ˜¯æ¯”è¾ƒéš¾ä»¥æ±‚è§£ã€‚\nâ€‹\t**å›ç¯æ£€æµ‹ï¼š**åŸºäºå­åœ°å›¾ä¸å­åœ°å›¾é—´çš„åŒ¹é…ã€åŸºäºå›¾åƒä¸å­åœ°å›¾é—´çš„åŒ¹é…ã€åŸºäºå›¾åƒä¸å›¾åƒé—´åŒ¹é…ï¼ˆç›®å‰ä¸»æµï¼‰ã€åŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„å›ç¯æ£€æµ‹ã€‚\nå®¤å¤–å¯¼èˆª å…³é”®æŠ€æœ¯ï¼š\næ„å»ºç‰¹å®šåŒºåŸŸå…ˆéªŒæ•°æ®åº“\nåŒ¹é…ç®—æ³•\nåŒ¹é…ç®—æ³•ç›´æ¥å…³ä¹æ— äººæœºå®šä½çš„å‡†ç¡®åº¦ï¼Œå¯¹äº SIFT ç®—æ³•è€Œè¨€ï¼Œè®¡ç®—å¤æ‚åº¦è¾ƒé«˜ï¼Œå†…éƒ¨è¿ç®—çš„æ•°æ®é‡å·¨å¤§ï¼Œéš¾ä»¥ç¬¦åˆæ— äººæœºå®šä½å¯¼èˆªçš„å®æ—¶æ€§éœ€æ±‚ï¼ŒåŒæ ·ä¹Ÿä¼šé™ä½è®©æ— äººæœºçš„å·¥ä½œæ•ˆç‡ã€‚\næœç´¢ç›®æ ‡ç‰¹å¾æå–ã€ç›®æ ‡ç¡®è®¤åˆ†æ\næœç´¢å‰éœ€è¦å¾—åˆ°ç›®æ ‡çš„ç‰¹å¾ï¼Œç›®æ ‡ç‰¹å¾ç‚¹å¤ªå°‘ä¼šå¯¼è‡´è¯†åˆ«ç‡é™ä½ï¼Œç›®æ ‡ç‰¹å¾ä¸å¤Ÿæ˜ç¡®ä¼šå¯¼è‡´è¯†åˆ«é”™è¯¯ç‡å¢åŠ ï¼Œç›®æ ‡ç‰¹å¾è¿‡äºç²¾ç»†ç”±äºä¼ æ„Ÿå™¨ç²¾åº¦ä¸å¤Ÿï¼Œä¼šéš¾ä»¥åŒ¹é…æˆåŠŸã€‚\næ— äººæœºå·¡æŸ¥å·¥ä½œåŸç†ï¼š stateDiagram direction LR ç‰¹å®šåŒºåŸŸå…ˆéªŒæ•°æ®åº“ --\u003e åŒ¹é…ç®—æ³• å®æµ‹ç¯å¢ƒç‰¹å¾æ•°æ® --\u003e åŒ¹é…ç®—æ³• åŒ¹é…ç®—æ³• --\u003e æ— äººæœº æ— äººæœº --\u003e å®šä½ä¸å¯¼èˆª å®šä½ä¸å¯¼èˆª --\u003e å·¡æŸ¥å·¥ä½œ ç‰¹æ®Šç›®æ ‡æœç´¢è¯†åˆ«åŸç†ï¼š\nstateDiagram-v2 direction LR [*] --\u003e operation æœç´¢ç›®æ ‡ç‰¹å¾ --\u003e ç›®æ ‡ç¡®è®¤ æœç´¢ç›®æ ‡ç‰¹å¾ --\u003e æ— äººæœº state operation { direction LR ç›®æ ‡æœç´¢ --\u003e ç›®æ ‡ç¡®è®¤ ç›®æ ‡ç¡®è®¤ --\u003e æ— äººæœº æ— äººæœº --\u003e å®šä½ä¸è·Ÿè¸ª } å®šä½ä¸è·Ÿè¸ª --\u003e [*] ç›¸å…³æŠ€æœ¯ä¸è®¾å¤‡ è§†è§‰æ„ŸçŸ¥å•å…ƒ å•ç›®æ‘„åƒå¤´ å•ç›®æµ‹è·åŸç†ï¼š\næµ‹é‡åŸç†ä¸»è¦åˆ†ä¸ºåŸºäºå·²çŸ¥è¿åŠ¨å’Œå·²çŸ¥ç‰©ä½“çš„æµ‹é‡æ–¹æ³•ã€‚\nå‡è®¾æœ‰ä¸€ä¸ªå®½åº¦ä¸º $W$ çš„ç›®æ ‡æˆ–è€…ç‰©ä½“ï¼Œç„¶åå°†å®ƒæ”¾åœ¨è·ç¦»ç›¸æœºä¸º $D$ çš„ä½ç½®ï¼Œç”¨è¯¥ç›¸æœºå¯¹è¯¥ç‰©ä½“è¿›è¡Œæ‹ç…§å¹¶ä¸”æµ‹é‡ç‰©ä½“çš„åƒç´ å®½åº¦ $P$ ,åˆ™ç›¸æœºçš„ç„¦è·å…¬å¼ä¸ºï¼š $$ F = (P * D) / W $$ å½“ç»§ç»­å°†ç›¸æœºç§»åŠ¨é è¿‘æˆ–è¿œç¦»ç‰©ä½“æˆ–ç›®æ ‡æ˜¯ï¼Œå¯åˆ©ç”¨ç›¸ä¼¼ä¸‰è§’å½¢è®¡ç®—ç‰©ä½“ä¸ç›¸æœºçš„é—´è·ï¼š $$ D = (W * F) / P $$ å•ç›®ç›®æ ‡æ£€æµ‹ï¼š\nåœ¨3Dç›®æ ‡æ£€æµ‹é¢†åŸŸï¼Œæ ¹æ®è¾“å…¥ä¿¡æ¯çš„ä¸åŒï¼Œå¤§è‡´å¯åˆ†ä¸ºä¸‰ç±»\nPoint Cloud-based Methods (åŸºäºç‚¹äº‘) â€”â€”ç»å…¸ Multimodal Fusion-based Methods (ç‚¹äº‘å’Œå›¾åƒçš„èåˆ) â€”â€”ä¸»æµ Monocular/Stereo Image-based Methods (å•ç›®/ç«‹ä½“å›¾åƒçš„æ–¹æ³•) åŒç›®æ‘„åƒå¤´ åŒç›®æµ‹è·ï¼š\né€šè¿‡ä¸¤å¹…å›¾åƒçš„è§†å·®è®¡ç®—ã€‚\nåŒç›®è§†è§‰ç›®æ ‡æ£€æµ‹ï¼š\nåŸºäºç›´æ¥è§†é”¥ç©ºé—´çš„åŒç›®ç›®æ ‡æ£€æµ‹æ–¹æ³•\nä¸éœ€è¦é¢å¤–çš„åæ ‡ç©ºé—´è½¬æ¢ï¼Œåªéœ€è¦åŸºç¡€éª¨å¹²æå–çš„ä¸¤ä¸ªå•ç›®ç‰¹å¾æ„é€ åŒç›®ç‰¹å¾ã€‚\nåŸºäºä¸²æ¥æ„é€ è§†é”¥ç©ºé—´ç‰¹å¾çš„æ–¹æ³•\nå°†åŸºç¡€éª¨å¹²æå–çš„ä¸¤ä¸ªå•ç›®è§†é”¥ç©ºé—´ç‰¹å¾ä¸²æ¥èµ·æ¥ï¼Œåˆ©ç”¨å·ç§¯ç¥ç»ç½‘ç»œå¼ºå¤§çš„æ‹Ÿåˆèƒ½åŠ›æå–å€™é€‰æ¡†æˆ–ç›´æ¥æ£€æµ‹ä¸‰ç»´ç›®æ ‡ã€‚ä¸æ”¹å˜åŸå•ç›®ç‰¹å¾çš„ç©ºé—´åæ ‡ï¼Œç®€å•å¿«é€Ÿã€‚\nåŸºäºå¹³é¢æ‰«ææ„é€ è§†é”¥ç©ºé—´ç‰¹å¾çš„æ–¹æ³•\nåŸºäºå¹³é¢æ‰«æçš„æ£€æµ‹æ–¹æ³•å—ç›ŠäºåŒç›®æ·±åº¦ä¼°è®¡æ–¹æ³•çš„å‘å±•ï¼Œèƒ½å¤Ÿç›´æ¥åˆ©ç”¨ç‚¹äº‘ç›‘ç£å–å¾—æ›´å¥½çš„åŒ¹é…ç»“æœï¼Œè¿›è€Œå­¦ä¹ åˆ°æ¯ä¸ªè§†é”¥ç©ºé—´åƒç´ æ˜¯å¦è¢«ç‰©ä½“å æ®çš„ä¿¡æ¯ï¼Œè¾…åŠ©æé«˜ä¸‰ç»´æ£€æµ‹æ€§èƒ½ã€‚\nåŸºäºæ˜¾å¼é€†æŠ•å½±ç©ºé—´çš„åŒç›®ç›®æ ‡æ£€æµ‹æ–¹æ³•\né€†æŠ•å½±å˜æ¢ä¸»è¦å¯ä»¥åº”ç”¨åœ¨è¾“å…¥å›¾åƒã€ç‰¹å¾ã€å€™é€‰åŒºåŸŸä¸‰ä¸ªä¸åŒç¯èŠ‚ã€‚\nåŸºäºåŸå§‹å›¾åƒè§†å·®çš„é€†æŠ•å½±æ–¹æ³•\nä¼ªé›·è¾¾æ–¹æ³•ã€‚\nåŸºäºç‰¹å¾ä½“çš„é€†æŠ•å½±æ–¹æ³•\nåŸºäºç‰¹å¾ä½“é€†æŠ•å½±çš„åŒç›®ç›®æ ‡æ£€æµ‹æ–¹æ³•é€šè¿‡æ’å€¼å’Œé‡‡æ ·çš„æ–¹å¼å°†å¹³é¢æ‰«æå¾—åˆ°çš„åŒ¹é…ä»£ä»·ä½“å˜æ¢åˆ°ä¸‰ç»´ç©ºé—´ï¼Œåˆ©ç”¨äº†å›¾åƒç‰¹å¾æä¾›çš„é¢œè‰²å’Œçº¹ç†ä¿¡æ¯ï¼Œå®ç°äº†ç«¯åˆ°ç«¯è®­ç»ƒçš„åŒç›®ç›®æ ‡æ£€æµ‹ã€‚\nåŸºäºå€™é€‰åƒç´ è§†å·®çš„é€†æŠ•å½±æ–¹æ³•\nè¿™ç§é€†æŠ•å½±æ–¹æ³•ç”Ÿæˆçš„ä¸‰ç»´ç©ºé—´æœ‰æ•ˆä½“ç´ è¾ƒå°‘ï¼Œå¯ä»¥åœ¨æœ‰é™çš„æ£€æµ‹æ—¶é—´å†…æ›´çµæ´»åœ°æ§åˆ¶ç‰¹å¾çš„ç©ºé—´åˆ†è¾¨ç‡ï¼›èšç„¦äºå‰æ™¯ç›®æ ‡ï¼Œèƒ½å¤Ÿé¿å…ä¸å‡†ç¡®çš„æ·±åº¦ä¼°è®¡å¸¦æ¥çš„æ€§èƒ½ä¸‹é™ã€‚\nå§¿æ€æ„ŸçŸ¥å•å…ƒ æƒ¯æ€§å¯¼èˆªç³»ç»Ÿ æƒ¯æ€§å¯¼èˆªç³»ç»Ÿï¼ˆInertial Navigation Systemï¼ŒINSï¼‰æ˜¯ä¸€ç§åˆ©ç”¨æƒ¯æ€§æ•æ„Ÿå™¨ä»¶ã€åŸºå‡†æ–¹å‘åŠæœ€åˆçš„ä½ç½®ä¿¡æ¯ï¼Œæ¥ç¡®å®šè¿è½½ä½“åœ¨æƒ¯æ€§ç©ºé—´ä¸­çš„ä½ç½®ã€æ–¹å‘å’Œé€Ÿåº¦çš„è‡ªä¸»å¼å¯¼èˆªç³»ç»Ÿï¼Œæœ‰æ—¶ä¹Ÿç®€ç§°ä¸ºæƒ¯å¯¼ã€‚å…¶å·¥ä½œç¯å¢ƒä¸ä»…åŒ…æ‹¬ç©ºä¸­ã€åœ°é¢ï¼Œè¿˜å¯ä»¥åœ¨æ°´ä¸‹ã€‚\næƒ¯æ€§ç³»ç»Ÿè‡³å°‘éœ€è¦åŒ…å«åŠ é€Ÿåº¦è®¡ã€é™€èºä»ªç­‰çš„æƒ¯æ€§æµ‹é‡å•å…ƒå’Œç”¨äºæ¨ç†çš„è®¡ç®—å•å…ƒä¸¤å¤§éƒ¨åˆ†ã€‚\nè®¡ç®—å•å…ƒæµç¨‹å›¾ï¼š\nstateDiagram-v2 direction TB state æƒ¯æ€§å•å…ƒ{ åŠ é€Ÿåº¦è®¡ é™€èºä»ª ç£åŠ›è®¡ } æƒ¯æ€§å•å…ƒ --\u003e å§¿æ€è§£ç®— å§¿æ€è§£ç®— --\u003e åŠ é€Ÿåº¦ç§¯åˆ† åŠ é€Ÿåº¦ç§¯åˆ† --\u003e è¯¯å·®è¡¥å¿ è¯¯å·®è¡¥å¿ --\u003e å§¿æ€å’Œä½ç½® å¤šæºèåˆè§†è§‰å¤„ç† è§†è§‰+æƒ¯æ€§èåˆ è§†è§‰æƒ¯æ€§èåˆå®šä½éœ€è¦è§†è§‰ä¼ æ„Ÿå™¨å’Œæƒ¯æ€§æµ‹é‡ä¼ æ„Ÿå™¨è¿›è¡Œèåˆã€‚ èåˆæ–¹æ¡ˆ ä¸€èˆ¬å¯ä»¥åˆ†ä¸ºæ¾è€¦åˆå’Œç´§è€¦åˆã€‚\næ¾è€¦åˆæƒ…å†µä¸‹æ˜¯ä¸¤ä¸ªä¼˜åŒ–é—®é¢˜ï¼Œè§†è§‰æµ‹é‡ä¼˜åŒ–é—®é¢˜åŒ…å«è§†è§‰çš„çŠ¶æ€å˜é‡ï¼Œæƒ¯æ€§æµ‹é‡çš„ä¼˜åŒ–é—®é¢˜åŒ…å«æƒ¯æ€§æµ‹é‡çš„çŠ¶æ€å˜é‡ï¼Œæœ€ç»ˆï¼Œæˆ‘ä»¬åªæ˜¯èåˆè¿™ä¸¤ä¸ªä¼˜åŒ–å¾—åˆ°çš„ä½å§¿ä¼°è®¡ç»“æœã€‚\nç´§è€¦åˆæ˜¯ä¸€ä¸ªä¼˜åŒ–é—®é¢˜ï¼Œå®ƒå°†è§†è§‰æµ‹é‡å’Œæƒ¯æ€§æµ‹é‡æ”¾åœ¨åŒä¸€ä¸ªçŠ¶æ€å‘é‡ä¸­ï¼Œæ„å»ºåŒ…å«è§†è§‰æ®‹å·®å’Œæƒ¯æ€§æµ‹é‡æ®‹å·®çš„è¯¯å·®é¡¹ï¼ŒåŒæ—¶ä¼˜åŒ–è§†è§‰çŠ¶æ€å˜é‡å’Œæƒ¯æ€§æµ‹é‡çŠ¶ æ€å˜é‡ã€‚\nåŸºäºæ¨¡å‹çš„è§†è§‰/æƒ¯å¯¼ç»„åˆï¼š\nstateDiagram-v2 direction TB state åŸºäºæ¨¡å‹çš„çº¯è§†è§‰å¯¼èˆª{ è§†è§‰åŸå§‹æ•°æ® --\u003e å‰ç«¯è§†è§‰é‡Œç¨‹è®¡ é—­ç¯æ£€æµ‹ --\u003e åç«¯é—­ç¯ä¼˜åŒ–ä¸æ„å›¾ å‰ç«¯è§†è§‰é‡Œç¨‹è®¡ --\u003e åç«¯é—­ç¯ä¼˜åŒ–ä¸æ„å›¾ åç«¯é—­ç¯ä¼˜åŒ–ä¸æ„å›¾ --\u003e é—­ç¯æ£€æµ‹ è§†è§‰åŸå§‹æ•°æ® --\u003e é—­ç¯æ£€æµ‹ } åç«¯é—­ç¯ä¼˜åŒ–ä¸æ„å›¾ --\u003e å¯¼èˆªå‚æ•°ä¸ç¯å¢ƒåœ°å›¾ åç«¯é—­ç¯ä¼˜åŒ–ä¸æ„å›¾ --\u003e å¯¼èˆªä¿¡æ¯èåˆ state æƒ¯å¯¼ { æƒ¯æ€§åŸå§‹æ•°æ® --\u003e æƒ¯æ€§ä¿¡æ¯é¢„å¤„ç† æƒ¯æ€§ä¿¡æ¯é¢„å¤„ç† --\u003e å¯¼èˆªä¿¡æ¯èåˆ } æƒ¯æ€§ä¿¡æ¯é¢„å¤„ç† --\u003e å‰ç«¯è§†è§‰é‡Œç¨‹è®¡ å¯¼èˆªä¿¡æ¯èåˆ --\u003e å¯¼èˆªå‚æ•°ä¸ç¯å¢ƒåœ°å›¾ è§†è§‰+æ— çº¿ç”µèåˆ ASç®—æ³• éšæœºæ£®æ—åˆ†ç±»ç®—æ³• SVMç®—æ³• å¤šæºèåˆ å¤šä¼ æ„Ÿå™¨èåˆå±‚æ¬¡ï¼ˆçº§åˆ«ï¼‰ åŸºæœ¬åŸç†å›¾ï¼š\nstateDiagram-v2 ç›‘æµ‹å¯¹è±¡ --\u003e sensor state sensor{ direction TB ä¼ æ„Ÿå™¨1 ä¼ æ„Ÿå™¨2 .... ä¼ æ„Ÿå™¨n } sensor --\u003e features state features{ direction TB ç‰¹å¾æå–1 ç‰¹å¾æå–2 .. ç‰¹å¾æå–n } features --\u003e identify state identify{ direction TB è¯†åˆ«1 è¯†åˆ«2 ... è¯†åˆ«n } identify --\u003e å†³ç­–çº§èåˆ å†³ç­–çº§èåˆ --\u003e å†³ç­– åœ¨å¤šä¼ æ„Ÿå™¨ä¿¡æ¯èåˆä¸­ï¼ŒæŒ‰å…¶åœ¨èåˆç³»ç»Ÿä¸­ä¿¡æ¯å¤„ç†çš„æŠ½è±¡ç¨‹åº¦å¯åˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡ï¼š\næ•°æ®çº§èåˆ\nä¹Ÿç§°åƒç´ çº§èåˆï¼Œå±äºåº•å±‚æ•°æ®èåˆï¼Œæ•°æ®çº§èåˆä¸å­˜åœ¨æ•°æ®ä¸¢å¤±çš„é—®é¢˜ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿä½œä¸ºå‡†ç¡®ï¼›ä½†æ˜¯è®¡ç®—é‡å¤§ï¼Œå¯¹ç³»ç»Ÿé€šä¿¡å¸¦å®½è¦æ±‚è¾ƒé«˜ï¼›\nç‰¹å¾çº§èåˆ\nåˆ†ä¸ºç›®æ ‡çŠ¶æ€èåˆã€ç›®æ ‡ç‰¹å¾èåˆï¼Œ\nç‰¹å¾å±‚èåˆæŠ€æœ¯å‘å±•è¾ƒä¸ºå®Œå–„ï¼Œæ­¤çº§åˆ«èåˆå¯¹è®¡ç®—é‡å’Œé€šä¿¡å¸¦å®½è¦æ±‚ç›¸å¯¹é™ä½ï¼Œä½†ç”±äºéƒ¨åˆ†æ•°æ®çš„èˆå¼ƒä½¿å…¶å‡†ç¡®æ€§ä¹Ÿæœ‰æ‰€ä¸‹é™ã€‚\nå†³ç­–çº§èåˆ\nå¤šä¼ æ„Ÿå™¨èåˆä½“ç³»ç»“æ„ é›†ä¸­å¼ åˆ†å¸ƒå¼ æ··åˆå¼ ","date":"2023-07-17T10:50:29+08:00","image":"https://haoleng-wick.github.io/p/%E8%A7%86%E8%A7%89%E5%AF%BC%E8%88%AA%E7%BB%BC%E8%BF%B0/R-C_hu13558946655315622512.jpg","permalink":"https://haoleng-wick.github.io/p/%E8%A7%86%E8%A7%89%E5%AF%BC%E8%88%AA%E7%BB%BC%E8%BF%B0/","title":"è§†è§‰å¯¼èˆªç»¼è¿°"},{"content":"å¼•è¨€ å®‰è£…ç›¸å…³ å®‰è£…Anaconda\né€šè¿‡é“¾æ¥Anacondaä¸‹è½½å®‰è£…åŒ…å¹¶æ ¹æ®æç¤ºå®‰è£…åˆ°è‡ªå·±çš„ç›®æ ‡ç›®å½•ä¸‹ã€‚å›½å†…ç½‘ç»œç¯å¢ƒä¸å‹å¥½ï¼Œå¯ä»¥æ›´æ¢å›½å†…é•œåƒæºã€‚\nç„¶ååœ¨å½“å‰ç¯å¢ƒä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ç¯å¢ƒå‘½åä¸º pytorch(å¯éšæ„ç¡®å®š) å¹¶åˆ‡æ¢åˆ°æ–°ç¯å¢ƒ(pytorch)ä¸‹ï¼Œå†å®‰è£…pytorchæ‰€éœ€çš„ç¯å¢ƒ\n1 2 3 4 5 6 7 (base)$ conda create -n pytorch python=3.10 (base)$ conda activate pytorch # GPUç‰ˆæœ¬çš„ (pytorch)$ conda install pytorch torchvision torchaudio pytorch-cuda=11.7 -c pytorch -c nvidia # CPUç‰ˆæœ¬çš„ (pytorch)$ conda install pytorch torchvision torchaudio cpuonly -c pytorch å®‰è£…å®Œæˆä¹‹åè¿›è¡ŒéªŒè¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 (pytorch)$ python Python 3.10.11 (main, Apr 20 2023, 19:02:41) [GCC 11.2.0] on linux Type \u0026#34;help\u0026#34;, \u0026#34;copyright\u0026#34;, \u0026#34;credits\u0026#34; or \u0026#34;license\u0026#34; for more information. \u0026gt;\u0026gt;\u0026gt; import torch # æ²¡æœ‰æŠ¥é”™è¯´æ˜ pytorch å®‰è£…æˆåŠŸ \u0026gt;\u0026gt;\u0026gt; torch.cuda.is_available() # Trueè¯´æ˜ GPU å¯ç”¨,æˆ‘è¿™é‡Œ linux ç³»ç»Ÿå¹¶æ²¡æœ‰è£… nvidia æ˜¾å¡é©±åŠ¨ï¼Œæ‰€ä»¥æ˜¯ False False \u0026gt;\u0026gt;\u0026gt; x = torch.rand(5, 3) \u0026gt;\u0026gt;\u0026gt; print(x) tensor([[0.7296, 0.8000, 0.3431], [0.9990, 0.2202, 0.0889], [0.1130, 0.9352, 0.8562], [0.4942, 0.4214, 0.4962], [0.3023, 0.7504, 0.6801]]) \u0026gt;\u0026gt;\u0026gt; Tensorboardä½¿ç”¨ ä¸¾ä¸€ä¸ªç®€å•çš„ç”»ä¸‰è§’å‡½æ•°å›¾åƒçš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 import numpy as np from torch.utils.tensorboard import SummaryWriter writer = SummaryWriter(\u0026#34;./test_logs\u0026#34;) # å¯è‡ªå®šä¹‰è¾“å‡ºä½ç½®ï¼Œé»˜è®¤ä¸º./runs r = 5 for i in range(100): writer.add_scalars(\u0026#39;trigonometric function\u0026#39;, {\u0026#39;xsinx\u0026#39;:i*np.sin(i/r), \u0026#39;xcosx\u0026#39;:i*np.cos(i/r), \u0026#39;tanx\u0026#39;: np.tan(i/r)}, i) writer.close() ç„¶åé€šè¿‡å‘½ä»¤ tensorboard --logdir=test_logsï¼Œæ ¹æ®æç¤ºå¯ä»¥æ‰“å¼€ç½‘é¡µçœ‹åˆ°ç»“æœï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\nTransformså›¾åƒå˜æ¢\n1 2 3 4 5 6 7 8 9 10 11 from torchvision import transforms transforms.CenterCrop() #å¯¹å›¾ç‰‡ä¸­å¿ƒè¿›è¡Œè£å‰ª transforms.FiveCrop() #å¯¹å›¾åƒå››ä¸ªè§’å’Œä¸­å¿ƒè¿›è¡Œè£å‰ªå¾—åˆ°äº”åˆ†å›¾åƒ transforms.Grayscale() #å¯¹å›¾åƒè¿›è¡Œç°åº¦å˜æ¢ transforms.Pad() #ä½¿ç”¨å›ºå®šå€¼è¿›è¡Œåƒç´ å¡«å…… transforms.RandomResizedCrop()\t#éšå³è£å‰ªä¸ºä¸åŒå¤§å°å’Œå®½é«˜æ¯”ï¼Œç„¶åç¼©æ”¾ä¸ºç‰¹å®šå¤§å° transforms.RandomCrop() #éšæœºåŒºåŸŸè£å‰ª transforms.RandomRotation() #éšæœºæ—‹è½¬ transforms.RandomHorizontalFlip() #éšæœºæ°´å¹³ç¿»è½¬ transforms.Normalize()\t#å½’ä¸€åŒ–å¤„ç† ... transforms.Composeç»„åˆå®ç°å„ç§å˜åŒ–\n1 2 3 4 5 transform = transforms.Compose([ transforms.Random transforms.ToTensor(), transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5)) ]) torchvisionã€DataLoader\nnn.Module\nå·ç§¯å±‚ æ¿€æ´»å±‚ æ± åŒ–å±‚ å…¨è¿æ¥å±‚ æŸå¤±å‡½æ•° L1Loss \u0026amp;\u0026amp; MSELoss å‡è®¾é¢„æœŸç»“æœä¸º [1, 2, 8]ï¼Œä½†å®é™…ç»“æœä¸º [1, 2, 3]\nå®šä¹‰ï¼š\n$$ â„“(x,y)=\\begin{cases} mean(L),\\quad reduction=mean; \\\\\\\\ sum(L),\\quad reduction=sum \\end{cases} $$\nloss_l1 = nn.L1loss(reduction='mean'æˆ–è€…'sum')\nL1Lossçš„ç»“æœï¼š\n$$ â„“(x,y)=\\begin{cases} \\frac {(1 - 1) + (2 - 2) + (8 - 3)}{3} = 1.67\t\\quad reduction = mean \\\\\\ (1 - 1) + (2 - 2) + (8 - 3) = 5\t\\quad reduction = sum \\end{cases} $$\nloss_mse = nn.MSELoss()\nMSELossçš„ç»“æœï¼š\n$$ â„“(x,y)=\\begin{cases} \\frac {(1 - 1)^2 + (2 - 2)^2 + (8 - 3)^2}{3} = 8.33\t\\quad reduction = mean \\\\\\ (1 - 1)^2 + (2 - 2)^2 + (8 - 3)^2 = 25\t\\quad reduction = sum \\end{cases} $$\nCrossEntropyLoss torch.nn.CrossEntropyLoss(weight=None, ignore_index=- 100, reduction='mean', label_smoothing=0.0)\nå®šä¹‰ï¼š\n$$ loss(x, class) = -ln(\\frac{e^{x[class]}}{\\sum_j e^{x[j]}}) \\\\\\ =-x[class] + ln(\\sum_j e^{x[j]}) $$\n1 2 3 4 5 6 7 8 9 10 11 12 13 import torch from torch import nn ## target\t[person, dog, cat] ## intputs\t[0.1, 0.2, 0.3] inputs = torch.tensor([0.1, 0.2, 0.3]) target = torch.tensor([1])\t# 1ä»£è¡¨dog inputs = torch.reshape(inputs, (1, 3)) loss_cross = nn.CrossEntropyLoss() result_cross = loss_cross(inputs, target) print(result_cross) ## è¾“å‡º ## tensor(1.1019) CrossEntropyLossçš„ç»“æœï¼š\n$$ loss(x, class) = -0.2 + ln(e^{0.1} + e^{0.2} + e^{0.3}) = 1.1019 $$\nä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼ˆCifar-10åˆ†ç±»ä»»åŠ¡ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 # -*- coding: utf-8 -*- # å¯¼å…¥åŒ… import torch import torchvision from torch.utils.tensorboard import SummaryWriter from torch import nn from torch.utils.data import DataLoader # å¯¼å…¥æ•°æ®é›† train_data = torchvision.datasets.CIFAR10(root=\u0026#34;./data\u0026#34;, train=True, transform=torchvision.transforms.ToTensor(), download=True) test_data = torchvision.datasets.CIFAR10(root=\u0026#34;./data\u0026#34;, train=False, transform=torchvision.transforms.ToTensor(), download=True) # è¾“å‡ºè®­ç»ƒå’Œæµ‹è¯•æ€»é‡ train_data_size = len(train_data) test_data_size = len(test_data) print(\u0026#34;è®­ç»ƒé›†çš„å¤§å°: {}\u0026#34;.format(train_data_size)) print(\u0026#34;æµ‹è¯•é›†çš„å¤§å°: {}\u0026#34;.format(test_data_size)) batch_size = 64 train_dataloader = DataLoader(train_data, batch_size=batch_size) test_dataloader = DataLoader(test_data, batch_size=batch_size) class MyModel(nn.Module): def __init__(self): super().__init__() self.model = nn.Sequential( nn.Conv2d(3, 32, 5, stride=1, padding=2), nn.MaxPool2d(2), nn.Conv2d(32, 32, 5, stride=1, padding=2), nn.MaxPool2d(2), nn.Conv2d(32, 64, 5, stride=1, padding=2), nn.MaxPool2d(2), nn.Flatten(), nn.Linear(64*4*4, 64), nn.Linear(64, 10) ) def forward(self, x): x = self.model(x) return x # å®ä¾‹ä¸€ä¸ªmodel my_model = MyModel() # GPU if torch.cuda.is_available(): my_model = my_model.cuda() # æŸå¤±å‡½æ•° loss_fn = nn.CrossEntropyLoss() # äº¤å‰ç†µ if torch.cuda.is_available(): loss_fn = loss_fn.cuda() # ä¼˜åŒ–å™¨ learning_rate = 0.01 # å­¦ä¹ ç‡ optimizer = torch.optim.SGD(my_model.parameters(), lr=learning_rate) # è®­ç»ƒå‚æ•° total_train_step = 0 total_test_step = 0 epoch = 16 # tensorboard writer = SummaryWriter(\u0026#34;./taining_logs\u0026#34;) for i in range(epoch): print(\u0026#34;----å¼€å§‹ç¬¬ {} è½®è®­ç»ƒ----\u0026#34;.format(i+1)) my_model.train() for data in train_dataloader: imgs, labels = data if torch.cuda.is_available(): imgs = imgs.cuda() labels = labels.cuda() outputs = my_model(imgs) loss = loss_fn(outputs, labels) # ä¼˜åŒ– optimizer.zero_grad() loss.backward() optimizer.step() total_train_step = total_train_step + 1 # æ¯100æ¬¡æ˜¾ç¤ºä¸€æ¬¡ if total_train_step % 100 == 0: print(\u0026#34;ç¬¬ {} æ¬¡è®­ç»ƒçš„losså€¼: {}\u0026#34;.format(total_train_step, loss.item())) writer.add_scalar(\u0026#34;train_loss\u0026#34;, loss.item(), total_train_step) # æµ‹è¯•æ­¥éª¤å¼€å§‹ my_model.eval() total_test_loss = 0 total_accuracy = 0 # æµ‹è¯•é›†ä¸éœ€è¦æ¢¯åº¦ with torch.no_grad(): for data in test_dataloader: imgs, labels = data if torch.cuda.is_available(): imgs = imgs.cuda() labels = labels.cuda() outputs = my_model(imgs) loss = loss_fn(outputs, labels) total_test_loss = total_test_loss + loss.item() accuracy = (outputs.argmax(1) == labels).sum() total_accuracy = total_accuracy + accuracy print(\u0026#34;æ•´ä½“æµ‹è¯•é›†ä¸Šçš„Loss: {}\u0026#34;.format(total_test_loss)) print(\u0026#34;æ•´ä½“æµ‹è¯•é›†ä¸Šçš„æ­£ç¡®ç‡: {}\u0026#34;.format(total_accuracy / test_data_size)) writer.add_scalar(\u0026#34;test_loss\u0026#34;, total_test_loss, total_test_step) writer.add_scalar(\u0026#34;test_accuracy\u0026#34;, total_accuracy / test_data_size, total_test_step) total_test_step = total_test_step + 1 torch.save(my_model, \u0026#34;my_cifar10.pth\u0026#34;) print(\u0026#34;æ¨¡å‹å·²ä¿å­˜\u0026#34;) writer.close() Pytorch å„ç§æ¨¡å‹çš„æ ¼å¼ æ ¼å¼ è¯´æ˜ é€‚ç”¨åœºæ™¯ å¯¹åº”åç¼€ .ptæˆ–.pth pytorché»˜è®¤çš„æ¨¡å‹æ–‡ä»¶ éœ€è¦ä¿å­˜å’ŒåŠ è½½å®Œæ•´Pytorchæ¨¡å‹çš„åœºæ™¯ .ptæˆ–.pth .bin é€šç”¨çš„äºŒè¿›åˆ¶æ ¼å¼ éœ€è¦å°†Pytorchæ¨¡å‹è½¬åŒ–ä¸ºé€šç”¨çš„äºŒè¿›åˆ¶æ ¼å¼çš„åœºæ™¯ .bin .onnx é€šç”¨çš„äº¤å‰æ¨¡å‹æ ¼å¼ éœ€è¦å°†Pytorchæ¨¡å‹è½¬åŒ–ä¸ºå…¶ä»–æ·±åº¦å­¦ä¹ æ¡†æ¶æˆ–ç¡¬ä»¶å¹³å°å¯ç”¨çš„æ ¼å¼çš„åœºæ™¯ .onnx TorchScript Pytorchæä¾›çš„ä¸€ç§åºåˆ—åŒ–å’Œä¼˜åŒ–æ¨¡å‹çš„æ–¹æ³• éœ€è¦å°†Pytorchæ¨¡å‹åºåˆ—åŒ–å’Œä¼˜åŒ–ï¼Œå¹¶åœ¨æ²¡æœ‰Pytorchç¯å¢ƒçš„æƒ…å†µä¸‹è¿è¡Œæ¨¡å‹çš„åœºæ™¯ .ptæˆ–.pth ç›®æ ‡æ£€æµ‹æ•°æ®é›† VOCæ•°æ®é›† Annotationsï¼š åŒ…å«äº†xmlæ–‡ä»¶ï¼Œæè¿°äº†å›¾ç‰‡çš„å„ç§ä¿¡æ¯ï¼Œç‰¹åˆ«æ˜¯ç›®æ ‡çš„åæ ‡ä½ç½® ImagesSetsï¼š ä¸»è¦å…³æ³¨Mainæ–‡ä»¶å¤¹çš„å†…å®¹ï¼Œé‡Œé¢çš„æ–‡ä»¶åŒ…å«äº†ä¸åŒç±»åˆ«ç›®æ ‡çš„è®­ç»ƒ/éªŒè¯æ•°æ®é›†çš„å›¾ç‰‡åç§° JPEGImagesï¼š å›¾ç‰‡åŸæ–‡ä»¶ SegentationClass/Objectï¼š ç”¨äºè¯­ä¹‰åˆ†å‰² COCOæ•°æ®é›† åˆ›å»ºè‡ªå·±çš„cocoæ•°æ®é›†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 ç›®å½•ç»“æ„ï¼š ......... my_dataset â”œâ”€â”€â”€imgs â”‚ â”œâ”€â”€â”€1.jpg â”‚ â”œâ”€â”€â”€1.json â”‚ â”œâ”€â”€â”€2.jpg â”‚ â”œâ”€â”€â”€2.json â”‚ â”‚........... â”‚ â””â”€â”€â”€nnn.json â””â”€â”€â”€coco labelme2coco.py labels.txt ......... å®‰è£…labelme,ç„¶ååœ¨å½“å‰ç›®å½•æ‰§è¡Œå‘½ä»¤ï¼š\n1 python labelme2coco.py --labels labels.txt my_data/imgs/ my_data/coco/ å…¶ä¸­æ–‡ä»¶é“¾æ¥labelme2coco.pyå’Œlabels.txtæ–‡ä»¶ç¤ºä¾‹å¦‚ä¸‹(æœ¬æ¼”ç¤ºåªæœ‰ä¸€ä¸ªæ ‡ç­¾raccoon):\n1 2 3 __ignore__ _background_ raccoon ä¹‹åä¼šåœ¨cocoç›®å½•ä¸‹ç”Ÿæˆå¯ç”¨çš„cocoæ•°æ®é›†æ–‡ä»¶ã€‚\nåŠ è½½è¯¥æ•°æ®é›†å¹¶å¯è§†åŒ–æ˜¾ç¤ºçš„ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import torchvision from PIL import ImageDraw # torchå®˜æ–¹çš„Coco APIåŠ è½½æ•°æ®é›† coco_dataset = torchvision.datasets.CocoDetection(root=r\u0026#34;./my_data/coco/\u0026#34;, annFile=r\u0026#34;./my_data/coco/annotations.json\u0026#34;) # è¯»å–ç¬¬ä¸€å¼ å›¾ç‰‡å¹¶æ˜¾ç¤º image, info = coco_dataset[0] image_handler = ImageDraw.ImageDraw(image) # åœ¨è¯¥å›¾ç‰‡ä¸Šç”»ä¸Šæ ‡æ³¨æ¡† for annotation in info: x_min, y_min, width, height = annotation[\u0026#39;bbox\u0026#39;] image_handler.rectangle(((x_min, y_min), (x_min+width, y_min+height)), fill=None, outline=\u0026#39;red\u0026#39;, width=2) # æ˜¾ç¤º image.show() To be contuine\n","date":"2023-05-20T05:59:13+08:00","image":"https://haoleng-wick.github.io/p/pytorch%E5%85%A5%E9%97%A8/PyTorch_hu7179382626443050191.jpg","permalink":"https://haoleng-wick.github.io/p/pytorch%E5%85%A5%E9%97%A8/","title":"Pytorchå…¥é—¨"},{"content":"KMPç®—æ³• \u0026raquo;\u0026gt;é…åˆè§†é¢‘é£Ÿç”¨ï¼Œæ•ˆæœæ›´ä½³!\nKMPç®€ä»‹ KMPç®—æ³•ä¸»è¦ç”¨äºå­—ç¬¦ä¸²åŒ¹é…ã€‚\nKMPçš„ä¸»è¦æ€æƒ³æ˜¯å½“å‡ºç°å­—ç¬¦ä¸²ä¸åŒ¹é…æ—¶ï¼Œå¯ä»¥çŸ¥é“ä¸€éƒ¨åˆ†ä¹‹å‰å·²ç»åŒ¹é…çš„æ–‡æœ¬å†…å®¹ï¼Œå¯ä»¥åˆ©ç”¨è¿™äº›ä¿¡æ¯é¿å…ä»å¤´å†å»åšåŒ¹é…äº†ã€‚\nå‰ç¼€è¡¨ å‰ç¼€è¡¨æ˜¯ç”¨æ¥åŒ¹é…å›æº¯çš„ï¼Œå®ƒè®°å½•äº†æ¨¡å¼ä¸²ä¸ä¸»ä¸²ä¸åŒ¹é…æ—¶ï¼Œæ¨¡å¼ä¸²åº”è¯¥ä»å“ªé‡Œå¼€å§‹é‡æ–°åŒ¹é…ã€‚\nå‰ç¼€ï¼š ä¸åŒ…å«æœ€åä¸€ä¸ªå­—ç¬¦çš„æ‰€æœ‰ä»¥ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å¤´çš„è¿ç»­å­ä¸²ã€‚\nåç¼€ï¼šä¸åŒ…å«ç¬¬ä¸€ä¸ªå­—ç¬¦çš„æ‰€æœ‰ä»¥æœ€åä¸€ä¸ªå­—ç¬¦ç»“å°¾çš„è¿ç»­å­ä¸²ã€‚\nå‰ç¼€è¡¨ï¼šè®°å½•ä¸‹æ ‡iä¹‹å‰ï¼ˆåŒ…æ‹¬iï¼‰çš„å­—ç¬¦ä¸²ä¸­ï¼Œæœ‰å¤šå¤§é•¿åº¦çš„_ç›¸åŒå‰ç¼€åç¼€_ã€‚\né•¿åº¦ä¸ºå‰3ä¸ªå­—ç¬¦çš„å­ä¸²aabï¼Œå…¶æœ€é•¿ç›¸åŒå‰åç¼€çš„é•¿åº¦ä¸º0.\né•¿åº¦ä¸ºå‰4ä¸ªå­—ç¬¦çš„å­ä¸²aabaï¼Œå…¶æœ€é•¿ç›¸åŒå‰åç¼€çš„é•¿åº¦ä¸º1.\nåˆ©ç”¨å‰ç¼€è¡¨åŒ¹é…å­—ç¬¦ä¸²ï¼š\nå‰ç¼€è¡¨ä¸nextæ•°ç»„ nextæ•°ç»„å¯ä»¥æœ‰å¾ˆå¤šç§ç‰ˆæœ¬ï¼Œå…¶å½±å“çš„ä»…æ˜¯åŒ¹é…å¤±è´¥åå›æº¯æ—¶ä¾æ®çš„ä¸‹æ ‡ã€‚æœ¬æ–‡é‡‡ç”¨çš„æ—¶å‰ç¼€è¡¨ç»Ÿä¸€å‡å»ä¸€ä¹‹åçš„ç‰ˆæœ¬ï¼Œå³\n1 2 3 æ¨¡å¼ä¸²ï¼š\t\u0026#34;aabaaf\u0026#34; å‰ç¼€è¡¨ï¼š\t[0, 1, 0, 1, 2, 0] nextæ•°ç»„ï¼š[-1, 0, -1, 0, 1, -1] nextæ•°ç»„çš„æ„å»º åˆå§‹åŒ– å¤„ç†å‰åç¼€ä¸åŒçš„æƒ…å†µ å¤„ç†å‰åç¼€ç›¸åŒçš„æƒ…å†µ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 void get_next(int *next, char *needle) { // åˆå§‹åŒ– // jæ—¶å‰ç¼€çš„æœ«å°¾ï¼Œä¹Ÿä»£è¡¨äº†å‰ç¼€çš„é•¿åº¦ // å› ä¸ºåªæœ‰ç›¸ç­‰çš„æ—¶å€™jæ‰æ¨è¿›ï¼Œæ‰€ä»¥å®ƒèƒ½ä»£è¡¨æœ€é•¿ç›¸ç­‰å‰åç¼€çš„é•¿åº¦ï¼Œå³nextæ•°ç»„çš„å€¼ int j = -1; next[0] = j; // ä»ä¸‹æ ‡ä¸º1å¼€å§‹éå†ï¼Œiä½œä¸ºåç¼€çš„æœ«å°¾ for(int i = 1; i \u0026lt; strlen(needle); i++) { // ç”±äºå¯èƒ½å­˜åœ¨é€’å½’å›é€€ï¼Œæ‰€ä»¥è¦ç”¨while while(j \u0026gt;= 0 \u0026amp;\u0026amp; needle[i] != neddle[j+1])\t// å‰åç¼€ä¸ç›¸åŒ j = next[j];\t// å›æº¯åˆ°å‰ä¸€ä½nextæ•°ç»„å¯¹åº”çš„å€¼,ç”±äºè¿™é‡Œæ—¶j+1ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯next[j] if(needle[i] == needle[j+1])\t// ç›¸åŒç»§ç»­æ¨è¿› j++; next[i] = j;\t// å°†j(å‰ç¼€çš„é•¿åº¦)èµ‹å€¼ç»™next[i] } } ç”¨nextæ•°ç»„åŒ¹é… 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 int KMP(char *haystack, char *needle) { if(strlen(needle) == 0) return 0; int *next = malloc(strlen(needle) * sizeof(int)); get_next(next, needle); int j = -1; for(int i = 0; i \u0026lt; strlen(haystack); i++) { while(j \u0026gt;= 0 \u0026amp;\u0026amp; haystack[i] != needle[j+1]) // å›æº¯ j = next[j]; if(haystack[i] == needle[j+1]) // å‘å‰éå† j++; if(j == strlen(needle) - 1) // åˆ¤æ–­æ˜¯å¦åŒ¹é…å®Œæˆ return(i - strlen(needle) + 1); // è¿”å›haystackçš„ä¸‹æ ‡ } return -1; } Cè¯­è¨€å®ç°å®Œæ•´ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;string.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; int KMP(char *haystack, char *needle) { if(strlen(needle) == 0) return 0; // get_next int *next = malloc(strlen(needle) * sizeof(int)); int j = -1; next[0] = j; printf(\u0026#34;next[]: [ %d \u0026#34;,next[0]); for(int i = 1; i \u0026lt; strlen(needle); i++) { while(j \u0026gt;= 0 \u0026amp;\u0026amp; needle[i] != needle[j+1]) j = next[j]; if(needle[i] == needle[j+1]) j++; next[i] = j; printf(\u0026#34;%d \u0026#34;,next[i]); } printf(\u0026#34;]\\n\u0026#34;); // KMP j = -1; for(int i = 0; i \u0026lt; strlen(haystack); i++) { while(j \u0026gt;= 0 \u0026amp;\u0026amp; haystack[i] != needle[j+1]) j = next[j]; if(haystack[i] == needle[j+1]) j++; if(j == strlen(needle) - 1) { free(next); return(i - strlen(needle) + 1); } } free(next); return -1; } int main(int argc, char **argv) { if(argc != 3) fprintf(stderr, \u0026#34;Usage: ./a.out abcabcbb cab\\n\u0026#34;); int k = KMP(argv[1], argv[2]); printf(\u0026#34;the index is: %d \\n\u0026#34;, k); return 0; } ","date":"2023-05-11T14:32:13+08:00","image":"https://haoleng-wick.github.io/p/kmp%E7%AE%97%E6%B3%95/Kmp_hu10854606807330125474.jpg","permalink":"https://haoleng-wick.github.io/p/kmp%E7%AE%97%E6%B3%95/","title":"KMPç®—æ³•"},{"content":"ç¥ç»ç½‘ç»œè§†è§‰åŸºç¡€ åŸºç¡€çŸ¥è¯† ç¥ç»ç½‘ç»œçš„åŸºæœ¬åŸç† ç¥ç»ç½‘ç»œçš„è®­ç»ƒï¼Œä¸»è¦ç›®çš„å°±æ˜¯é€šè¿‡å­¦ä¹ ç®—æ³•å¾—åˆ°å„å±‚ç¥ç»å…ƒä¹‹é—´çš„è¿æ¥æƒé‡å’Œåç½®å‚æ•°ç­‰ï¼Œç„¶åé€šè¿‡å‚æ•°è®¡ç®—å‡ºè¾“å…¥å€¼çš„è¾“å‡ºã€‚\nå·ç§¯ç¥ç»ç½‘ç»œåŒ…æ‹¬è¾“å…¥å±‚ã€ä¸­é—´å±‚ã€è¾“å‡ºå±‚ã€‚è€Œä¸­é—´å±‚å¯ä»¥ç»†åŒ–ä¸ºå·ç§¯å±‚ã€æ¿€æ´»å±‚ã€æ± åŒ–å±‚å’Œå…¨è¿æ¥å±‚ã€‚\nå·ç§¯å±‚ï¼ˆå±€éƒ¨æ„ŸçŸ¥ã€æƒå€¼å…±äº«ï¼‰\u0026ndash;ï¼ˆå›¾åƒç‰¹å¾æå–ï¼‰ å·ç§¯å±‚ä¸­ï¼Œå·ç§¯æ“ä½œç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªå·ç§¯æ ¸(filter)åœ¨å‰å±‚å›¾åƒä¸Šé€‰æ‹©ç›¸åº”çš„åŒºåŸŸåšå·ç§¯è¿ç®—ï¼Œç„¶åæŒ‰ä¸€å®šçš„æ­¥é•¿ä½œæ»‘åŠ¨è¿ç®—ï¼Œä¾æ¬¡æå–å›¾åƒåŒºåŸŸçš„åƒç´ çº§ç‰¹å¾ï¼Œå›¾åƒç‰¹å¾ç»¼åˆåç»è¿‡æ¿€æ´»å‡½æ•°æ¿€æ´»ï¼Œå®Œæˆä¸€æ¬¡è¾“å…¥åˆ°è¾“å‡ºçš„ç‰¹å¾æå–è¿‡ç¨‹ï¼Œå·ç§¯åçš„ç‰¹å¾å›¾åæ˜ äº†å‰å±‚å›¾åƒçš„èåˆç‰¹å¾ã€‚\nå·ç§¯æ“ä½œ ç»å·ç§¯åçš„çŸ©é˜µå°ºå¯¸å¤§å°è®¡ç®—å…¬å¼ä¸º(è¾“å…¥å›¾ç‰‡å¤§å°WxWï¼Œå·ç§¯æ ¸FxFï¼Œæ­¥é•¿Sï¼Œpadding = P) $$ N = (W - F + 2P) / S + 1 $$\næ¿€æ´»å±‚ (é€šè¿‡å‡½æ•°æŠŠç‰¹å¾ä¿ç•™å¹¶æ˜ å°„åˆ°è¾“å‡ºç«¯) å·ç§¯ç¥ç»ç½‘ç»œåœ¨å·ç§¯æ“ä½œåä½œç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œå¯ä»¥å®ç°å¯¹è¾“å…¥ä¿¡æ¯çš„éçº¿æ€§å˜åŒ–ï¼Œä»è€Œä½¿ç½‘ç»œçš„è¾“å…¥å’Œè¾“å‡ºäº§ç”Ÿéçº¿æ€§æ˜ å°„å…³ç³»ï¼Œæ¿€æ´»å±‚å¯¹å·ç§¯åçš„é€å…ƒç´ ä½œç”¨æ¿€æ´»å‡½æ•°ï¼Œå®ç°è¾“å…¥å’Œè¾“å‡ºä¿¡æ¯çš„åŒç»´ã€‚å¼•å…¥æ¿€æ´»å‡½æ•°çš„ç›®çš„æ˜¯ä¸ºäº†å¢åŠ ç¥ç»ç½‘ç»œçš„éçº¿æ€§æ‹Ÿåˆèƒ½åŠ›ã€‚\n\u0026ldquo;ä¸ºä»€ä¹ˆä¸€å®šè¦éçº¿æ€§ï¼Ÿ\u0026rdquo;\nå› ä¸ºç¥ç»ç½‘ç»œçš„æ¯ä¸€æ¬¡è¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯çº¿æ€§æ±‚å’Œè¿‡ç¨‹ï¼Œä¸‹ä¸€å±‚è¾“å‡ºæ‰¿æ¥äº†ä¸Šä¸€å±‚è¾“å…¥å‡½æ•°çš„çº¿æ€§å˜æ¢ï¼Œå¦‚æœæ²¡æœ‰éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œé‚£ä¹ˆæ— è®ºç¥ç»ç½‘ç»œæœ‰å¤šå°‘å±‚ï¼Œæœ€åçš„è¾“å‡ºéƒ½æ˜¯è¾“å…¥çš„çº¿æ€§ç»„åˆã€‚è¿™æ ·çš„çº¿æ€§ç»„åˆå¹¶ä¸èƒ½è§£å†³å¤æ‚çš„é—®é¢˜ã€‚\næ¿€æ´»å‡½æ•° Sigmoidï¼ˆåˆç§°â€œé€»è¾‘å‡½æ•°â€ï¼‰ $$ f(x) = \\frac {1} {1 + e^{-x}} $$\n$$ y = \\begin{cases} 1, å½“S(x) \\ge 0.5 \\\\\\ 0, å½“S(x) \u0026lt; 0.5 \\end{cases} $$\n$$ S(x)\u0026rsquo; = \\frac{e^{-x}}{(1+e^{-x})^2} $$\nâ€‹\tä¼˜ç‚¹ï¼š\nå€¼åŸŸä¸º[0,1]ï¼Œä»–å¯¹æ¯ä¸ªç¥ç»å…ƒçš„è¾“å‡ºè¿›è¡Œäº†å½’ä¸€åŒ–ï¼Œé€‚åˆç”¨äºå°†é¢„æµ‹æ¦‚ç‡ä½œä¸ºè¾“å‡ºçš„æ¨¡å‹ æ¢¯åº¦å¹³æ»‘ï¼Œé¿å…äº†è·³è·ƒå¼ çš„è¾“å‡º â€‹\tç¼ºç‚¹ï¼š\næ¥è¿‘0æˆ–1çš„ç¥ç»å…ƒæ¢¯åº¦è¶‹è¿‘äº0ï¼Œå®¹æ˜“å¼•èµ·æ¢¯åº¦æ¶ˆå¤±ï¼Œå³æ— æ³•åå‘ä¼ æ’­æ›´æ–°æƒé‡ã€‚ è®¡ç®—é‡å¤§ï¼Œéœ€è¦æ›´é«˜çš„ç®—åŠ› ReLUï¼ˆç›®å‰ä¸»æµçš„æ¿€æ´»å‡½æ•°ï¼‰ $$ f(x) = Max(0, x) $$\n$$ f\u0026rsquo;(x) = Sgn(x) $$\nâ€‹\tç›¸æ¯”sigmoidå‡½æ•°ï¼Œå…¶è®¡ç®—é€Ÿåº¦å¿«ï¼Œæ”¶æ•›é€Ÿåº¦å¿«ï¼ˆå› ä¸ºè¾“å…¥ä¸ºè´Ÿå€¼æ—¶ï¼Œç¥ç»å…ƒä¸ä¼šè¢«æ¿€æ´»ï¼Œæ‰€ä»¥ç½‘ç»œå¾ˆç¨€ç–ï¼Œèƒ½æ›´å¥½çš„æå–ç›¸å…³ç‰¹å¾ï¼Œæ‹Ÿåˆè®­ç»ƒæ•°æ®ï¼‰ã€‚ReLUå‡½æ•°èƒ½å¤Ÿæœ€å¤§åŒ–å‘æŒ¥ç¥ç»å…ƒçš„ç­›é€‰èƒ½åŠ›ã€‚\nä¸è¶³ï¼šå¾ˆå®¹æ˜“è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿éƒ¨åˆ†kernelåºŸæ‰ï¼Œä¸”æ— æ³•å†æ¬¡è¢«æ¿€æ´»ã€‚\n\u0026ldquo;ReLUæ˜¯åˆ†æ®µçº¿æ€§å‡½æ•°ï¼Œå®ƒæ˜¯æ€ä¹ˆå®ç°éçº¿æ€§çš„ï¼Ÿ\u0026rdquo;\nReLUåœ¨æ•´ä¸ªå®šä¹‰åŸŸå†…å¹¶ä¸æ˜¯çº¿æ€§çš„ï¼Œç»„åˆå¤šä¸ªï¼ˆçº¿æ€§æ“ä½œ+ReLUï¼‰å°±å¯ä»¥ä»»æ„åˆ’åˆ†ç©ºé—´ï¼Œå¯¹äºå±‚æ•°æ¯”è¾ƒå°‘çš„ç¥ç»ç½‘ç»œï¼Œç”¨ReLUä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œé‚£éçº¿æ€§è‚¯å®šæ²¡æœ‰é‚£ä¹ˆå¼ºï¼Œä½†æ˜¯å½“å±‚æ•°å¤šè¾¾å‡ åç”šè‡³ä¸Šåƒï¼Œè™½ç„¶ï¼Œå•ç‹¬çš„éšè—å±‚æ˜¯çº¿æ€§çš„ï¼Œä½†æ˜¯å¾ˆå¤šçš„éšè—å±‚è¡¨ç°å‡ºæ¥çš„å°±æ˜¯éçº¿æ€§çš„ã€‚ï¼ˆå³ç”¨å¾ˆå¤šå°çš„ç›´çº¿å¯ä»¥æ‹Ÿåˆå‡ºæ›²çº¿æ•ˆæœä¸€æ ·ï¼‰ã€‚\nLeaky ReLU $$\rf(x) = max(\\alpha x, x)\r$$\râ€‹\tå…¶ä¸­$\\alpha$ä¸º(0,1)çš„ç³»æ•°ï¼Œå¯ä»¥æœ‰æ•ˆè§£å†³*ReLU*å‡½æ•°ç¥ç»å…ƒæ­»äº¡çš„ç°è±¡ã€‚\rSoftmax (æ‰€æœ‰è¾“å‡ºæ¦‚ç‡å’Œä¸º1) $$ o_i = \\frac {e^{y_i}} {\\sum_je^{y_j}} $$\nç”¨äºå¤šåˆ†ç±»é—®é¢˜çš„æ¿€æ´»å‡½æ•° åœ¨é›¶ç‚¹ä¸å¯å¾®ï¼Œè´Ÿè¾“å…¥çš„æ¢¯åº¦ä¸ºé›¶ä¼šäº§ç”Ÿâ€œæ­»äº¡ç¥ç»å…ƒâ€ å¯¹äºäºŒåˆ†ç±»é—®é¢˜ï¼Œç†è®ºä¸Šä½¿ç”¨sigmoidå’Œsoftmaxæ²¡æœ‰åŒºåˆ«ï¼Œå› ä¸ºæ•°å­¦è¡¨è¾¾å¼çš„å½¢å¼æ˜¯ä¸€æ ·çš„ã€‚ å¯¹äºå¤šåˆ†ç±»éäº’æ–¥é—®é¢˜ï¼ˆå¤šæ ‡ç­¾åˆ†ç±»ï¼‰å¦‚äººå’Œå¥³äººï¼Œä½¿ç”¨sigmoidæ›´åˆé€‚ã€‚ å¯¹äºå¤šåˆ†ç±»äº’æ–¥é—®é¢˜ï¼ˆå•æ ‡ç­¾åˆ†ç±»ï¼‰ï¼Œä½¿ç”¨softmaxæ›´åˆé€‚ã€‚\næ± åŒ–å±‚ï¼ˆå¯¹ç‰¹å¾å›¾è¿›è¡Œç¨€ç–å¤„ç†ï¼‰ é™ä½ä¿¡æ¯å†—ä½™ï¼Œæå‡æ¨¡å‹çš„å°ºåº¦ä¸å˜æ€§ã€æ—‹è½¬ä¸å˜æ€§ã€é˜²æ­¢è¿‡æ‹Ÿåˆã€‚\nMaxPoolingï¼ˆæœ€å¤§å€¼æ± åŒ–ï¼‰\nå…¨è¿æ¥å±‚ï¼ˆç‰¹å¾ç©ºé—´\u0026ndash;\u0026gt;æ ·æœ¬æ ‡è®°ç©ºé—´) å·ç§¯å±‚æå–äº†å„ç§ç‰¹å¾ï¼Œä½†å¾ˆå¤šç‰©ä½“å¯èƒ½æ‹¥æœ‰åŒä¸€ç±»ç‰¹å¾ï¼Œå…¨è¿æ¥å±‚ç›¸å½“äºç»„åˆäº†è¿™äº›ç‰¹å¾èµ·åˆ°äº†åˆ†ç±»å™¨çš„åŠŸèƒ½ã€‚\næŸå¤±å‡½æ•° æŸå¤±å‡½æ•°æ˜¯ç”¨æ¥è¡¡é‡æ¨¡å‹é¢„æµ‹å€¼$f(x)$ä¸çœŸå®å€¼$Y$çš„å·®å¼‚ç¨‹åº¦çš„è¿ç®—å‡½æ•°ï¼Œä»–æ˜¯ä¸€ä¸ªéè´Ÿå®æ•°å€¼å‡½æ•°ï¼Œé€šå¸¸è¡¨ç¤ºä¸º$L(Y|f(x))$ã€‚\næŸå¤±å‡½æ•°ä½¿ç”¨ä¸»è¦æ˜¯åœ¨æ¨¡å‹çš„è®­ç»ƒé˜¶æ®µï¼Œæ¯æ‰¹è®­ç»ƒæ•°æ®é€å…¥æ¨¡å‹åï¼Œé€šè¿‡å‰å‘ä¼ æ’­è¾“å‡ºé¢„æµ‹å€¼ï¼Œç„¶åæŸå¤±å‡½æ•°ä¼šè®¡ç®—å‡ºé¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„å·®å¼‚å€¼ï¼Œä¹Ÿå°±æ˜¯æŸå¤±å€¼ã€‚å¾—åˆ°æŸå¤±å€¼ä¹‹åï¼Œæ¨¡å‹é€šè¿‡åå‘ä¼ æ’­å»æ›´æ–°å„ä¸ªå‚æ•°ï¼Œæ¥é™ä½çœŸå®å€¼ä¸é¢„æµ‹å€¼ä¹‹é—´çš„æŸå¤±ï¼Œä½¿æ¨¡å‹è¶Šæ¥è¶Šå‡†ç¡®ã€‚\n\u0026ldquo;åå‘ä¼ æ’­è¿‡ç¨‹\u0026rdquo; $$ \\omega_{11} = \\omega_{11} - \\eta \\frac{\\partial \\delta}{\\partial \\omega_{11}} $$ é€šè¿‡é“¾å¼æ±‚å¯¼æ³•åˆ™å’Œæ¢¯åº¦ä¸‹é™ï¼Œé€æ­¥ä¿®æ”¹æƒé‡å‚æ•°$\\omega$ã€‚å…¶ä¸­ $\\eta$ ä¸ºå­¦ä¹ ç‡ï¼Œ$\\delta$ä¸ºæŸå¤±å€¼ã€‚\nåŸºäºè·ç¦»åº¦é‡çš„æŸå¤±å‡½æ•°ï¼š\nå‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°ï¼ˆMSEï¼‰ $$ L(Y|f(x)) = \\frac{1}{n} \\sum_{i=1}^N(Y_i - f(x_i))^2 $$\nL2æŸå¤±å‡½æ•°(æ¬§æ°è·ç¦») $$ L(Y|f(x)) = \\sqrt{\\frac{1}{n} \\sum_{i=1}^N (Y_i - f(x_i))^2} $$\nL2æŸå¤±å‡½æ•°(æ›¼å“ˆé¡¿è·ç¦») $$ L(Y|f(x)) = \\sum_{i=1}^N |Y_i - f(x_i)| $$\nSmooth L1æŸå¤±å‡½æ•°(ä¸»è¦ç”¨åœ¨ç›®æ ‡æ£€æµ‹ä¸­é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸) $$ L(Y|f(x)) = \\begin{cases} \\frac{1}{2}(Y-f(x))^2 \\qquad \\quad |Y-f(x)| \u0026lt; 1 \\\\\\ |Y-f(x)|- \\frac{1}{2} \\qquad |Y-f(x)| \\ge 1 \\end{cases} $$\nhuberæŸå¤±å‡½æ•°(å¹³æ–¹æŸå¤±+ç»å¯¹æŸå¤±) $$ L(Y|f(x)) = \\begin{cases} \\frac{1}{2}(Y-f(x))^2 \\qquad \\qquad |Y-f(x)| \\le \\delta \\\\\\ \\delta |Y-f(x)|- \\frac{1}{2} \\delta^2 \\qquad |Y-f(x)| \u0026gt; \\delta \\end{cases} $$\nåŸºäºæ¦‚ç‡åˆ†å¸ƒåº¦é‡çš„æŸå¤±å‡½æ•°ï¼š(æ¶‰åŠæ¦‚ç‡åˆ†å¸ƒæˆ–é¢„æµ‹ç±»åˆ«å‡ºç°çš„æ¦‚ç‡çš„é—®é¢˜ä¸­åº”ç”¨å¹¿æ³›)\nKLæ•£åº¦å‡½æ•°(ç›¸å¯¹ç†µ) $$ L(Y|f(x)) = \\sum_{i=1}^n Y_i \\times log(\\frac{Y_i}{f(x_i)}) $$\näº¤å‰ç†µæŸå¤± $$ L(Y|f(x)) = - \\sum_{i=1}^n Y_i \\times logf(x_i) $$ äº¤å‰ç†µæŸå¤±å‡½æ•°åˆ»ç”»äº†å®é™…è¾“å‡ºæ¦‚ç‡ä¸æœŸæœ›è¾“å‡ºæ¦‚ç‡ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œäº¤å‰ç†µçš„å€¼è¶Šå°ï¼Œä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒå°±è¶Šæ¥è¿‘ï¼Œç‰¹åˆ«æ˜¯åœ¨æ­£è´Ÿæ ·æœ¬ä¸å‡è¡¡çš„åˆ†ç±»é—®é¢˜ä¸­ï¼Œå¸¸ç”¨äº¤å‰ç†µä½œä¸ºæŸå¤±å‡½æ•°ã€‚\nç›®å‰ï¼Œäº¤å‰ç†µæŸå¤±å‡½æ•°æ˜¯å·ç§¯ç¥ç»ç½‘ç»œä¸­æœ€å¸¸ä½¿ç”¨çš„åˆ†ç±»æŸå¤±å‡½æ•°ï¼Œå®ƒå¯ä»¥æœ‰æ•ˆé¿å…æ¢¯åº¦æ¶ˆæ•£ã€‚åœ¨äºŒåˆ†ç±»æƒ…å†µä¸‹ä¹Ÿå«åšå¯¹æ•°æŸå¤±å‡½æ•°ã€‚\nsoftmaxæŸå¤±å‡½æ•° $$ L(Y|f(x)) = -\\frac{1}{n} \\sum_{i=1}^n Y_i \\times log \\frac{e^{f_{Y_i}}}{\\sum_{j=1}^c e^{f_j}} $$\nFocal loss $$ FE = \\begin{cases} -\\alpha(1-p)^\\gamma log(p) \\qquad \\quad y = 1 \\\\\\ -(1 - \\alpha)p^\\gamma log(1-p) \\quad y = 0 \\end{cases} $$\nä¼˜åŒ–å™¨ ä¼˜åŒ–å™¨å°±æ˜¯åœ¨æ·±åº¦å­¦ä¹ åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼ŒæŒ‡å¼•æŸå¤±å‡½æ•°ï¼ˆç›®æ ‡å‡½æ•°ï¼‰çš„å„ä¸ªå‚æ•°å¾€æ­£ç¡®çš„æ–¹å‘æ›´æ–°åˆé€‚çš„å¤§å°ï¼Œä½¿å¾—æ›´æ–°åçš„å„ä¸ªå‚æ•°è®©æŸå¤±å‡½æ•°ï¼ˆç›®æ ‡å‡½æ•°ï¼‰å€¼ä¸æ–­é€¼è¿‘å…¨å±€æœ€å°ã€‚\nSGDä¼˜åŒ–å™¨ï¼ˆéšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼Œæ˜“å—å™ªå£°å½±å“ï¼Œå¯èƒ½é™·å…¥å±€éƒ¨æœ€ä¼˜è§£ï¼‰ $$ \\omega_{t+1} = \\omega_t - \\alpha \\cdot g(\\omega_t) $$\nâ€‹\t$\\alpha$ä¸ºå­¦ä¹ ç‡ï¼Œ$g(\\omega_t)$ ä¸º$t$ æ—¶åˆ»å¯¹å‚æ•°$\\omega_t$ çš„æŸå¤±æ¢¯åº¦ã€‚\nâ€‹\tä¼˜ç‚¹ï¼š\næ¯æ¬¡åªç”¨ä¸€ä¸ªæ ·æœ¬æ›´æ–°å‚æ•°ï¼Œè®­ç»ƒé€Ÿåº¦å¿«\néšæœºæ¢¯åº¦ä¸‹é™æ‰€å¸¦æ¥çš„æ³¢åŠ¨æœ‰åˆ©äºä¼˜åŒ–çš„æ–¹å‘ä»å½“å‰çš„å±€éƒ¨æå°å€¼ç‚¹è·³åˆ°å¦ä¸€ä¸ªæ›´å¥½çš„å±€éƒ¨æå°å€¼ç‚¹ï¼Œè¿™æ ·å¯¹äºéå‡¸å‡½æ•°ï¼Œæœ€ç»ˆæ”¶æ•›äºä¸€ä¸ªè¾ƒå¥½çš„å±€éƒ¨æå€¼ç‚¹ï¼Œç”šè‡³å…¨å±€æå€¼ç‚¹ã€‚\nâ€‹\tç¼ºç‚¹ï¼š\nå½“é‡åˆ°å±€éƒ¨æœ€ä¼˜ç‚¹æˆ–éç‚¹æ—¶ï¼Œæ¢¯åº¦ä¸º0ï¼Œæ— æ³•ç»§ç»­æ›´æ–°å‚æ•° æ²¿é™¡å³­æ–¹å‘éœ‡è¡ï¼Œè€Œæ²¿å¹³ç¼“ç»´åº¦è¿›å±•ç¼“æ…¢ï¼Œéš¾ä»¥è¿…é€Ÿæ”¶æ•› SGD+Momentumä¼˜åŒ–å™¨ï¼ˆå¼•å…¥åŠ¨é‡ï¼ŒæŠ‘åˆ¶æ ·æœ¬å™ªå£°çš„å¹²æ‰°ï¼‰ $$ v_t = \\eta \\cdot v_{t-1} + \\alpha \\cdot g(\\omega_t) \\\\\\ \\omega_{t+1} = \\omega_t - v_t $$\nâ€‹\t$\\alpha$ä¸ºå­¦ä¹ ç‡ï¼Œ$g(\\omega_t)$ ä¸º$t$ æ—¶åˆ»å¯¹å‚æ•°$\\omega_t$ çš„æŸå¤±æ¢¯åº¦ï¼Œ$\\eta(0.9)$ ä¸ºåŠ¨é‡ç³»æ•°ã€‚\nåŠ å…¥äº†åŠ¨é‡å› ç´ ï¼Œç¼“è§£äº†SGDåœ¨å±€éƒ¨æœ€ä¼˜ç‚¹æ— æ³•æŒç»­æ›´æ–°çš„é—®é¢˜å’Œéœ‡è¡å¹…åº¦è¿‡å¤§çš„é—®é¢˜ï¼Œä½†å¹¶æ²¡æœ‰å®Œå…¨è§£å†³ï¼Œå½“å±€éƒ¨æ²Ÿå£‘æ¯”è¾ƒæ·±ï¼ŒåŠ¨é‡åŠ æŒç”¨å®Œäº†ï¼Œä¾ç„¶ä¼šå›°åœ¨å±€éƒ¨æœ€ä¼˜é‡Œæ¥å›æŒ¯è¡ã€‚ Adagradä¼˜åŒ–å™¨ï¼ˆè‡ªé€‚åº”å­¦ä¹ ç‡ï¼ŒäºŒé˜¶åŠ¨é‡ï¼‰ $$ s_t = s_{t-1} + g(\\omega_t) \\cdot g(\\omega_t) \\\\\\ \\omega_{t+1} = \\omega_t - \\frac{\\alpha} {\\sqrt{s_t + \\varepsilon}} \\cdot g(\\omega_t) $$\nâ€‹\t$\\alpha$ä¸ºå­¦ä¹ ç‡ï¼Œ$g(\\omega_t)$ ä¸º$t$ æ—¶åˆ»å¯¹å‚æ•°$\\omega_t$ çš„æŸå¤±æ¢¯åº¦ï¼Œ$\\varepsilon(10^{-7})$ ä¸ºé˜²æ­¢åˆ†æ¯ä¸ºé›¶çš„å°æ•°ã€‚å­¦ä¹ ç‡ä¸‹é™è¿‡å¿«å®¹æ˜“æœªæ”¶æ•›å°±åœæ­¢è®­ç»ƒ\nRMSPropä¼˜åŒ–å™¨ï¼ˆè‡ªé€‚åº”å­¦ä¹ ç‡ï¼‰ $$ s_t = \\eta \\cdot s_{t-1} + (1-\\eta) \\cdot g(\\omega_t) \\cdot g(\\omega_t) \\\\\\ \\omega_{t+1} = \\omega_t - \\frac{\\alpha} {\\sqrt{s_t + \\varepsilon}} \\cdot g(\\omega_t) $$\nâ€‹\t$\\alpha$ä¸ºå­¦ä¹ ç‡ï¼Œ$g(\\omega_t)$ ä¸º$t$ æ—¶åˆ»å¯¹å‚æ•°$\\omega_t$ çš„æŸå¤±æ¢¯åº¦ï¼Œ$\\eta(0.9)$ æ§åˆ¶è¡°å‡é€Ÿåº¦ï¼Œ$\\varepsilon(10^{-7})$ ä¸ºé˜²æ­¢åˆ†æ¯ä¸ºé›¶çš„å°æ•°ã€‚\nAdamä¼˜åŒ–å™¨ï¼ˆè‡ªé€‚åº”å­¦ä¹ ç‡ï¼‰ $$ m_t = \\beta_1 \\cdot m_{t-1} + (1 - \\beta_1) \\cdot g(\\omega_t) \\qquadä¸€é˜¶åŠ¨é‡ \\\\\\ v_t = \\beta_2 \\cdot v_{t-1} + (1 - \\beta_2) \\cdot g(\\omega_t) \\cdot g(\\omega_t) \\quadäºŒé˜¶åŠ¨é‡ \\\\\\ \\hat{m_t} = \\frac{m_t}{1 - \\beta^t_1} \\quad \\hat{\\frac{v_t} {1 - \\beta^t_2}} \\\\\\ \\omega_{t + 1} = \\omega_t - \\frac{\\alpha} {\\sqrt{\\hat{v_t} + \\varepsilon}} \\hat{m_t} $$\nâ€‹\t$\\alpha$ä¸ºå­¦ä¹ ç‡ï¼Œ$g(\\omega_t)$ ä¸º$t$ æ—¶åˆ»å¯¹å‚æ•°$\\omega_t$ çš„æŸå¤±æ¢¯åº¦ï¼Œ$\\beta_1(0.9)$ã€$\\beta_2(0.999)$ æ§åˆ¶è¡°å‡é€Ÿåº¦ï¼Œ$\\varepsilon(10^{-7})$ ä¸ºé˜²æ­¢åˆ†æ¯ä¸ºé›¶çš„å°æ•°ã€‚\né€šè¿‡ä¸€é˜¶åŠ¨é‡å’ŒäºŒé˜¶åŠ¨é‡ï¼Œæœ‰æ•ˆæ§åˆ¶å­¦ä¹ ç‡å’Œæ¢¯åº¦æ–¹å‘ï¼Œé˜²æ­¢æ¢¯åº¦çš„æŒ¯è¡å’Œåœ¨éç‚¹çš„é™æ­¢ã€‚ å¯èƒ½é”™è¿‡å…¨å±€æœ€ä¼˜è§£ã€‚è‡ªé€‚åº”å­¦ä¹ ç‡ç®—æ³•å¯èƒ½ä¼šå¯¹å‰æœŸå‡ºç°çš„ç‰¹å¾è¿‡æ‹Ÿåˆï¼ŒåæœŸæ‰å‡ºç°çš„ç‰¹å¾å¾ˆéš¾çº æ­£å‰æœŸçš„æ‹Ÿåˆæ•ˆæœã€‚åæœŸAdamçš„å­¦ä¹ ç‡å¤ªä½ï¼Œå½±å“äº†æœ‰æ•ˆçš„æ”¶æ•›ã€‚ è¯„ä¼°æŒ‡æ ‡\u0026ndash;F1åˆ†æ•° äºŒåˆ†ç±»ï¼š\né˜³æ€§æ ·æœ¬çš„çœŸå®æ•°é‡ï¼š$TP + FN$\né˜´æ€§æ ·æœ¬çš„çœŸå®æ•°é‡ï¼š$FP + TN$\n$Precision$ ï¼ˆç²¾ç¡®ç‡ï¼Œåˆç§°æŸ¥å‡†ç‡ï¼‰ï¼ˆå€¼è¶Šé«˜è¡¨ç¤ºè¯¯è¯Šæ•°è¶Šä½ï¼‰ï¼š $$ Precision = \\frac {TP} {TP + FP} $$ $Recall$ ï¼ˆå¬å›ç‡ï¼Œåˆç§°æŸ¥å…¨ç‡ï¼‰ï¼ˆå€¼è¶Šé«˜è¡¨ç¤ºæ¼æ‰çš„ç—…äººè¶Šå°‘ï¼‰ï¼š $$ Recall = \\frac {TP} {TP + FN} $$ $Accuracy$ ï¼ˆå‡†ç¡®ç‡ï¼‰ï¼ˆæ­£ç¡®çš„æ ·æœ¬å æ ·æœ¬æ€»æ•°çš„æ¯”ä¾‹ï¼‰ï¼š $$ Accuracy = \\frac {TP + TN} {TP + FN + FP + TN} $$ $F1åˆ†æ•°$ ï¼ˆç»¼åˆè€ƒè™‘äº†ç²¾ç¡®ç‡å’Œå¬å›ç‡ï¼Œè®¤ä¸ºä»–ä»¬åŒç­‰é‡è¦ï¼‰ï¼š $$ F1 = 2 \\times \\frac {Precision \\times Recall} {Precision + Recall} $$ å¤šåˆ†ç±»é—®é¢˜ï¼š\nå¾®è§‚ï¼š $$ (æŸ¥å‡†ç‡) \\quad microP = \\frac {TP_1 + TP_2} {TP_1 + FP_1 + TP_2 + FP_2} $$\n$$ (æŸ¥å…¨ç‡) \\quad microR = \\frac {TP_1 + TP_2} {TP_1 + FN_1 + TP_2 + FN_2} $$\n$$ microF1 = 2 \\times \\frac {microP \\times microR} {microP + microR} $$\nå®è§‚ï¼š $$ (æŸ¥å‡†ç‡) \\quad macroP = \\frac {Precision1 + Precision2} {2} $$\n$$ (æŸ¥å…¨ç‡) \\quad macroR = \\frac {Recall1 + Recall2} {2} $$\n$$ macroF1 = 2 \\times \\frac {macroP \\times macroR} {macroP + macroR} $$\n\u0026ldquo;è¯„ä¼°æŒ‡æ ‡çš„é€‰æ‹©\u0026rdquo;\nå½“ç±»åˆ«çš„åˆ†å¸ƒç›¸ä¼¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å‡†ç¡®ç‡ï¼Œå½“ç±»åˆ«çš„åˆ†å¸ƒä¸å¹³è¡¡æ—¶ï¼ŒF1åˆ†æ•°æ˜¯æ›´å¥½çš„è¯„ä¼°æŒ‡æ ‡ã€‚\nå›¾åƒå¤„ç†ä¸­çš„å·ç§¯ç¥ç»ç½‘ç»œ LeNetæ¨¡å‹ï¼ˆ1998ï¼‰ ç”±Yann Le Cunäº1998å¹´æå‡ºï¼Œå¥ å®šäº†å·ç§¯ç¥ç»ç½‘ç»œçš„åŸºç¡€ï¼Œç”±ä¸¤ä¸ªå·ç§¯å±‚ã€ä¸¤ä¸ªå…¨è¿æ¥å±‚å’Œä¸€ä¸ªè¾“å‡ºå±‚ç»„æˆã€‚æ¿€æ´»å‡½æ•°é‡‡ç”¨softmaxï¼Œæ± åŒ–å±‚é‡‡ç”¨å¹³å‡æ± åŒ–ã€‚è¯¥æ¨¡å‹æ—©æœŸä¸»è¦ç”¨äºæ‰‹å†™å­—ç¬¦çš„è¯†åˆ«å’Œåˆ†ç±»ã€‚\nALexNetæ¨¡å‹ï¼ˆ2012ï¼‰ é¦–æ¬¡åˆ©ç”¨GPUè¿›è¡Œç½‘ç»œåŠ é€Ÿè®­ç»ƒ ä½¿ç”¨äº†ReLuæ¿€æ´»å‡½æ•°ï¼Œä½¿ç”¨æœ€å¤§æ± åŒ–æ–¹æ³• ä½¿ç”¨äº†LRNå±€éƒ¨ç›¸åº”å½’ä¸€åŒ– åœ¨å…¨è¿æ¥å±‚çš„å‰ä¸¤å±‚ä½¿ç”¨äº†Dropoutéšæœºå¤±æ´»ç¥ç»å…ƒï¼Œå‡å°‘è¿‡æ‹Ÿåˆ è¿‡æ‹Ÿåˆæ ¹æœ¬åŸå› æ˜¯ç‰¹å¾ç»´åº¦è¿‡å¤šï¼Œæ¨¡å‹å‡è®¾è¿‡äºå¤æ‚ï¼Œå‚æ•°è¿‡å¤šè€Œè®­ç»ƒæ•°æ®è¿‡å°‘ï¼Œå™ªå£°å¤šï¼Œå¯¼è‡´æ‹Ÿåˆçš„å‡½æ•°å®Œç¾çš„é¢„æµ‹äº†è®­ç»ƒé›†è€Œå¯¹æµ‹è¯•é›†é¢„æµ‹ç»“æœå·®ã€‚\nå·ç§¯è®¡ç®—å…¬å¼ï¼š\n$$ N = \\frac {(W - F + 2P)} {S} + 1 $$\nAlexNet ç½‘ç»œçš„å…·ä½“å®ç°\nåŸå›¾è¾“å…¥224x224 å®é™…ä¸Šè¿›è¡Œäº†éšæœºè£å‰ªï¼Œå®é™…å¤§å°ä¸º227x227\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 from keras.layers import Input, Conv2D, MaxPooling2D, Flatten, Dense, deserialize from keras.models import Model def ALexNet(input_shape=None, num_classes=100): img_input = Input(shape=input_shape) # Block 1 # (227, 227, 3) --\u0026gt; (27, 27, 96) x = Conv2D(96, (11, 11), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;valid\u0026#39;, strides=(4, 4), name=\u0026#39;conv1\u0026#39;)(img_input) # (55, 55, 96) x = MaxPooling2D((3, 3), strides=(2, 2), name=\u0026#39;maxpool1\u0026#39;)(x) # Block 2 # (27, 27, 96) --\u0026gt; (13, 13, 256) x = Conv2D(256, (5, 5), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, strides=(1, 1), name=\u0026#39;conv2\u0026#39;)(x) # (27, 27, 256) x = MaxPooling2D((3, 3), strides=(2, 2), name=\u0026#39;maxpool2\u0026#39;)(x) # Block 3 # (13, 13, 256) --\u0026gt; (13, 13, 384) x = Conv2D(384, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, strides=(1, 1), name=\u0026#39;conv3\u0026#39;)(x) # Block 4 # (13, 13, 384) --\u0026gt; (13, 13, 384) x = Conv2D(384, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, strides=(1, 1), name=\u0026#39;conv4\u0026#39;)(x) # Block 5 # (13, 13, 384) --\u0026gt; (6, 6, 256) x = Conv2D(256, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, strides=(1, 1), name=\u0026#39;conv5\u0026#39;)(x) # (13, 13, 256) x = MaxPooling2D((3, 3), strides=(2, 2), name=\u0026#39;maxpool3\u0026#39;)(x) # Block 6 # (6, 6, 256) --\u0026gt; (1, 4096) x = Flatten(name=\u0026#39;flatten\u0026#39;)(x) x = Dense(num_classes, activation=\u0026#39;softmax\u0026#39;, name=\u0026#39;predictions\u0026#39;)(x) inputs = img_input model = Model(inputs, x, name=\u0026#39;alexnet\u0026#39;) return model if __name__ == \u0026#39;__main__\u0026#39;: model = ALexNet(input_shape=(227, 227, 3)) model.summary() GoogleNetæ¨¡å‹ï¼ˆ2014ï¼‰ é€šè¿‡å¼•å…¥Inceptionæ¨¡å—æ¥å¢åŠ ç½‘ç»œå®½åº¦ å¼•å…¥1x1çš„å·ç§¯å±‚æ¥å‹ç¼©é€šé“æ•°é‡ï¼Œé™ä½è®¡ç®—é‡ï¼Œä»è€Œè¿›ä¸€æ­¥å¢åŠ ç½‘ç»œæ·±åº¦ æ·»åŠ ä¸¤ä¸ªsoftmaxè¾…åŠ©åˆ†ç±»å™¨ï¼Œç¼“è§£æ¢¯åº¦æ¶ˆå¤±ç°è±¡ Inceptionå°±æ˜¯æŠŠå¤šä¸ªå·ç§¯æˆ–æ± åŒ–æ“ä½œæ”¾åœ¨ä¸€èµ·ç»„è£…æˆä¸€ä¸ªç½‘ç»œæ¨¡å—ã€‚\nVGGNetæ¨¡å‹ï¼ˆ2014ï¼‰ ä½¿ç”¨å¤šä¸ª3x3å°å°ºå¯¸å·ç§¯æ ¸å’Œæ± åŒ–å±‚æ„é€ æ·±åº¦å·ç§¯ åœ¨æœ€åä½¿ç”¨ä¸‰å±‚å…¨è¿æ¥å±‚ï¼Œç”¨æœ€åä¸€å±‚å…¨è¿æ¥å±‚çš„è¾“å‡ºä½œä¸ºåˆ†ç±»çš„é¢„æµ‹ æˆåŠŸè¯æ˜äº†å¢åŠ ç½‘ç»œçš„æ·±åº¦ï¼Œå¯ä»¥æ›´å¥½çš„å­¦ä¹ å›¾åƒä¸­çš„ç‰¹å¾æ¨¡å¼ VGG16 ç½‘ç»œçš„å…·ä½“ç»“æ„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 from keras.models import Model from keras.layers import Input,Activation,Dropout,Reshape,Conv2D,MaxPooling2D,Dense,Flatten def VGG16(input_shape=None, classes=1000): img_input = Input(shape=input_shape) # Block 1 # (224, 224, 3) --\u0026gt; (112, 112, 64) x = Conv2D(64, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block1_conv1\u0026#39;)(img_input) x = Conv2D(64, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block1_conv2\u0026#39;)(x) x = MaxPooling2D((2, 2), strides=(2, 2), name=\u0026#39;block1_pool\u0026#39;)(x) # Block 2 # (112, 112, 64) --\u0026gt; (56, 56, 128) x = Conv2D(128, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block2_conv1\u0026#39;)(x) x = Conv2D(128, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block2_conv2\u0026#39;)(x) x = MaxPooling2D((2, 2), strides=(2, 2), name=\u0026#39;block2_pool\u0026#39;)(x) # Block 3 # (56, 56, 128) --\u0026gt; (28, 28, 256) x = Conv2D(256, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block3_conv1\u0026#39;)(x) x = Conv2D(256, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block3_conv2\u0026#39;)(x) x = Conv2D(256, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block3_conv3\u0026#39;)(x) x = MaxPooling2D((2, 2), strides=(2, 2), name=\u0026#39;block3_pool\u0026#39;)(x) # Block 4 # (28, 28, 256) --\u0026gt; (14, 14, 512) x = Conv2D(512, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block4_conv1\u0026#39;)(x) x = Conv2D(512, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block4_conv2\u0026#39;)(x) x = Conv2D(512, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block4_conv3\u0026#39;)(x) x = MaxPooling2D((2, 2), strides=(2, 2), name=\u0026#39;block4_pool\u0026#39;)(x) # Block 5 # (14, 14, 512) --\u0026gt; (7, 7, 512) x = Conv2D(512, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block5_conv1\u0026#39;)(x) x = Conv2D(512, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block5_conv2\u0026#39;)(x) x = Conv2D(512, (3, 3), activation=\u0026#39;relu\u0026#39;, padding=\u0026#39;same\u0026#39;, name=\u0026#39;block5_conv3\u0026#39;)(x) x = MaxPooling2D((2, 2), strides=(2, 2), name=\u0026#39;block5_pool\u0026#39;)(x) # å¯¹ç»“æœè¿›è¡Œå¹³é“º x = Flatten(name=\u0026#39;flatten\u0026#39;)(x) # ä¸¤æ¬¡ç¥ç»å…ƒä¸º4096çš„å…¨è¿æ¥å±‚ x = Dense(4096, activation=\u0026#39;relu\u0026#39;, name=\u0026#39;fc1\u0026#39;)(x) x = Dense(4096, activation=\u0026#39;relu\u0026#39;, name=\u0026#39;fc2\u0026#39;)(x) # å†å…¨è¿æ¥åˆ°1000ç»´ï¼Œç”¨ä»¥åˆ†ç±»ä»»åŠ¡ x = Dense(classes, activation=\u0026#39;softmax\u0026#39;, name=\u0026#39;predictions\u0026#39;)(x) inputs = img_input model = Model(inputs, x, name=\u0026#39;vgg16\u0026#39;) return model if __name__ == \u0026#39;__main__\u0026#39;: model = VGG16(intput_shape=(224, 224, 3)) model.summary() SSDæ¨¡å‹ï¼ˆ2016ï¼‰ SSDæ˜¯åŸºäºä¸€ä¸ªå‰å‘ä¼ æ’­åé¦ˆçš„CNNç½‘ç»œï¼Œå±äºone-stageç±»å‹ã€‚\nå¯¹å¤šå°ºåº¦ç‰¹å¾å›¾è¿›è¡Œæ£€æµ‹ è®¾ç½®ä¸åŒé•¿å®½æ¯”çš„å…ˆéªŒæ¡† åŸºæœ¬çš„SSDæ¨¡å‹æ˜¯åœ¨VGGç½‘ç»œæ¨¡å‹çš„åŸºç¡€ä¸Šæ„å»ºçš„ï¼Œé€šè¿‡èåˆä¸åŒå·ç§¯å±‚çš„ç‰¹å¾å›¾æ¥å¢å¼ºç½‘ç»œå¯¹ç‰¹å¾çš„è¡¨è¾¾èƒ½åŠ›ï¼Œé‡‡ç”¨å¤šå°ºåº¦å·ç§¯æ£€æµ‹çš„æ–¹æ³•æ¥è¿›è¡Œç›®æ ‡æ£€æµ‹å…¶ç»“æ„å¦‚å›¾æ‰€ç¤ºï¼š\nè¯¥æ¨¡å‹åŸºäºVGGæ¨¡å‹(æ”¹è¿›ç‰ˆ)æ¥æå–ç‰¹å¾ï¼Œå°†å„çº§çš„å·ç§¯ç‰¹å¾å›¾ä½œä¸ºè¯¥ä¸€çº§çš„ç‰¹å¾è¡¨ç¤ºï¼Œä¸åŒå·ç§¯çº§åˆ«çš„å›¾åƒå·ç§¯ç‰¹å¾æè¿°äº†ä¸åŒçš„è¯­ä¹‰ï¼Œå·ç§¯å±‚è¶Šæ·±è¡¨è¾¾çš„å›¾åƒç‰¹å¾ä¿¡æ¯çº§åˆ«è¶Šé«˜ã€‚SSDæ¨¡å‹ä¸­ç‰¹å¾çš„æå–é‡‡ç”¨çš„æ˜¯é€å±‚æå–å¹¶æŠ½è±¡åŒ–çš„æ€æƒ³ï¼Œä½å±‚çš„ç‰¹å¾ä¸»è¦å¯¹åº”äºå æ¯”è¾ƒå°çš„ç›®æ ‡ï¼Œé«˜å±‚çš„ç‰¹å¾ä¸»è¦å¯¹åº”äºå æ¯”è¾ƒå¤§çš„ç›®æ ‡çš„æŠ½è±¡åŒ–çš„ä¿¡æ¯ã€‚ åŸºæœ¬çš„SSDæ¨¡å‹é€šè¿‡é‡‘å­—å¡”ç‰¹å¾å±‚è¿›è¡Œç‰¹å¾æå–ï¼Œä¸”å„ç‰¹å¾å±‚ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œæ²¡æœ‰ç›®æ ‡ä¿¡æ¯çš„ç›¸äº’è¡¥å……ï¼Œä½ç‰¹å¾å±‚ä»…æœ‰Conv4_3å±‚ç”¨äºæ£€æµ‹å æ¯”å°çš„ç›®æ ‡å› è€Œåœ¨ç¼ºä¹å……è¶³çš„ç‰¹å¾ä¿¡æ¯çš„æƒ…å†µä¸‹å­˜åœ¨ç‰¹å¾æå–ä¸å……åˆ†çš„é—®é¢˜ï¼Œå› è€Œå¯¼è‡´å¯¹å°å‹ç›®æ ‡çš„è¯†åˆ«æ•ˆæœä¸€èˆ¬ã€‚\nSSD ç½‘ç»œçš„å…·ä½“ç»“æ„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 import keras.backend as K import numpy as np from keras.engine.topology import InputSpec, Layer from keras.layers import (Activation, Concatenate, Conv2D, Flatten, Input, Reshape) from keras.models import Model from vgg import VGG16 class Normalize(Layer): def __init__(self, scale, **kwargs): self.axis = 3 self.scale = scale super(Normalize, self).__init__(**kwargs) def build(self, input_shape): self.input_spec = [InputSpec(shape=input_shape)] shape = (input_shape[self.axis],) init_gamma = self.scale * np.ones(shape) self.gamma = K.variable(init_gamma, name=\u0026#39;{}_gamma\u0026#39;.format(self.name)) self.trainable_weights = [self.gamma] def call(self, x, mask=None): output = K.l2_normalize(x, self.axis) output *= self.gamma return output def SSD300(input_shape, num_classes=21): # ------ è¾“å…¥å°ºå¯¸(300, 300, 3) ------ # input_tensor = Input(shape=input_shape) net = VGG16(input_tensor) # ------- å¯¹ä¸»å¹²ç½‘ç»œæå–åˆ°çš„æœ‰æ•ˆç‰¹å¾è¿›è¡Œå¤„ç† ------- # # å¯¹conv4_3çš„é€šé“è¿›è¡Œl2æ ‡å‡†åŒ–å¤„ç† # (38, 38, 512) net[\u0026#39;conv4_3_norm\u0026#39;] = Normalize(20, name=\u0026#39;conv4_3_norm\u0026#39;)(net[\u0026#39;conv4_3\u0026#39;]) num_anchors = 4 # å¯¹é¢„æµ‹æ¡†çš„å¤„ç† # num_anchorsè¡¨ç¤ºæ¯ä¸ªç½‘æ ¼ç‚¹å…ˆéªŒæ¡†çš„æ•°é‡ # 4 æ˜¯x,y(æ¡†ä¸­å¿ƒåç§»),h,w(æ¡†çš„é«˜å’Œå®½)çš„è°ƒæ•´ net[\u0026#39;conv4_3_norm_mbox_loc\u0026#39;] = Conv2D(num_anchors * 4, kernel_size=(3,3), padding=\u0026#39;same\u0026#39;, name=\u0026#39;conv4_3_norm_mbox_loc\u0026#39;)(net[\u0026#39;conv4_3_norm\u0026#39;]) net[\u0026#39;conv4_3_norm_mbox_loc_flat\u0026#39;] = Flatten(name=\u0026#39;conv4_3_norm_mbox_loc_flat\u0026#39;)(net[\u0026#39;conv4_3_norm_mbox_loc\u0026#39;]) # num_classesæ˜¯æ‰€åˆ†çš„ç±» net[\u0026#39;conv4_3_norm_mbox_conf\u0026#39;] = Conv2D(num_anchors * num_classes, kernel_size=(3,3), padding=\u0026#39;same\u0026#39;,name=\u0026#39;conv4_3_norm_mbox_conf\u0026#39;)(net[\u0026#39;conv4_3_norm\u0026#39;]) net[\u0026#39;conv4_3_norm_mbox_conf_flat\u0026#39;] = Flatten(name=\u0026#39;conv4_3_norm_mbox_conf_flat\u0026#39;)(net[\u0026#39;conv4_3_norm_mbox_conf\u0026#39;]) # å¯¹fc7å±‚è¿›è¡Œå¤„ç† # (19, 19, 1024) num_anchors = 6 # é¢„æµ‹æ¡†çš„å¤„ç† # 4 æ˜¯x,y,h,wçš„è°ƒæ•´ net[\u0026#39;fc7_mbox_loc\u0026#39;] = Conv2D(num_anchors * 4, kernel_size=(3,3),padding=\u0026#39;same\u0026#39;,name=\u0026#39;fc7_mbox_loc\u0026#39;)(net[\u0026#39;fc7\u0026#39;]) net[\u0026#39;fc7_mbox_loc_flat\u0026#39;] = Flatten(name=\u0026#39;fc7_mbox_loc_flat\u0026#39;)(net[\u0026#39;fc7_mbox_loc\u0026#39;]) # num_classesæ˜¯æ‰€åˆ†çš„ç±» net[\u0026#39;fc7_mbox_conf\u0026#39;] = Conv2D(num_anchors * num_classes, kernel_size=(3,3),padding=\u0026#39;same\u0026#39;,name=\u0026#39;fc7_mbox_conf\u0026#39;)(net[\u0026#39;fc7\u0026#39;]) net[\u0026#39;fc7_mbox_conf_flat\u0026#39;] = Flatten(name=\u0026#39;fc7_mbox_conf_flat\u0026#39;)(net[\u0026#39;fc7_mbox_conf\u0026#39;]) # å¯¹conv6_2è¿›è¡Œå¤„ç† # (10, 10, 512) num_anchors = 6 # é¢„æµ‹æ¡†çš„å¤„ç† # 4 æ˜¯x,y,h,wçš„è°ƒæ•´ net[\u0026#39;conv6_2_mbox_loc\u0026#39;] = Conv2D(num_anchors * 4, kernel_size=(3,3), padding=\u0026#39;same\u0026#39;,name=\u0026#39;conv6_2_mbox_loc\u0026#39;)(net[\u0026#39;conv6_2\u0026#39;]) net[\u0026#39;conv6_2_mbox_loc_flat\u0026#39;] = Flatten(name=\u0026#39;conv6_2_mbox_loc_flat\u0026#39;)(net[\u0026#39;conv6_2_mbox_loc\u0026#39;]) # num_classesæ˜¯æ‰€åˆ†çš„ç±» net[\u0026#39;conv6_2_mbox_conf\u0026#39;] = Conv2D(num_anchors * num_classes, kernel_size=(3,3), padding=\u0026#39;same\u0026#39;,name=\u0026#39;conv6_2_mbox_conf\u0026#39;)(net[\u0026#39;conv6_2\u0026#39;]) net[\u0026#39;conv6_2_mbox_conf_flat\u0026#39;] = Flatten(name=\u0026#39;conv6_2_mbox_conf_flat\u0026#39;)(net[\u0026#39;conv6_2_mbox_conf\u0026#39;]) # å¯¹conv7_2è¿›è¡Œå¤„ç† # (5, 5, 256) num_anchors = 6 # é¢„æµ‹æ¡†çš„å¤„ç† # 4 æ˜¯x,y,h,wçš„è°ƒæ•´ net[\u0026#39;conv7_2_mbox_loc\u0026#39;] = Conv2D(num_anchors * 4, kernel_size=(3,3), padding=\u0026#39;same\u0026#39;,name=\u0026#39;conv7_2_mbox_loc\u0026#39;)(net[\u0026#39;conv7_2\u0026#39;]) net[\u0026#39;conv7_2_mbox_loc_flat\u0026#39;] = Flatten(name=\u0026#39;conv7_2_mbox_loc_flat\u0026#39;)(net[\u0026#39;conv7_2_mbox_loc\u0026#39;]) # num_classesæ˜¯æ‰€åˆ†çš„ç±» net[\u0026#39;conv7_2_mbox_conf\u0026#39;] = Conv2D(num_anchors * num_classes, kernel_size=(3,3), padding=\u0026#39;same\u0026#39;,name=\u0026#39;conv7_2_mbox_conf\u0026#39;)(net[\u0026#39;conv7_2\u0026#39;]) net[\u0026#39;conv7_2_mbox_conf_flat\u0026#39;] = Flatten(name=\u0026#39;conv7_2_mbox_conf_flat\u0026#39;)(net[\u0026#39;conv7_2_mbox_conf\u0026#39;]) # å¯¹conv8_2è¿›è¡Œå¤„ç† # (3, 3, 256) num_anchors = 4 # é¢„æµ‹æ¡†çš„å¤„ç† # 4æ˜¯x,y,h,wçš„è°ƒæ•´ net[\u0026#39;conv8_2_mbox_loc\u0026#39;] = Conv2D(num_anchors * 4, kernel_size=(3,3), padding=\u0026#39;same\u0026#39;,name=\u0026#39;conv8_2_mbox_loc\u0026#39;)(net[\u0026#39;conv8_2\u0026#39;]) net[\u0026#39;conv8_2_mbox_loc_flat\u0026#39;] = Flatten(name=\u0026#39;conv8_2_mbox_loc_flat\u0026#39;)(net[\u0026#39;conv8_2_mbox_loc\u0026#39;]) # num_classesæ˜¯æ‰€åˆ†çš„ç±» net[\u0026#39;conv8_2_mbox_conf\u0026#39;] = Conv2D(num_anchors * num_classes, kernel_size=(3,3), padding=\u0026#39;same\u0026#39;,name=\u0026#39;conv8_2_mbox_conf\u0026#39;)(net[\u0026#39;conv8_2\u0026#39;]) net[\u0026#39;conv8_2_mbox_conf_flat\u0026#39;] = Flatten(name=\u0026#39;conv8_2_mbox_conf_flat\u0026#39;)(net[\u0026#39;conv8_2_mbox_conf\u0026#39;]) # å¯¹conv9_2è¿›è¡Œå¤„ç† # (1, 1, 256) num_anchors = 4 # é¢„æµ‹æ¡†çš„å¤„ç† # 4æ˜¯x,y,h,wçš„è°ƒæ•´ net[\u0026#39;conv9_2_mbox_loc\u0026#39;] = Conv2D(num_anchors * 4, kernel_size=(3,3), padding=\u0026#39;same\u0026#39;,name=\u0026#39;conv9_2_mbox_loc\u0026#39;)(net[\u0026#39;conv9_2\u0026#39;]) net[\u0026#39;conv9_2_mbox_loc_flat\u0026#39;] = Flatten(name=\u0026#39;conv9_2_mbox_loc_flat\u0026#39;)(net[\u0026#39;conv9_2_mbox_loc\u0026#39;]) # num_classesæ˜¯æ‰€åˆ†çš„ç±» net[\u0026#39;conv9_2_mbox_conf\u0026#39;] = Conv2D(num_anchors * num_classes, kernel_size=(3,3), padding=\u0026#39;same\u0026#39;,name=\u0026#39;conv9_2_mbox_conf\u0026#39;)(net[\u0026#39;conv9_2\u0026#39;]) net[\u0026#39;conv9_2_mbox_conf_flat\u0026#39;] = Flatten(name=\u0026#39;conv9_2_mbox_conf_flat\u0026#39;)(net[\u0026#39;conv9_2_mbox_conf\u0026#39;]) # ------- å°†æ‰€æœ‰ç»“æœè¿›è¡Œå †å  ------- # net[\u0026#39;mbox_loc\u0026#39;] = Concatenate(axis=1, name=\u0026#39;mbox_loc\u0026#39;)([net[\u0026#39;conv4_3_norm_mbox_loc_flat\u0026#39;], net[\u0026#39;fc7_mbox_loc_flat\u0026#39;], net[\u0026#39;conv6_2_mbox_loc_flat\u0026#39;], net[\u0026#39;conv7_2_mbox_loc_flat\u0026#39;], net[\u0026#39;conv8_2_mbox_loc_flat\u0026#39;], net[\u0026#39;conv9_2_mbox_loc_flat\u0026#39;]]) net[\u0026#39;mbox_conf\u0026#39;] = Concatenate(axis=1, name=\u0026#39;mbox_conf\u0026#39;)([net[\u0026#39;conv4_3_norm_mbox_conf_flat\u0026#39;], net[\u0026#39;fc7_mbox_conf_flat\u0026#39;], net[\u0026#39;conv6_2_mbox_conf_flat\u0026#39;], net[\u0026#39;conv7_2_mbox_conf_flat\u0026#39;], net[\u0026#39;conv8_2_mbox_conf_flat\u0026#39;], net[\u0026#39;conv9_2_mbox_conf_flat\u0026#39;]]) # (8732, 4) net[\u0026#39;mbox_loc\u0026#39;] = Reshape((-1, 4), name=\u0026#39;mbox_loc_final\u0026#39;)(net[\u0026#39;mbox_loc\u0026#39;]) # (8732, 21) net[\u0026#39;mbox_conf\u0026#39;] = Reshape((-1, num_classes), name=\u0026#39;mbox_conf_logits\u0026#39;)(net[\u0026#39;mbox_conf\u0026#39;]) net[\u0026#39;mbox_conf\u0026#39;] = Activation(\u0026#39;softmax\u0026#39;, name=\u0026#39;mbox_conf_final\u0026#39;)(net[\u0026#39;mbox_conf\u0026#39;]) # (8732, 25) net[\u0026#39;predictions\u0026#39;] = Concatenate(axis =-1, name=\u0026#39;predictions\u0026#39;)([net[\u0026#39;mbox_loc\u0026#39;], net[\u0026#39;mbox_conf\u0026#39;]]) model = Model(net[\u0026#39;input\u0026#39;], net[\u0026#39;predictions\u0026#39;]) return model æ€»ç»“è€Œè¨€ï¼ŒSSDæ˜¯æŠŠä¸€å¼ å›¾ç‰‡åˆ’åˆ†ä¸ºä¸åŒçš„ç½‘æ ¼ï¼Œå½“æŸä¸€ç‰©ä½“çš„ä¸­å¿ƒç‚¹è½åœ¨è¿™ä¸ªåŒºåŸŸï¼Œè¿™ä¸ªç‰©ä½“å°±ç”±è¿™ä¸ªç½‘æ ¼æ¥ç¡®å®šã€‚\nMobileNetï¼ˆ2017ï¼‰ MobileNetV1 Deptwise Convolution(æ·±åº¦å¯åˆ†ç¦»å·ç§¯)(å¤§å¤§å‡å°‘è¿ç®—é‡å’Œå‚æ•°æ•°é‡) æ ‡å‡†çš„å·ç§¯ç½‘ç»œç»“æ„ï¼š\næ·±åº¦å¯åˆ†ç¦»å·ç§¯ç½‘ç»œç»“æ„ï¼š\nå½“è¾“å…¥ç‰¹å¾å›¾çš„ shape æ˜¯$D_F \\times D_F \\times M$ï¼Œå…¶ä¸­ $M$ ä¸ºé€šé“æ•°ï¼Œè¾“å‡ºç‰¹å¾å›¾çš„ shape ä¸º$D_G \\times D_G \\times N$ï¼Œé€šé“æ•°ä¸º $N$ ï¼Œæ ‡å‡†å·ç§¯æ ¸çš„å°ºå¯¸ä¸º$D_k \\times D_k \\times M$æ—¶ï¼Œå·ç§¯æ ¸çš„å‚ä¸ä¸ªæ•°ä¸º $D_k \\cdot D_k \\cdot M \\cdot N$ ã€‚æ·±åº¦å¯åˆ†ç¦»å·ç§¯ä¸€å…±åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤çš„å·ç§¯ï¼Œå…¶ä¸­ Depthwise Convolution çš„å·ç§¯æ ¸ä¸º$D_k \\times D_k \\times 1$ï¼Œ Pointwise Convolution çš„å·ç§¯æ ¸ä¸º$1 \\times 1 \\times M$ã€‚é‚£ä¹ˆå¯ä»¥å¾—å‡ºå¦‚ä¸‹ç»“è®ºï¼š\næ ‡å‡†å·ç§¯çš„è¿ç®—é‡ï¼š $$ D_k \\cdot D_k \\cdot M \\cdot N \\cdot D_F \\cdot D_F = D_F \\cdot D_F \\cdot M \\cdot (D^2_K \\cdot N) $$ æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„è¿ç®—é‡ï¼š $$ D_k \\cdot D_k \\cdot M \\cdot D_F \\cdot D_F + M \\cdot N \\cdot D_F \\cdot D_F = D_F \\cdot D_F \\cdot M \\cdot (D^2_K + N) $$ è¿ç®—é‡å¯¹æ¯”ï¼š $$ \\frac {D_F \\cdot D_F \\cdot M \\cdot (D^2_K + N)} {D_F \\cdot D_F \\cdot M \\cdot (D^2_k \\cdot N)} = \\frac {1} {N} + \\frac {1} {D^2_K} $$\næ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„tensorflowä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 from keras import layers from keras import backend \u0026#34;\u0026#34;\u0026#34; DepthwiseConv2Dçš„åŸå‡½æ•°å®šä¹‰: tf.keras.layers.DepthwiseConv2D( kernel_size, strides=(1, 1), padding=\u0026#34;valid\u0026#34;, depth_multiplier=1, data_format=None, dilation_rate=(1, 1), # è†¨èƒ€ç‡ activation=None, use_bias=True, # æ˜¯å¦ä½¿ç”¨åç½®å‘é‡ depthwise_initializer=\u0026#34;glorot_uniform\u0026#34;, bias_initializer=\u0026#34;zeros\u0026#34;, # åç½®å‘é‡çš„åˆå§‹å€¼ depthwise_regularizer=None, bias_regularizer=None, activity_regularizer=None, depthwise_constraint=None, bias_constraint=None, **kwargs ) \u0026#34;\u0026#34;\u0026#34; def _depthwise_conv_block( inputs, pointwise_conv_filters, alpha, depth_multiplier=1, strides=(1, 1), block_id=1): \u0026#34;\u0026#34;\u0026#34;é€šé“çš„å¤„ç†channel\u0026#34;\u0026#34;\u0026#34; channel_axis = 1 if backend.image_data_format() == \u0026#34;channels_first\u0026#34; else -1 \u0026#34;\u0026#34;\u0026#34;alphaè¶…å‚æ•°\u0026#34;\u0026#34;\u0026#34; pointwise_conv_filters = int(pointwise_conv_filters * alpha) \u0026#34;\u0026#34;\u0026#34;æ­¥é•¿çš„å¤„ç†padding\u0026#34;\u0026#34;\u0026#34; if strides == (1, 1): x = inputs else: x = layers.ZeroPadding2D(((0, 1), (0, 1)), name=\u0026#34;conv_pad_%d\u0026#34; % block_id)(inputs) \u0026#34;\u0026#34;\u0026#34;é€é€šé“å·ç§¯\u0026#34;\u0026#34;\u0026#34; x = layers.DepthwiseConv2D( (3, 3), padding=\u0026#34;same\u0026#34; if strides == (1, 1) else \u0026#34;valid\u0026#34;, depth_multiplier=depth_multiplier, strides=strides, use_bias=False, name=\u0026#34;conv_dw_%d\u0026#34; % block_id )(x) x = layers.BatchNormalization(axis=channel_axis, name=\u0026#34;conv_dw_%d_bn\u0026#34; % block_id)(x) x = layers.ReLU(6.0, name=\u0026#34;conv_dw_%d_relu\u0026#34; % block_id)(x) \u0026#34;\u0026#34;\u0026#34;é€ç‚¹å·ç§¯\u0026#34;\u0026#34;\u0026#34; x = layers.Conv2D( pointwise_conv_filters, (1, 1), padding=\u0026#34;same\u0026#34;, use_bias=False, strides=(1, 1), name=\u0026#34;conv_pw_%d\u0026#34; % block_id )(x) \u0026#34;\u0026#34;\u0026#34;Batch Normalizationæ˜¯2015å¹´ä¸€ç¯‡è®ºæ–‡ä¸­æå‡ºçš„æ•°æ®å½’ä¸€åŒ–æ–¹æ³•ï¼Œå¾€å¾€ç”¨åœ¨æ·±åº¦ç¥ç»ç½‘ç»œä¸­æ¿€æ´»å±‚ä¹‹å‰ã€‚ å…¶ä½œç”¨å¯ä»¥åŠ å¿«æ¨¡å‹è®­ç»ƒæ—¶çš„æ”¶æ•›é€Ÿåº¦ï¼Œä½¿å¾—æ¨¡å‹è®­ç»ƒè¿‡ç¨‹æ›´åŠ ç¨³å®šï¼Œé¿å…æ¢¯åº¦çˆ†ç‚¸æˆ–è€…æ¢¯åº¦æ¶ˆå¤±ã€‚å¹¶ä¸”èµ·åˆ°ä¸€å®šçš„æ­£åˆ™åŒ–ä½œç”¨ï¼Œå‡ ä¹ä»£æ›¿äº†Dropoutã€‚\u0026#34;\u0026#34;\u0026#34; x = layers.BatchNormalization(axis=channel_axis, name=\u0026#34;conv_pw_%d_bn\u0026#34; % block_id)(x) return layers.ReLU(6.0, name=\u0026#34;conv_pw_%d_relu\u0026#34; % block_id)(x) \u0026ldquo;Conv2D å’Œ Depthwise_conv2Dçš„åŒºåˆ«\u0026rdquo;\nConv2dåœ¨æ¯ä¸ªé€šé“ä¸Šå·ç§¯ï¼Œç„¶åæ±‚å’Œï¼ŒDepthwise_conv2Då·ç§¯ï¼Œä¸æ±‚å’Œã€‚\nDepthwise_conv2Dçš„è¾“å‡ºç»´åº¦å’Œè¾“å…¥ç»´åº¦å§‹ç»ˆæ˜¯ä¸€è‡´çš„ã€‚\næ ‡å‡†å·ç§¯ æ·±åº¦å¯åˆ†ç¦»å·ç§¯ è¿ç®—ç‰¹ç‚¹ æ¯ä¸ªå·ç§¯æ ¸çš„é€šé“ä¸è¾“å…¥é€šé“ç›¸åŒï¼Œæ¯ä¸ªé€šé“å•ç‹¬åšå·ç§¯è¿ç®—ç„¶åç›¸åŠ  DWå·ç§¯ï¼šä¸€ä¸ªå·ç§¯æ ¸åªæœ‰ä¸€ä¸ªé€šé“ï¼Œå•ç‹¬è´Ÿè´£ä¸€ä¸ªé€šé“\nPWå·ç§¯ï¼šå°†ä¸Šä¸€æ­¥çš„ç‰¹å¾å›¾åœ¨é€šé“æ–¹å‘ä¸Šè¿›è¡Œæ‰©å±• è¶…å‚æ•° $\\alpha$ $\\rho$ $\\alpha$ å®½åº¦ç³»æ•°ï¼Œå¯¹ç½‘ç»œä¸­æ¯ä¸€å±‚å·ç§¯çš„é€šé“æ•°ä¹˜ä»¥ $\\alpha$ å–å€¼èŒƒå›´[0,1]ï¼Œæ¯”è¾ƒå…¸å‹çš„å€¼ä¸º1ã€0.75ã€0.5ã€0.35 $$ è®¡ç®—é‡: \\qquad D_k \\cdot D_k \\cdot \\alpha M \\cdot D_F \\cdot D_F + \\alpha M \\cdot \\alpha N \\cdot D_F \\cdot D_F $$\n$\\rho$ åˆ†è¾¨ç‡ç³»æ•°ï¼Œåªæ”¹å˜ç½‘ç»œçš„è®¡ç®—é‡è€Œä¸å½±å“ç½‘ç»œçš„å‚æ•°é‡ $$ è®¡ç®—é‡: \\qquad D_k \\cdot D_k \\cdot \\alpha M \\cdot \\rho D_F \\cdot \\rho D_F + \\alpha M \\cdot \\alpha N \\cdot \\rho D_F \\cdot \\rho D_F $$\nDepthWiseéƒ¨åˆ†çš„å·ç§¯æ ¸å®¹æ˜“åºŸæ‰ï¼Œå³å·ç§¯æ ¸å‚æ•°å¤§éƒ¨åˆ†ä¸ºé›¶ã€‚ï¼ˆå¾ˆé‡è¦çš„ä¸€ä¸ªåŸå› æ˜¯å› ä¸º ReLU æ¿€æ´»å‡½æ•°å¯¹0å€¼çš„æ¢¯åº¦æ˜¯0ï¼Œåç»­æ— è®ºæ€ä¹ˆè¿­ä»£è¿™ä¸ªèŠ‚ç‚¹éƒ½ä¸ä¼šæ¢å¤ï¼Œå³â€œåºŸæ‰äº†â€ï¼‰\n\u0026ldquo;ä½ çŸ¥é“å—ï¼Ÿ\u0026rdquo;\næ·±åº¦å¯åˆ†ç¦»å·ç§¯å°†ä¸€ä¸ªæ ‡å‡†å·ç§¯åˆ†å‰²æˆäº†ä¸¤ä¸ªå·ç§¯ï¼ˆé€æ·±åº¦ï¼Œé€ç‚¹ï¼‰ï¼Œå› æ­¤å‡å°äº†å‚æ•°é‡ï¼Œå¯¹åº”ä¹Ÿå‡å°äº†æ€»è®¡ç®—é‡ã€‚ æ·±åº¦å¯åˆ†ç¦»å·ç§¯æ€»è®¡ç®—é‡å˜å°äº†ï¼Œä½†æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å±‚æ•°å˜å¤šäº†ã€‚\nGPUæ˜¯å¹¶è¡Œå¤„ç†å¤§è§„æ¨¡æ•°æ®(çŸ©é˜µå†…ç§¯)è¿ç®—çš„å¹³å°ï¼Œè€ŒCPUåˆ™æ›´å€¾å‘äºå¯¹æ•°æ®ä¸²è¡Œè®¡ç®—ã€‚\nå› æ­¤å½±å“GPUæ€»è¿ç®—æ—¶é—´çš„ä¸»å¯¼å› ç´ ä¸€èˆ¬æ˜¯ç½‘ç»œçš„å±‚æ•°ã€‚\nè€Œå½±å“CPUæ€»è¿ç®—æ—¶é—´çš„ä¸»å¯¼å› ç´ æ˜¯æ€»è®¡ç®—é‡ã€‚\næ‰€ä»¥æ‰ä¼šå‡ºç°MobileNetåœ¨æŸäº›è®¡ç®—èƒ½åŠ›æœ‰é™çš„CPUå¹³å°ä¸Šé€Ÿåº¦ç«Ÿç„¶é«˜äºæŸäº›GPUå¹³å°ä¸Šçš„é€Ÿåº¦ã€‚\nMobileNetçš„tensorflowä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 from keras import backend from keras import layers from keras.models import Model from keras.applications import imagenet_utils from keras.applications.efficientnet import block def MobileNet(input_shape, alpha=1.0, depth_multiplier=1, dropout=None, classes=1000): img_input = layers.Input(shape=input_shape) # (224, 224, 3) x = _conv_block(img_input, 32, alpha, strides=(2, 2)) # (112, 112, 32) x = _depthwise_conv_block(x, 64, alpha, depth_multiplier, block_id=1) # (112, 112, 64) x = _depthwise_conv_block(x, 128, alpha, depth_multiplier, strides=(2, 2), block_id=2) # (56, 56, 64) x = _depthwise_conv_block(x, 128, alpha, depth_multiplier, block_id=3) # (56, 56 ,128) x = _depthwise_conv_block(x, 256, alpha, depth_multiplier, strides=(2, 2), block_id=4) # (28, 28, 256) x = _depthwise_conv_block(x, 256, alpha, depth_multiplier, block_id=5) # (28, 28, 256) x = _depthwise_conv_block(x, 512, alpha, depth_multiplier, strides=(2, 2), block_id=6) # (14, 14, 512) x = _depthwise_conv_block(x, 512, alpha, depth_multiplier, block_id=7) x = _depthwise_conv_block(x, 512, alpha, depth_multiplier, block_id=8) x = _depthwise_conv_block(x, 512, alpha, depth_multiplier, block_id=9) x = _depthwise_conv_block(x, 512, alpha, depth_multiplier, block_id=10) x = _depthwise_conv_block(x, 512, alpha, depth_multiplier, block_id=11) # (14, 14, 512) x = _depthwise_conv_block(x, 1024, alpha, depth_multiplier, strides=(2, 2), block_id=12) # (7, 7, 1024) x = _depthwise_conv_block(x, 1024, alpha, depth_multiplier, block_id=13) # (7, 7, 1024) x = layers.GlobalAveragePooling2D(keepdims=True)(x) x = layers.Dropout(dropout, name=\u0026#34;drpout\u0026#34;)(x) x = layers.Conv2D(classes, (1, 1), padding=\u0026#34;same\u0026#34;, name=\u0026#34;conv_preds\u0026#34;)(x) x = layers.Reshape((classes,), name=\u0026#34;reshape_2\u0026#34;)(x) x = layers.Activation(activation=\u0026#34;softmax\u0026#34;, name=\u0026#34;predictions\u0026#34;)(x) model = Model(img_input, x, name=\u0026#34;mobilenet\u0026#34;) return model def _conv_block(inputs, filters, alpha, kernel=(3, 3), strides=(1, 1)): filters = int(filters * alpha) x = layers.Conv2D( filters, kernel, padding=\u0026#34;same\u0026#34;, use_bias=False, strides=strides, name=\u0026#34;conv1\u0026#34; )(inputs) x = layers.BatchNormalization(name=\u0026#34;conv1_bn\u0026#34;)(x) return layers.ReLU(6.0, name=\u0026#34;conv1_relu\u0026#34;)(x) def _depthwise_conv_block( inputs, pointwise_conv_filters, alpha, depth_multiplier=1, strides=(1, 1), block_id=1): \u0026#34;\u0026#34;\u0026#34;é€šé“çš„å¤„ç†channel\u0026#34;\u0026#34;\u0026#34; channel_axis = 1 if backend.image_data_format() == \u0026#34;channels_first\u0026#34; else -1 \u0026#34;\u0026#34;\u0026#34;alphaè¶…å‚æ•°\u0026#34;\u0026#34;\u0026#34; pointwise_conv_filters = int(pointwise_conv_filters * alpha) \u0026#34;\u0026#34;\u0026#34;æ­¥é•¿çš„å¤„ç†padding\u0026#34;\u0026#34;\u0026#34; if strides == (1, 1): x = inputs else: x = layers.ZeroPadding2D(((0, 1), (0, 1)), name=\u0026#34;conv_pad_%d\u0026#34; % block_id)(inputs) \u0026#34;\u0026#34;\u0026#34;é€é€šé“å·ç§¯ï¼ˆå¤„ç†é•¿å®½æ–¹å‘çš„ä¿¡æ¯ï¼‰\u0026#34;\u0026#34;\u0026#34; x = layers.DepthwiseConv2D( (3, 3), padding=\u0026#34;same\u0026#34; if strides == (1, 1) else \u0026#34;valid\u0026#34;, depth_multiplier=depth_multiplier, strides=strides, use_bias=False, name=\u0026#34;conv_dw_%d\u0026#34; % block_id )(x) x = layers.BatchNormalization(axis=channel_axis, name=\u0026#34;conv_dw_%d_bn\u0026#34; % block_id)(x) x = layers.ReLU(6.0, name=\u0026#34;conv_dw_%d_relu\u0026#34; % block_id)(x) \u0026#34;\u0026#34;\u0026#34;é€ç‚¹å·ç§¯ï¼ˆå¤„ç†è·¨é€šé“æ–¹å‘çš„ä¿¡æ¯ï¼‰\u0026#34;\u0026#34;\u0026#34; x = layers.Conv2D( pointwise_conv_filters, (1, 1), padding=\u0026#34;same\u0026#34;, use_bias=False, strides=(1, 1), name=\u0026#34;conv_pw_%d\u0026#34; % block_id )(x) x = layers.BatchNormalization(axis=channel_axis, name=\u0026#34;conv_pw_%d_bn\u0026#34; % block_id)(x) return layers.ReLU(6.0, name=\u0026#34;conv_pw_%d_relu\u0026#34; % block_id)(x) if __name__ == \u0026#39;__main__\u0026#39;: model = MobileNet(input_shape=(224, 224, 3)) model.summary() MobileNet v2 Inverted Residuals(å€’æ®‹å·®ç»“æ„)\nå€’æ®‹å·®ç»“æ„æ˜¯ä»ResNetä¸­çš„æ®‹å·®ç»“æ„è€Œæ¥çš„ã€‚ResNetä¸­Residualsç»“æ„ä¸­ï¼Œå…ˆç”¨1x1çš„å·ç§¯å®ç°äº†é™ç»´ï¼Œç„¶åé€šè¿‡3x3å·ç§¯ï¼Œæœ€åé€šè¿‡1x1å·ç§¯å®ç°å‡ç»´ï¼Œå³ä¸¤å¤´å¤§ä¸­é—´å°ã€‚\nè€Œåœ¨MobileNetV2ä¸­ï¼Œå…ˆç”¨1x1çš„å·ç§¯å‡ç»´ï¼Œç„¶åå°†3x3å·ç§¯æ¢ä¸º3x3DWå·ç§¯ï¼Œå†ç”¨1x1çš„å·ç§¯å®ç°é™ç»´ï¼Œå³ä¸¤å¤´å°ä¸­é—´å¤§ã€‚\nMobileNetV2çš„å€’æ®‹å·®ç»“æ„ç¤ºæ„å›¾ï¼š\nstateDiagram\rDirection LR\r[*] --\u003e Conv1x1,ReLU6 :å‡ç»´\rConv1x1,ReLU6 --\u003e Dwise3x3,ReLU6\rDwise3x3,ReLU6 --\u003e conv1x1,Linear conv1x1,Linear --\u003e Add :é™ç»´ï¼Œçº¿æ€§æ¿€æ´»\r[*] --\u003e Add :æ®‹å·®è¿æ¥\rAdd --\u003e [*]\rReLU6æ¿€æ´»å‡½æ•°: $$ y = ReLU6(x) = min(max(x, 0), 6) $$\nLinear Bottlenecks(çº¿æ€§ç“¶é¢ˆå±‚)\nä½œè€…å‘ç°å½“ä¿¡æ¯ä»é«˜ç»´ç©ºé—´ç»è¿‡éçº¿æ€§æ˜ å°„åˆ°ä½ç»´ç©ºé—´æ—¶ï¼Œä¼šå‘ç”Ÿä¿¡æ¯åå¡Œï¼Œæ‰€ä»¥åœ¨å€’æ®‹å·®ç»“æ„è¿›è¡Œé™ç»´æ“ä½œçš„æ—¶å€™ï¼Œä½¿ç”¨äº†çº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå®ç°æ–¹å¼å°±æ˜¯ä¸ä½¿ç”¨æ¿€æ´»å‡½æ•°ï¼‰ã€‚\n\u0026ldquo;æ€è€ƒ\u0026rdquo;\nä¹‹æ‰€ä»¥ä½¿ç”¨å€’æ®‹å·®ç»“æ„ï¼Œå’Œçº¿æ€§ç“¶é¢ˆå±‚ï¼Œæ˜¯å› ä¸ºä½œè€…é€šè¿‡æ•°å­¦è¯æ˜çš„æ–¹å¼ï¼Œå¾—å‡ºäº†åœ¨é™ç»´è¿‡åº¦æ—¶ï¼ŒReLUä¼šé€ æˆå¤§é‡çš„ä¿¡æ¯ä¸¢å¤±ï¼Œå³å‡ç»´ä¹‹åæ›´å®¹æ˜“ä¿æŒå¯é€†\nMobileNetV2çš„tensorflowå®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 from keras import backend from keras import layers from keras.models import Model from keras.applications import imagenet_utils def MobileNetV2(input_shape=None, alpha=1.0, classes=1000): img_input = layers.Input(shape=input_shape) channel_axis = 1 if backend.image_data_format() == \u0026#34;channels_first\u0026#34; else -1 first_block_filters = _make_divisible(32 * alpha, 8) # è¾“å…¥(224, 224, 3) x = layers.Conv2D( first_block_filters, kernel_size=3, strides=(2, 2), padding=\u0026#34;same\u0026#34;, use_bias=False, name=\u0026#34;Conv1\u0026#34;, )(img_input) x = layers.BatchNormalization( axis=channel_axis, epsilon=1e-3, momentum=0.999, name=\u0026#34;bn_Conv1\u0026#34; )(x) x = layers.ReLU(6.0, name=\u0026#34;Conv1_relu\u0026#34;)(x) # (112, 112, 32) x = _inverted_res_block(x, filters=16, alpha=alpha, stride=1, expansion=1, block_id=0) # (112, 112, 16) x = _inverted_res_block(x, filters=24, alpha=alpha, stride=2, expansion=6, block_id=1) x = _inverted_res_block(x, filters=24, alpha=alpha, stride=1, expansion=6, block_id=2) # (56, 56, 24) x = _inverted_res_block(x, filters=32, alpha=alpha, stride=2, expansion=6, block_id=3) x = _inverted_res_block(x, filters=32, alpha=alpha, stride=1, expansion=6, block_id=4) x = _inverted_res_block(x, filters=32, alpha=alpha, stride=1, expansion=6, block_id=5) # (28, 28, 32) x = _inverted_res_block(x, filters=64, alpha=alpha, stride=2, expansion=6, block_id=6) x = _inverted_res_block(x, filters=64, alpha=alpha, stride=1, expansion=6, block_id=7) x = _inverted_res_block(x, filters=64, alpha=alpha, stride=1, expansion=6, block_id=8) x = _inverted_res_block(x, filters=64, alpha=alpha, stride=1, expansion=6, block_id=9) # (14, 14, 64) x = _inverted_res_block(x, filters=96, alpha=alpha, stride=1, expansion=6, block_id=10) x = _inverted_res_block(x, filters=96, alpha=alpha, stride=1, expansion=6, block_id=11) x = _inverted_res_block(x, filters=96, alpha=alpha, stride=1, expansion=6, block_id=12) # (14, 14, 96) x = _inverted_res_block(x, filters=160, alpha=alpha, stride=2, expansion=6, block_id=13) x = _inverted_res_block(x, filters=160, alpha=alpha, stride=1, expansion=6, block_id=14) x = _inverted_res_block(x, filters=160, alpha=alpha, stride=1, expansion=6, block_id=15) # (7, 7, 160) x = _inverted_res_block(x, filters=320, alpha=alpha, stride=1, expansion=6, block_id=16) # å®½åº¦å› å­Î± if alpha \u0026gt; 1.0: last_block_filters = _make_divisible(1280 * alpha, 8) else: last_block_filters = 1280 # (7, 7, 320) x = layers.Conv2D( last_block_filters, kernel_size=1, use_bias=False, name=\u0026#34;Conv_1\u0026#34; )(x) x = layers.BatchNormalization( axis=channel_axis, epsilon=1e-3, momentum=0.999, name=\u0026#34;Conv_1_bn\u0026#34; )(x) x = layers.ReLU(6.0, name=\u0026#34;out_relu\u0026#34;)(x) # (7, 7, 1280) x = layers.GlobalAveragePooling2D()(x) imagenet_utils.validate_activation(\u0026#34;softmax\u0026#34;, \u0026#34;imagenet\u0026#34;) x = layers.Dense( classes, activation=\u0026#34;softmax\u0026#34;, name=\u0026#34;predictions\u0026#34; )(x) # é¢„æµ‹å±‚(1, 1, classes) # è¿”å›æ¨¡å‹å®ä¾‹ return Model(img_input, x, name=f\u0026#34;mobilenetv2\u0026#34;) def _inverted_res_block(inputs, expansion, stride, alpha, filters, block_id): \u0026#34;\u0026#34;\u0026#34;å€’æ®‹å·®ç»“æ„\u0026#34;\u0026#34;\u0026#34; channel_axis = 1 if backend.image_data_format() == \u0026#34;channels_first\u0026#34; else -1 in_channels = backend.int_shape(inputs)[channel_axis] # è¿”å›å¼ é‡æˆ–å˜é‡çš„shapeï¼Œä½œä¸ºintæˆ–è€…Noneæ¡ç›®çš„å…ƒç»„ pointwise_conv_filters = int(filters * alpha) # ç¡®ä¿æœ€åä¸€ä¸ª1x1å·ç§¯ä¸Šçš„æ»¤æ³¢å™¨ä¸ªæ•°å¯ä»¥è¢«8æ•´é™¤ pointwise_filters = _make_divisible(pointwise_conv_filters, 8) x = inputs prefix = f\u0026#34;block_{block_id}_\u0026#34; if block_id: # ç‚¹å·ç§¯å‡ç»´ x = layers.Conv2D( expansion * in_channels, kernel_size=1, padding=\u0026#34;same\u0026#34;, use_bias=False, activation=None, name=prefix + \u0026#34;expand\u0026#34;, )(x) x = layers.BatchNormalization( axis=channel_axis, epsilon=1e-3, momentum=0.999, name=prefix + \u0026#34;expand_BN\u0026#34;, )(x) x = layers.ReLU(6.0, name=prefix + \u0026#34;expand_relu\u0026#34;)(x) else: prefix = \u0026#34;expanded_conv_\u0026#34; # Dwå·ç§¯ if stride == 2: x = layers.ZeroPadding2D( padding=imagenet_utils.correct_pad(x, 3), name=prefix + \u0026#34;pad\u0026#34; )(x) x = layers.DepthwiseConv2D( kernel_size=3, strides=stride, activation=None, use_bias=False, padding=\u0026#34;same\u0026#34; if stride == 1 else \u0026#34;valid\u0026#34;, name=prefix + \u0026#34;depthwise\u0026#34;, )(x) x = layers.BatchNormalization( axis=channel_axis, epsilon=1e-3, momentum=0.999, name=prefix + \u0026#34;depthwise_BN\u0026#34;, )(x) x = layers.ReLU(6.0, name=prefix + \u0026#34;depthwise_relu\u0026#34;)(x) # ç‚¹å·ç§¯é™ç»´ï¼Œçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå³Noneï¼‰ x = layers.Conv2D( pointwise_filters, kernel_size=1, padding=\u0026#34;same\u0026#34;, use_bias=False, activation=None, name=prefix + \u0026#34;project\u0026#34;, )(x) x = layers.BatchNormalization( axis=channel_axis, epsilon=1e-3, momentum=0.999, name=prefix + \u0026#34;project_BN\u0026#34;, )(x) if in_channels == pointwise_filters and stride == 1: return layers.Add(name=prefix + \u0026#34;add\u0026#34;)([inputs, x]) return x def _make_divisible(v, divisor, min_value=None): if min_value is None: min_value = divisor new_v = max(min_value, int(v + divisor / 2) // divisor * divisor) # ç¡®ä¿å‘ä¸‹èˆå…¥ä¸ä¼šä¸‹é™è¶…è¿‡10% if new_v \u0026lt; 0.9 * v: new_v += divisor return new_v if __name__ == \u0026#39;__main__\u0026#39;: model = MobileNetV2(input_shape=(224, 224, 3)) model.summary() å¾…ç»­æœªå®Œã€‚ã€‚ã€‚\n","date":"2023-05-11T05:59:13+08:00","image":"https://haoleng-wick.github.io/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/cnn_total_hu14699074184501299526.jpg","permalink":"https://haoleng-wick.github.io/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/","title":"ç¥ç»ç½‘ç»œè§†è§‰åŸºç¡€"},{"content":"ä¼ ç»Ÿæœºå™¨è§†è§‰åŸºç¡€ ä¼ ç»Ÿè®¡ç®—æœºè§†è§‰ FASTç‰¹å¾ç‚¹æ£€æµ‹ç®—æ³• FASTåªæ˜¯ä¸€ç§ç‰¹å¾ç‚¹æ£€æµ‹ç®—æ³•ï¼Œå¹¶ä¸æ¶‰åŠç‰¹å¾ç‚¹çš„ç‰¹å¾æè¿°ã€‚\nFASTçš„æå‡ºè€…Rostenç­‰å°† FASTè§’ç‚¹ å®šä¹‰ä¸ºï¼šè‹¥æŸåƒç´ ä¸å…¶å‘¨å›´é‚»åŸŸå†…è¶³å¤Ÿå¤šçš„åƒç´ ç‚¹ç›¸å·®è¾ƒå¤§ï¼Œåˆ™è¯¥åƒç´ å¯èƒ½æ˜¯è§’ç‚¹ã€‚\nç®—æ³•æµç¨‹\nä»¥åƒç´ $p$ä¸ºä¸­å¿ƒï¼ŒåŠå¾„ä¸º3çš„åœ†ä¸Šï¼Œæœ‰16ä¸ªåƒç´ ç‚¹ å®šä¹‰ä¸€ä¸ªé˜ˆå€¼ï¼Œè®¡ç®—$p1$ã€$p5$ã€$p9$ã€$p13$ä¸ä¸­å¿ƒ$p$çš„åƒç´ å·®ï¼Œè‹¥å®ƒä»¬çš„ç»å¯¹å€¼è‡³å°‘æœ‰ä¸‰ä¸ªè¶…è¿‡é˜ˆå€¼ï¼Œåˆ™å½“ä½œå€™é€‰è§’ç‚¹ï¼Œå¦åˆ™ä¸å¯èƒ½æ˜¯è§’ç‚¹ è‹¥$p$æ˜¯å€™é€‰ç‚¹ï¼Œåˆ™è®¡ç®—$p1$åˆ°$p16$è¿™16ä¸ªç‚¹ä¸ä¸­å¿ƒ$p$ç‚¹çš„åƒç´ å·®ï¼Œè‹¥å®ƒä»¬è‡³å°‘æœ‰è¿ç»­9ä¸ªè¶…è¿‡é˜ˆå€¼ï¼Œåˆ™ä¸ºè§’ç‚¹ï¼Œå¦åˆ™ä¸å¯èƒ½æ˜¯è§’ç‚¹ å¯¹å›¾åƒè¿›è¡Œéæå¤§å€¼æŠ‘åˆ¶ï¼ˆnmsï¼‰ï¼šåˆ¤æ–­ä»¥ç‰¹å¾ç‚¹$p$ä¸ºä¸­å¿ƒçš„ä¸€ä¸ªé‚»åŸŸï¼ˆå¦‚3x3æˆ–5x5ï¼‰å†…ï¼Œè®¡ç®—è‹¥æœ‰å¤šä¸ªç‰¹å¾ç‚¹ï¼Œåˆ™åˆ¤æ–­æ¯ä¸ªç‰¹å¾ç‚¹çš„$s$å€¼ï¼ˆ16ä¸ªç‚¹ä¸ä¸­å¿ƒå·®å€¼çš„ç»å¯¹å€¼æ€»å’Œï¼‰ï¼Œè‹¥$p$æ˜¯é‚»åŸŸæ‰€æœ‰ç‰¹å¾ç‚¹ä¸­å“åº”å€¼æœ€å¤§çš„ï¼Œåˆ™ä¿ç•™ï¼›å¦åˆ™ï¼ŒæŠ‘åˆ¶ã€‚è‹¥é‚»åŸŸå†…åªæœ‰ä¸€ä¸ªç‰¹å¾ç‚¹ï¼ˆè§’ç‚¹ï¼‰ï¼Œåˆ™ä¿ç•™ã€‚å¾—åˆ†è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼ˆå…¬å¼ä¸­ç”¨$V$è¡¨ç¤ºå¾—åˆ†ï¼Œ$t$è¡¨ç¤ºé˜ˆå€¼ï¼‰ï¼š $$ V = max \\begin{cases} \\sum{pixel values - p}, \u0026amp; \\text{if (value - p) \u0026gt; t} \\\\\\ \\sum{p - pixel values}, \u0026amp; \\text{if (p- value) \u0026gt; t} \\end{cases} $$\nBRIEFç‰¹å¾ç‚¹æè¿°ç®—æ³• BRIEFæ˜¯å¯¹å·²æ£€æµ‹åˆ°çš„ç‰¹å¾ç‚¹è¿›è¡Œæè¿°ï¼Œå®ƒæ˜¯ä¸€ç§äºŒè¿›åˆ¶ç¼–ç çš„æè¿°å­ï¼Œæ‘ˆå¼ƒäº†åˆ©ç”¨åŒºåŸŸç°åº¦ç›´æ–¹å›¾æè¿°ç‰¹å¾ç‚¹çš„ä¼ ç»Ÿæ–¹æ³•ï¼Œå¤§å¤§çš„åŠ å¿«äº†ç‰¹å¾æè¿°ç¬¦å»ºç«‹çš„é€Ÿåº¦ï¼ŒåŒæ—¶ä¹Ÿæå¤§çš„é™ä½äº†ç‰¹å¾åŒ¹é…çš„æ—¶é—´ï¼Œæ˜¯ä¸€ç§éå¸¸å¿«é€Ÿï¼Œå¾ˆæœ‰æ½œåŠ›çš„ç®—æ³•ã€‚ ç”±äºBRIEFä»…ä»…æ˜¯ç‰¹å¾æè¿°å­ï¼Œæ‰€ä»¥äº‹å…ˆè¦å¾—åˆ°ç‰¹å¾ç‚¹çš„ä½ç½®\nç®—æ³•æµç¨‹\nä¸ºå‡å°‘å™ªå£°å¹²æ‰°ï¼Œéœ€å¯¹å›¾åƒå…ˆè¿›è¡Œæ»¤æ³¢ï¼ˆå¦‚é«˜æ–¯æ»¤æ³¢ï¼‰\nä»¥ç‰¹å¾ç‚¹ä¸ºä¸­å¿ƒï¼Œå–$S \\times S$çš„é‚»åŸŸçª—å£ã€‚åœ¨çª—å£å†…éšæœºé€‰å–ä¸€å¯¹ï¼ˆä¸¤ä¸ªï¼‰ç‚¹ï¼Œæ¯”è¾ƒäºŒè€…åƒç´ çš„å¤§å°ï¼Œè¿›è¡Œå¦‚ä¸‹äºŒè¿›åˆ¶èµ‹å€¼ã€‚ $$ \\iota(p;x,y):=\\begin{cases} 1,\u0026amp; \\text{$if p(x)\u0026lt;p(y)$ } \\\\\\ 0,\u0026amp; \\text{$otherwise$} \\end{cases} $$ å…¶ä¸­ï¼Œ$p(x)$ï¼Œ$p(y)$åˆ†åˆ«æ˜¯éšæœºç‚¹$x=(u1,v1)$, $y=(u2,v2)$çš„åƒç´ å€¼ã€‚\nåœ¨çª—å£ä¸­éšæœºé€‰å–$N$å¯¹éšæœºç‚¹ï¼Œé‡å¤æ­¥éª¤2çš„äºŒè¿›åˆ¶èµ‹å€¼ï¼Œå½¢æˆä¸€ä¸ªäºŒè¿›åˆ¶ç¼–ç ï¼Œè¿™ä¸ªç¼–ç å°±æ˜¯å¯¹ç‰¹å¾ç‚¹çš„æè¿°ï¼Œå³ç‰¹å¾æè¿°å­ã€‚ï¼ˆä¸€èˆ¬$N=256$ï¼‰\nåˆ©ç”¨BPIEFç‰¹å¾è¿›è¡Œé…å‡†\nç»è¿‡ç‰¹å¾ç‚¹æå–ï¼Œå¯¹äºä¸€å¹…å›¾ä¸­çš„æ¯ä¸€ä¸ªç‰¹å¾ç‚¹ï¼Œéƒ½å¾—åˆ°äº†ä¸€ä¸ª256bitçš„äºŒè¿›åˆ¶ç¼–ç ã€‚æ¥ä¸‹æ¥å¯¹æœ‰ç›¸ä¼¼æˆ–é‡å éƒ¨åˆ†çš„ä¸¤å¹…å›¾åƒè¿›è¡Œé…å‡†ã€‚\nç‰¹å¾é…å¯¹æ˜¯åˆ©ç”¨æ±‰æ˜è·ç¦»è¿›è¡Œåˆ¤å†³çš„ï¼š ä¸¤ä¸ªç‰¹å¾ç¼–ç å¯¹åº”bitä½ä¸Šç›¸åŒå…ƒç´ çš„ä¸ªæ•°å°äº128çš„ï¼Œä¸€å®šä¸æ˜¯é…å¯¹çš„ã€‚ ä¸€å¹…å›¾ä¸Šç‰¹å¾ç‚¹ä¸å¦ä¸€å¹…å›¾ä¸Šç‰¹å¾ç¼–ç å¯¹åº”bitä½ä¸Šç›¸åŒå…ƒç´ çš„ä¸ªæ•°æœ€å¤šçš„ç‰¹å¾ç‚¹é…æˆä¸€å¯¹ã€‚ ORBç®—æ³•ï¼ˆå¿«é€Ÿç‰¹å¾ç‚¹æå–å’Œæè¿°ç®—æ³•ï¼‰ ORBç®—æ³•åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ç‰¹å¾ç‚¹æå–å’Œç‰¹å¾ç‚¹æè¿°ã€‚ç‰¹å¾æå–æ˜¯ç”±FASTç®—æ³•ï¼ˆå‰é¢å·²ç»å­¦è¿‡ï¼‰å‘å±•æ¥çš„ï¼Œç‰¹å¾ç‚¹æè¿°æ˜¯æ ¹æ®BRIEFç‰¹å¾æè¿°ç®—æ³•æ”¹è¿›çš„ã€‚ ç®—æ³•æµç¨‹\nORBå¯¹FASTçš„æ”¹è¿›æˆ–è€…æ‹“å±•ï¼Œä¸»è¦æ˜¯ä¸ºå…¶å¢åŠ äº†å…¶å°ºåº¦ä¸å˜æ€§ä»¥åŠæ—‹è½¬ä¸å˜æ€§ã€‚æ¥ä¸‹é‡Œæ¥çœ‹ä¸€çœ‹æ€ä¹ˆå®ç°çš„ã€‚\nå…³é”®ç‚¹æå–\né€šè¿‡FASTç®—æ³•æå–ç‰¹å¾ç‚¹ å»ºç«‹é‡‘å­—å¡” è®¾ç½®ä¸€ä¸ªæ¯”ä¾‹å› å­$scale$ï¼ˆopencvé»˜è®¤å–1.2ï¼‰å’Œé‡‘å­—å¡”å±‚æ•°$n$ï¼ˆé€šå¸¸å–8ï¼‰ï¼Œå°†åŸå›¾åƒæŒ‰æ¯”ä¾‹å› å­ç¼©å°ä¸º$n$å¹…å›¾åƒï¼ˆ $I\u0026rsquo; = I/scale^k$ ï¼‰ $k=1ã€2ã€3 \\dots n$å¹…ä¸åŒæ¯”ä¾‹çš„å›¾åƒæå–ç‰¹å¾ç‚¹æ€»å’Œä½œä¸ºåŸå›¾çš„FASTç‰¹å¾ç‚¹ å®šä¹‰ç‰¹å¾ç‚¹æ–¹å‘ ORBçš„è®ºæ–‡ä¸­æå‡ºäº†ä¸€ç§åˆ©ç”¨ç°åº¦è´¨å¿ƒæ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé€šè¿‡è®¡ç®—ä¸€ä¸ªçŸ©æ¥è®¡ç®—ç‰¹å¾ç‚¹ä»¥$r$ä¸ºåŠå¾„èŒƒå›´å†…çš„è´¨å¿ƒï¼Œç‰¹å¾ç‚¹åæ ‡åˆ°è´¨å¿ƒå½¢æˆä¸€ä¸ªå‘é‡ä½œä¸ºè¯¥ç‰¹å¾ç‚¹çš„æ–¹å‘ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“æ€ä¹ˆå®ç°ç°åº¦è´¨å¿ƒæ³•ã€‚ ä¸€ä¸ªå›¾åƒå—ï¼ˆæ¯”å¦‚5x5çš„å›¾åƒå—ï¼‰ï¼Œå¯¹åº”2x2çš„çŸ©çš„å…ƒç´ è¡¨è¾¾ä¸ºï¼š\n$$ m_{pq} = \\sum_{x,y} \\ x^p y^q I(x,y) $$\n$x,y$ åˆ†åˆ«ä¸ºåæ ‡å€¼ï¼Œ$I(x,y)$ä¸ºåƒç´ å€¼è€Œè¯¥å›¾åƒçš„çª—å£è´¨å¿ƒä¸ºï¼š $$ C = (\\frac{m_{10}}{m_{00}},\\frac{m_{01}}{m_{00}}) $$\né‚£ä¹ˆç‰¹å¾ç‚¹ä¸è´¨å¿ƒçš„å¤¹è§’å®šä¹‰ä¸ºFASTç‰¹å¾ç‚¹çš„æ–¹å‘ï¼š\n$$ \\theta = arctan(m_{01},m_{10}) $$\næœ‰äº†ç‰¹å¾ç‚¹çš„æ–¹å‘ï¼Œç»§è€Œå®ç°æ—‹è½¬ä¸å˜æ€§ã€‚\nå…³é”®ç‚¹æè¿°\nORBé€‰æ‹©äº†BRIEFä½œä¸ºç‰¹å¾æè¿°æ–¹æ³•ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ”¹è¿›ä½¿å…¶åŠ ä¸Šæ—‹è½¬ä¸å˜æ€§å¹¶å¢åŠ å…¶å¯åŒºåˆ†æ€§ã€‚\nBRIEFæè¿°å­\nBRIEFç®—æ³•è®¡ç®—å‡ºæ¥çš„æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶ä¸²çš„ç‰¹å¾æè¿°ç¬¦ã€‚ å®ƒæ˜¯åœ¨æ¯ä¸€ä¸ªç‰¹å¾ç‚¹çš„é‚»åŸŸå†…ï¼Œé€‰æ‹©nå¯¹åƒç´ ç‚¹$8piã€qiï¼ˆi=1,2,â€¦,nï¼‰$ã€‚ç„¶åæ¯”è¾ƒæ¯ä¸ªç‚¹å¯¹çš„ç°åº¦å€¼çš„å¤§å°ã€‚å¦‚æœ$I(pi)\u0026gt; I(qi)$ï¼Œåˆ™ç”ŸæˆäºŒè¿›åˆ¶ä¸²ä¸­çš„1ï¼Œå¦åˆ™ä¸º0ã€‚æ‰€æœ‰çš„ç‚¹å¯¹éƒ½è¿›è¡Œæ¯”è¾ƒï¼Œåˆ™ç”Ÿæˆé•¿åº¦ä¸º$n$çš„äºŒè¿›åˆ¶ä¸²ã€‚ä¸€èˆ¬$n$å–128ã€256æˆ–512ï¼Œé€šå¸¸å–256ã€‚ ä¸ºäº†å¢å¼ºæŠ—å™ªæ€§ï¼Œä¸€èˆ¬ä¼šå…ˆå¯¹å›¾åƒè¿›è¡Œé«˜æ–¯å¹³æ»‘ã€‚ORBç®—å­é‡‡ç”¨5x5çš„å­çª—å£è¿›è¡Œå¹³æ»‘ã€‚\n$n$ä¸ªç‚¹å¯¹çš„é€‰å–æ–¹æ³•\nåœ¨ç‚¹å‘¨å›´é€‰å–ç‚¹å¯¹$ï¼ˆp,qï¼‰$çš„æ–¹æ³•\n$p$å’Œ$q$éƒ½ç¬¦åˆ$(0,S2/25)$çš„é«˜æ–¯åˆ†å¸ƒï¼›\n$p$ç¬¦åˆ$(0,S2/25)$çš„é«˜æ–¯åˆ†å¸ƒï¼Œè€Œ$q$ç¬¦åˆ$(0,S2/100)$çš„é«˜æ–¯åˆ†å¸ƒï¼› åœ¨ç©ºé—´é‡åŒ–æåæ ‡ä¸‹çš„ç¦»æ•£ä½ç½®éšæœºé‡‡æ ·ï¼›\næŠŠ$p$å›ºå®šä¸º$(0,0)$ï¼Œ$q$åœ¨å‘¨å›´å¹³å‡é‡‡æ ·ã€‚\nBRIEFç®—æ³•æ”¹è¿›\nå¢åŠ å…¶æ—‹è½¬ä¸å˜æ€§ï¼Œé€‰ç‚¹æ–¹å¼æ”¹è¿›\nsteered BRIEFå¢åŠ å…¶æ—‹è½¬ä¸å˜æ€§\næ‰€è°“steered BRIEFå°±æ˜¯å¯¹æŒ‘é€‰å‡ºçš„ç‚¹å¯¹åŠ ä¸Šä¸€ä¸ªæ—‹è½¬è§’åº¦$Î¸$ã€‚å¯¹äºä»»ä½•ä¸€ä¸ªç‰¹å¾ç‚¹æ¥è¯´ï¼Œå®ƒçš„BRIEFæè¿°å­æ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºğ‘›çš„äºŒå€¼ç ä¸²ï¼Œè¿™ä¸ªäºŒå€¼ç ä¸²æ˜¯ç”±ç‰¹å¾ç‚¹é‚»åŸŸğ‘›ä¸ªç‚¹å¯¹ç”Ÿæˆçš„ï¼Œæˆ‘ä»¬ç°åœ¨è®²è¿™2ğ‘›ä¸ªç‚¹(ğ‘¥ğ‘–,ğ‘¦ğ‘–),ğ‘–=1,2,\u0026hellip;..,2ğ‘›ç»„æˆä¸€ä¸ªçŸ©é˜µğ‘†: $$ S = \\left[ \\begin{matrix} x_1 \u0026amp; x_2 \u0026amp; \u0026hellip; \u0026amp; x_{2n}\\\\\\ y_1 \u0026amp; y_2 \u0026amp; \u0026hellip; \u0026amp; y_{2n} \\end{matrix} \\right] $$\nä½¿ç”¨é‚»åŸŸæ–¹å‘$\\theta$å’Œå¯¹åº”çš„æ—‹è½¬çŸ©é˜µ$R_\\theta$ï¼Œæ„å»º$S$çš„ä¸€ä¸ªæ ¡æ­£ç‰ˆæœ¬$S_\\theta$ï¼š $$ S_\\theta = R_\\theta S $$ å…¶ä¸­\n$$ R_\\theta = \\left[ \\begin{matrix} \\cos\\theta \u0026amp; sin\\theta \\\\\\ -sin\\theta \u0026amp; cos\\theta \\end{matrix} \\right] $$\nsteered BRIEFåŠ å…¥äº†æ—‹è½¬ä¸å˜æ€§ï¼Œä½†åŒæ—¶ç‰¹å¾æè¿°é‡çš„å¯åŒºåˆ†è¡Œå°±ä¸‹é™äº†,æ‰€ä»¥å°±æœ‰äº†ORBä½œè€…æå‡ºçš„rBRIEF\nrBRIEFå¢åŠ å…¶å¯åŒºåˆ†æ€§ ORBä½¿ç”¨ç»Ÿè®¡å­¦ä¹ çš„æ–¹æ³•æ¥é‡æ–°é€‰æ‹©ç‚¹å¯¹é›†åˆï¼Œç›®çš„æ˜¯å¢å¤§å…¶ç‰¹å¾æè¿°é‡çš„å¯åŒºåˆ†è¡Œã€‚\nOpenCVå¤§è‡´æ€è·¯ï¼š ä¸€ä¸ªå°±æ˜¯å°†æå–çš„è§’ç‚¹ä¿¡æ¯è¿›è¡Œæ ¼å¼åŒ–ï¼Œè¾“å‡ºä¸ºnumpyæ•°ç»„ï¼š 1 2 3 4 5 6 7 8 9 10 11 ## æå–å›¾åƒORBç‰¹å¾å¹¶è½¬åŒ–ä¸ºnumpyæ•°ç»„ def extraORBfromImg(ORB, img): keypoints, desc = ORB.detectAndCompute(img, mask=None) # å…³é”®ç‚¹æ£€æµ‹ ## ç‰¹å¾ç‚¹ä¿¡æ¯ axis = np.array([kp.pt for kp in keypoints]) # ç‰¹å¾ç‚¹å›¾åƒåæ ‡ scale = np.array([kp.octave+1 for kp in keypoints])# ç‰¹å¾ç‚¹å°ºåº¦(åœ¨å“ªä¸€å±‚é‡‘å­—å¡”) direct = np.array([kp.angle*np.pi/180 for kp in keypoints]) # ç‰¹å¾ç‚¹æ–¹å‘(å¼§åº¦) ## æ‹¼æ¥ infos = np.array([scale,direct]).T cors_info = np.hstack([axis,infos]) return cors_info, desc å¦ä¸€ä¸ªå°±æ˜¯è¿›è¡Œå›¾åƒé—´çš„è§’ç‚¹åŒ¹é…å‡½æ•°ï¼š 1 2 3 4 5 6 7 8 9 10 11 ## ORBç‰¹å¾BRIEFæè¿°å­åŒ¹é… def ORBMatch(BF, desc1, desc2): matches = BF.match(desc1, desc2) dist = np.array([mc.distance for mc in matches]) idx1 = np.array([mc.trainIdx for mc in matches]) idx0 = np.array([mc.queryIdx for mc in matches]) idx = np.array([idx0,idx1]).T ## åŒ¹é…ç‚¹ç­›é€‰ï¼Œå½“æè¿°å­ä¹‹é—´çš„è·ç¦»å¤§äºä¸¤å€çš„æœ€å°è·ç¦»æ—¶ï¼Œè®¤ä¸ºåŒ¹é…æœ‰è¯¯ min_dist = min(dist) filte_idx = np.where(dist \u0026lt;= max(2 * min_dist, 30))[0] return dist[filte_idx], idx[filte_idx,:] ç”±äºORBMatchå‡½æ•°è¿”å›çš„æ˜¯æ‰€æœ‰ç‚¹çš„åŒ¹é…è·ç¦»å’ŒåŒ¹é…ç´¢å¼•ï¼Œå› æ­¤å¿…è¦æ—¶æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå‡½æ•°è®¡ç®—åŒ¹é…ç‚¹å¯¹çš„åæ ‡ï¼š 1 2 3 4 5 ## è·å–å›¾åƒå¯¹åŒ¹é…ç‚¹çš„åæ ‡(ä¸€å¯¹) def findMatchCord(match_idx, cors1, cors2): left = cors1[match_idx[:,0], :2] right = cors2[match_idx[:,1], :2] return np.hstack([left, right]) ç»“æœç¤ºä¾‹ï¼š NMSç®—æ³•ï¼ˆéæå¤§å€¼æŠ‘åˆ¶ï¼‰ ç›®æ ‡æ£€æµ‹è¿‡ç¨‹ä¸­åœ¨åŒä¸€ç›®æ ‡çš„ä½ç½®ä¸Šä¼šäº§ç”Ÿå¤§é‡çš„å€™é€‰æ¡†ï¼Œè¿™äº›å€™é€‰æ¡†ç›¸äº’ä¹‹é—´å¯èƒ½ä¼šæœ‰é‡å ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦åˆ©ç”¨éæå¤§å€¼æŠ‘åˆ¶æ‰¾åˆ°æœ€ä½³çš„ç›®æ ‡è¾¹ç•Œæ¡†ï¼Œæ¶ˆé™¤å†—ä½™çš„è¾¹ç•Œæ¡†ã€‚ æµç¨‹ä¸€èˆ¬å¦‚ä¸‹ï¼š\nå‰æ ï¼šç›®æ ‡è¾¹ç•Œæ¡†åˆ—è¡¨åŠå…¶å¯¹åº”çš„ç½®ä¿¡åº¦å¾—åˆ†åˆ—è¡¨ï¼Œè®¾å®šé˜ˆå€¼ï¼Œé˜ˆå€¼ç”¨æ¥åˆ é™¤é‡å è¾ƒå¤§çš„è¾¹ç•Œæ¡†ã€‚\nIOU ï¼šintersection-over-unionï¼Œå³ä¸¤ä¸ªè¾¹ç•Œæ¡†çš„äº¤é›†éƒ¨åˆ†é™¤ä»¥å®ƒä»¬çš„å¹¶é›†ã€‚\næ ¹æ®ç½®ä¿¡åº¦å¾—åˆ†è¿›è¡Œæ’åº é€‰æ‹©ç½®ä¿¡åº¦æœ€é«˜çš„è¾¹ç•Œæ¡†æ·»åŠ åˆ°æœ€ç»ˆçš„ä¼ è¾“åˆ—è¡¨ä¸­ï¼Œå°†å…¶ä»è¾¹ç•Œæ¡†åˆ—è¡¨ä¸­åˆ é™¤ è®¡ç®—æ‰€æœ‰è¾¹ç•Œæ¡†çš„é¢ç§¯ è®¡ç®—ç½®ä¿¡åº¦æœ€é«˜çš„è¾¹ç•Œæ¡†ä¸å…¶ä»–å€™é€‰æ¡†çš„loU åˆ é™¤loUå¤§äºé˜ˆå€¼çš„è¾¹ç•Œæ¡† é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´è‡³è¾¹ç•Œæ¡†åˆ—è¡¨ä¸ºç©º RANSACç®—æ³•() éšæœºæŠ½æ ·ä¸€è‡´ç®—æ³• ï¼Œé‡‡ç”¨è¿­ä»£çš„æ–¹å¼ä»ä¸€ç»„åŒ…å«ç¦»ç¾¤çš„è¢«è§‚æµ‹æ•°æ®ä¸­ä¼°ç®—å‡ºæ•°å­¦æ¨¡å‹çš„å‚æ•°ï¼ŒRANSACç®—æ³•å‡è®¾æ•°æ®ä¸­åŒ…å«æ­£ç¡®æ•°æ®å’Œå¼‚å¸¸æ•°æ®ï¼ˆæˆ–è€…å™ªå£°ï¼‰ã€‚æ­£ç¡®æ•°æ®è®°ä¸ºå†…ç‚¹ï¼ˆinliersï¼‰ï¼Œå¼‚å¸¸æ•°æ®è®°ä¸ºå¤–ç‚¹ï¼ˆoutliersï¼‰ã€‚åŒæ—¶RANSACä¹Ÿå‡è®¾ï¼Œç»™å®šä¸€ç»„æ­£ç¡®çš„æ•°æ®ï¼Œå­˜åœ¨å¯ä»¥è®¡ç®—å‡ºç¬¦åˆè¿™äº›æ•°æ®çš„æ¨¡å‹å‚æ•°çš„æ–¹æ³•ã€‚è¯¥ç®—æ³•æ ¸å¿ƒæ€æƒ³å°±æ˜¯éšæœºæ€§å’Œå‡è®¾æ€§ï¼Œ éšæœºæ€§ æ˜¯æ ¹æ®æ­£ç¡®æ•°æ®å‡ºç°æ¦‚ç‡å»éšæœºé€‰å–æŠ½æ ·æ•°æ®ï¼Œæ ¹æ®å¤§æ•°å®šå¾‹ï¼Œéšæœºæ€§æ¨¡æ‹Ÿå¯ä»¥è¿‘ä¼¼å¾—åˆ°æ­£ç¡®ç»“æœã€‚ å‡è®¾æ€§ æ˜¯å‡è®¾é€‰å–å‡ºçš„æŠ½æ ·æ•°æ®éƒ½æ˜¯æ­£ç¡®æ•°æ®ï¼Œç„¶åç”¨è¿™äº›æ­£ç¡®æ•°æ®é€šè¿‡é—®é¢˜æ»¡è¶³çš„æ¨¡å‹ï¼Œå»è®¡ç®—å…¶ä»–ç‚¹ï¼Œç„¶åå¯¹è¿™æ¬¡ç»“æœè¿›è¡Œä¸€ä¸ªè¯„åˆ†ã€‚\nRANSACçš„åŸºæœ¬å°±å‡è®¾æ˜¯ï¼š\næ•°æ®ç”±â€œå±€å†…ç‚¹â€ç»„æˆï¼Œä¾‹å¦‚ï¼šæ•°æ®çš„åˆ†å¸ƒå¯ä»¥ç”¨ä¸€äº›æ¨¡å‹æ¥è§£é‡Š; â€œå±€å¤–ç‚¹â€æ˜¯ä¸èƒ½æ˜¯é€‚åº”æ¨¡å‹çš„æ•°æ®; é™¤æ­¤ä¹‹å¤–çš„æ•°æ®å±äºå™ªå£°ã€‚ RANSACä¹Ÿåšå‡ºäº†ä»¥ä¸‹å‡è®¾ï¼šç»™å®šä¸€ç»„ï¼ˆé€šå¸¸å¾ˆå°çš„ï¼‰å±€å†…ç‚¹ï¼Œå­˜åœ¨ä¸€ä¸ªå¯ä»¥ä¼°è®¡æ¨¡å‹å‚æ•°çš„è¿‡ç¨‹ï¼›è€Œè¯¥æ¨¡å‹èƒ½å¤Ÿè§£é‡Šæˆ–è€…é€‚ç”¨äºå±€å†…ç‚¹ã€‚\nç®—æ³•æµç¨‹ï¼š\né€‰æ‹©å‡ºå¯ä»¥ä¼°è®¡å‡ºæ¨¡å‹çš„æœ€å°æ•°æ®é›†ï¼›(å¯¹äºç›´çº¿æ‹Ÿåˆæ¥è¯´å°±æ˜¯ä¸¤ä¸ªç‚¹ï¼Œå¯¹äºè®¡ç®—HomographyçŸ©é˜µå°±æ˜¯4ä¸ªç‚¹) ä½¿ç”¨è¿™ä¸ªæ•°æ®é›†æ¥è®¡ç®—å‡ºæ•°æ®æ¨¡å‹ï¼› å°†æ‰€æœ‰æ•°æ®å¸¦å…¥è¿™ä¸ªæ¨¡å‹ï¼Œè®¡ç®—å‡ºâ€œå†…ç‚¹â€çš„æ•°ç›®ï¼›(ç´¯åŠ åœ¨ä¸€å®šè¯¯å·®èŒƒå›´å†…çš„é€‚åˆå½“å‰è¿­ä»£æ¨å‡ºæ¨¡å‹çš„æ•°æ®) æ¯”è¾ƒå½“å‰æ¨¡å‹å’Œä¹‹å‰æ¨å‡ºçš„æœ€å¥½çš„æ¨¡å‹çš„â€œå†…ç‚¹â€œçš„æ•°é‡ï¼Œè®°å½•æœ€å¤§â€œå†…ç‚¹â€æ•°çš„æ¨¡å‹å‚æ•°å’Œâ€œå†…ç‚¹â€æ•°ï¼› é‡å¤1-4æ­¥ï¼Œç›´åˆ°è¿­ä»£ç»“æŸæˆ–è€…å½“å‰æ¨¡å‹å·²ç»è¶³å¤Ÿå¥½äº†(â€œå†…ç‚¹æ•°ç›®å¤§äºä¸€å®šæ•°é‡â€)ã€‚ RANSACç®—æ³•çš„è¾“å…¥æ˜¯ä¸€ç»„è§‚æµ‹æ•°æ®ï¼Œä¸€ä¸ªå¯ä»¥è§£é‡Šæˆ–è€…é€‚åº”äºè§‚æµ‹æ•°æ®çš„å‚æ•°åŒ–æ¨¡å‹ï¼Œä¸€äº›å¯ä¿¡çš„å‚æ•°ã€‚\nè¾“å…¥ 1 2 3 4 5 6 data\t// ä¸€ç»„è§‚æµ‹æ•°æ® model\t// é€‚åº”äºæ•°æ®çš„æ¨¡å‹ n\t// é€‚åº”äºæ¨¡å‹çš„æœ€å°‘æ•°æ®ä¸ªæ•°ï¼Œå¦‚æœæ˜¯ç›´çº¿çš„è¯ï¼Œn=2 k\t// ç®—æ³•çš„è¿­ä»£æ¬¡æ•° t\t// ç”¨äºå†³å®šæ•°æ®æ˜¯å¦åº”ç”¨äºæ¨¡å‹çš„é˜ˆå€¼ d\t// åˆ¤å®šæ¨¡å‹æ˜¯å¦é€‚ç”¨äºæ•°æ®é›†çš„æ•°æ®ä¸ªæ•°ï¼Œäººä¸ºè®¾å®š è¾“å‡º 1 2 3 best_model\t// è·Ÿæ•°æ®æœ€åŒ¹é…çš„æ¨¡å‹å‚æ•°ï¼ˆå¦‚æœæ²¡æœ‰å¥½çš„æ¨¡å‹ï¼Œè¿”å›nullï¼‰ best_consensus_set\t// ä¼°è®¡å‡ºæ¨¡å‹çš„æ•°æ®ç‚¹ best_error\t// è·Ÿæ•°æ®ç›¸å…³çš„ä¼°è®¡å‡ºçš„æ¨¡å‹é”™è¯¯ Kmeansç®—æ³• èšç±»ä¸KMeans\nèšç±»æ˜¯åœ¨äº‹å…ˆå¹¶ä¸çŸ¥é“ä»»ä½•æ ·æœ¬æ ‡ç­¾çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡æ•°æ®ä¹‹é—´çš„å†…åœ¨å…³ç³»æŠŠæ ·æœ¬åˆ’åˆ†ä¸ºè‹¥å¹²ç±»åˆ«ï¼Œä½¿å¾—åŒç±»åˆ«æ ·æœ¬ä¹‹é—´çš„ç›¸ä¼¼åº¦é«˜ï¼Œä¸åŒç±»åˆ«ä¹‹é—´çš„æ ·æœ¬ç›¸ä¼¼åº¦ä½ï¼ˆå³å¢å¤§ç±»å†…èšï¼Œå‡å°‘ç±»é—´è·ï¼‰ã€‚\nKå‡å€¼èšç±»æ˜¯æœ€åŸºç¡€å¸¸ç”¨çš„èšç±»ç®—æ³•ã€‚å®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šé€šè¿‡è¿­ä»£å¯»æ‰¾Kä¸ªç°‡ï¼ˆClusterï¼‰çš„ä¸€ç§åˆ’åˆ†æ–¹æ¡ˆï¼Œä½¿å¾—èšç±»ç»“æœå¯¹åº”çš„æŸå¤±å‡½æ•°æœ€å°ã€‚å…¶ä¸­ï¼ŒæŸå¤±å‡½æ•°å¯ä»¥å®šä¹‰ä¸ºå„ä¸ªæ ·æœ¬è·ç¦»æ‰€å±ç°‡ä¸­å¿ƒç‚¹çš„è¯¯å·®å¹³æ–¹å’Œï¼š $$ J(c, \\mu) = \\sum _{i=1} ^{M} \\parallel x_i - \\mu _{c_i} \\parallel ^2 $$\nå…¶ä¸­ $x_i$ ä»£è¡¨ç¬¬ $i$ ä¸ªæ ·æœ¬ï¼Œ$c_i$ æ˜¯ $x_i$ æ‰€å±çš„ç°‡ï¼Œ$\\mu_{c_i}$ ä»£è¡¨ç°‡å¯¹åº”çš„ä¸­å¿ƒç‚¹ï¼Œ$M$æ˜¯æ ·æœ¬æ€»æ•°\nç®—æ³•æµç¨‹\nKMeansçš„æ ¸å¿ƒç›®æ ‡æ˜¯å°†ç»™å®šçš„æ•°æ®é›†åˆ’åˆ†æˆKä¸ªç°‡ï¼ˆKæ˜¯è¶…å‚ï¼‰ï¼Œå¹¶ç»™å‡ºæ¯ä¸ªæ ·æœ¬æ•°æ®å¯¹åº”çš„ä¸­å¿ƒç‚¹ã€‚å…·ä½“æ­¥éª¤éå¸¸ç®€å•ï¼Œå¯ä»¥åˆ†ä¸º4æ­¥ï¼š\næ•°æ®é¢„å¤„ç†ã€‚ä¸»è¦æ˜¯æ ‡å‡†åŒ–ã€å¼‚å¸¸ç‚¹è¿‡æ»¤ã€‚ éšæœºé€‰å–Kä¸ªä¸­å¿ƒï¼Œè®°ä¸º $\\mu_1^{(0)}$ , $\\mu_2^{(0)}$ ,â€¦â€¦, $\\mu_k^{(0)}$ å®šä¹‰æŸå¤±å‡½æ•°: $$ J(c, \\mu) = \\sum _{i=1} ^{M} \\parallel x_i -\\mu _{c_i} \\parallel ^2 $$\nä»¤ t = 0, 1, 2,â€¦â€¦ä¸ºè¿­ä»£æ­¥æ•°ï¼Œé‡å¤å¦‚ä¸‹è¿‡ç¨‹ç›´åˆ° $J$ æ”¶æ•›:\nå¯¹äºæ¯ä¸€ä¸ªæ ·æœ¬ $x_i$ ,å°†å…¶åˆ†é…åˆ°è·ç¦»æœ€è¿‘çš„ä¸­å¿ƒ $$ c_i^t \u0026lt; - argmin_k \\parallel x_i - \\mu_k^t \\parallel ^2 $$ å¯¹äºæ¯ä¸€ä¸ªç±»ä¸­å¿ƒkï¼Œé‡æ–°è®¡ç®—è¯¥ç±»çš„ä¸­å¿ƒ $$ \\mu_k^{t+1} \u0026lt; -argmin_{\\mu} \\sum _{i:c_i^t = k} ^b \\parallel x_i - \\mu \\parallel ^2 $$\nKMeansæœ€æ ¸å¿ƒçš„éƒ¨åˆ†å°±æ˜¯å…ˆå›ºå®šä¸­å¿ƒç‚¹ï¼Œè°ƒæ•´æ¯ä¸ªæ ·æœ¬æ‰€å±çš„ç±»åˆ«æ¥å‡å°‘ $J$ ï¼›å†å›ºå®šæ¯ä¸ªæ ·æœ¬çš„ç±»åˆ«ï¼Œè°ƒæ•´ä¸­å¿ƒç‚¹ç»§ç»­å‡å°$J$ ã€‚ä¸¤ä¸ªè¿‡ç¨‹äº¤æ›¿å¾ªç¯ï¼Œ $J$ å•è°ƒé€’å‡ç›´åˆ°æœ€ï¼ˆæï¼‰å°å€¼ï¼Œä¸­å¿ƒç‚¹å’Œæ ·æœ¬åˆ’åˆ†çš„ç±»åˆ«åŒæ—¶æ”¶æ•›ã€‚\nKMeans è¿­ä»£ç¤ºæ„å›¾ï¼š\nKMeansç®—æ³•æ­¥éª¤ï¼š\néšæœºåˆå§‹åŒ–kä¸ªç‚¹ä½œä¸ºç°‡è´¨å¿ƒï¼› å°†æ ·æœ¬é›†ä¸­çš„æ¯ä¸ªç‚¹åˆ†é…åˆ°ä¸€ä¸ªç°‡ä¸­ï¼›è®¡ç®—æ¯ä¸ªç‚¹ä¸è´¨å¿ƒä¹‹é—´çš„è·ç¦»ï¼ˆå¸¸ç”¨æ¬§å¼è·ç¦»å’Œä½™å¼¦è·ç¦»ï¼‰ï¼Œå¹¶å°†å…¶åˆ†é…ç»™è·ç¦»æœ€è¿‘çš„è´¨å¿ƒæ‰€å¯¹åº”çš„ç°‡ä¸­ï¼› æ›´æ–°ç°‡çš„è´¨å¿ƒã€‚æ¯ä¸ªç°‡çš„è´¨å¿ƒæ›´æ–°ä¸ºè¯¥ç°‡æ‰€æœ‰ç‚¹çš„å¹³å‡å€¼ï¼› åå¤è¿­ä»£2 - 3 æ­¥éª¤ï¼Œç›´åˆ°è¾¾åˆ°æŸä¸ªç»ˆæ­¢æ¡ä»¶ï¼›ï¼ˆa. è¾¾åˆ°æŒ‡å®šçš„è¿­ä»£æ¬¡æ•°ï¼›b. ç°‡å¿ƒä¸å†å‘ç”Ÿæ˜æ˜¾çš„å˜åŒ–ï¼Œå³æ”¶æ•›ï¼›c. æœ€å°è¯¯å·®å¹³æ–¹å’ŒSSEï¼›ï¼‰ SSE(Sum of Square Error, è¯¯å·®å¹³æ–¹å’Œ)ï¼ŒSSEå€¼è¶Šå°è¡¨ç¤ºæ•°æ®ç‚¹è¶Šæ¥è¿‘äºå®ƒä»¬çš„è´¨å¿ƒï¼Œèšç±»æ•ˆæœä¹Ÿè¶Šå¥½ã€‚\n$$ SSE = \\sum_{i = 1} ^ k \\sum_{x\\in C_i} (x-\\mu_i) ^2 $$\n$$ \\mu_i = \\frac{1}{|C_i|} \\sum_{x\\in{C_i}} x $$\nç®—æ³•è¿‡ç¨‹ï¼š\nç‚¹ $x = (x_1,x_2,â€¦â€¦,x_n)$ å’Œç‚¹ $y = (y_1,y_2,â€¦â€¦,y_n)$ ä¹‹é—´çš„æ¬§æ°è·ç¦»ä¸ºï¼š $$ d(x,y) = \\sqrt{(x_1-y_1)^2 + (x_2-y_2)^2 +â€¦â€¦+ (x_n-y_n)^2} $$\nä¸¤ä¸ªå‘é‡ A å’Œ Bï¼Œå…¶ä½™å¼¦è·ç¦»ï¼ˆå³ä¸¤å‘é‡å¤¹è§’çš„ä½™å¼¦ï¼‰ç”±ç‚¹ç§¯å’Œå‘é‡é•¿åº¦ç»™å‡ºï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š $$ cos\\theta = \\frac{A * B}{|A|*|B|} = \\frac{\\sum_{i=1}^n A_i B_i} {\\sqrt{\\sum_{i=1}^n (A_i)^2} \\sqrt{\\sum_{i=1}^n (B_i)^2}} $$\n$$ dist(A,B) = 1 - cos(A,B) = \\frac{|A| _2 |B|_2 - A * B}{|A| |B|} $$\nå¼å­ä¸­ï¼Œ $A_i$ å’Œ $B_i$ åˆ†åˆ«ä»£è¡¨å‘é‡Aå’ŒBçš„å„åˆ†é‡ã€‚\nç®—æ³•ä¼˜ç¼ºç‚¹\nä¼˜ç‚¹ï¼šå®¹æ˜“å®ç°\nç¼ºç‚¹ï¼šå¯èƒ½æ”¶æ•›åˆ°å±€éƒ¨æœ€å°å€¼ï¼Œåœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šæ”¶æ•›è¾ƒæ…¢\né€‚ç”¨æ•°æ®ç±»å‹ï¼šæ•°å€¼å‹æ•°æ®\n","date":"2023-05-06T03:20:13+08:00","image":"https://haoleng-wick.github.io/p/%E4%BC%A0%E7%BB%9F%E6%9C%BA%E5%99%A8%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/R-C_hu5961029251031618139.png","permalink":"https://haoleng-wick.github.io/p/%E4%BC%A0%E7%BB%9F%E6%9C%BA%E5%99%A8%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/","title":"ä¼ ç»Ÿæœºå™¨è§†è§‰åŸºç¡€"},{"content":"æ— äººæœºåŸºç¡€ å››æ—‹ç¿¼æ— äººæœºåŸºç¡€ keywords : æ„é€ å‡½æ•°ã€é‡è½½ã€å¯åŠ¨è„šæœ¬ã€uorbã€åˆ›å»ºçº¿ç¨‹ã€PIDã€PWMã€PX4ã€APMã€é²æ£’æ€§ã€\nå››æ—‹ç¿¼æ— äººæœºçš„åŠ¨åŠ›å­¦æ¨¡å‹ åŸºæœ¬å‡è®¾ï¼š\nå››æ—‹ç¿¼é£è¡Œå™¨æ˜¯å‡åŒ€å¯¹ç§°çš„åˆšä½“ å››æ—‹ç¿¼é£è¡Œå™¨çš„è´¨é‡å’Œè½¬åŠ¨æƒ¯é‡ä¸å‘ç”Ÿæ”¹å˜ å››æ—‹ç¿¼é£è¡Œå™¨çš„å‡ ä½•ä¸­å¿ƒä¸å…¶é‡å¿ƒé‡åˆ å››æ—‹ç¿¼é£è¡Œå™¨åªå—é‡åŠ›å’Œèºæ—‹æ¡¨æ‹‰åŠ› ç‰›é¡¿\u0026ndash;æ¬§æ‹‰æ–¹ç¨‹ : : åˆšä½“è¿åŠ¨ = è´¨å¿ƒçš„å¹³åŠ¨ + ç»•è´¨å¿ƒçš„è½¬åŠ¨\nè´¨å¿ƒçš„å¹³åŠ¨ : $F = m \\frac{dv}{dt}$\nç»•è´¨å¿ƒçš„è½¬åŠ¨ : $M = J \\dot\\omega + \\omega \\times J\\omega$\n\u0026ldquo;x\u0026quot;è¡¨ç¤ºçš„æ˜¯çŸ©é˜µä¹˜æ³•ï¼ˆå³ å‰ä¹˜ ï¼‰\nä½ç½®åŠ¨åŠ›å­¦æ¨¡å‹ (åˆå¤–åŠ›å’Œé€Ÿåº¦çš„æ–¹ç¨‹) æ—‹è½¬çŸ©é˜µ å¯ä»¥å°†æœºä½“åæ ‡ç³»( $O_bY_bZ_b$ )ä¸‹è¡¨ç¤ºçš„å‘é‡è½¬å˜åˆ°åœ°é¢åæ ‡ç³»( $O_eY_eZ_e$ )ä¸‹è¡¨ç¤º:\n$$ R^e_b = \\left[ \\begin{matrix} \\cos\\theta\\cos\\psi \u0026amp; \\cos\\psi\\sin\\theta\\sin\\phi - \\sin\\psi\\cos\\phi \u0026amp; \\cos\\psi\\sin\\theta\\cos\\phi + \\sin\\psi\\sin\\phi \\\\\\ \\cos\\theta\\sin\\psi \u0026amp; \\sin\\psi\\sin\\theta\\sin\\phi + \\cos\\psi\\cos\\phi \u0026amp; \\sin\\psi\\sin\\theta\\cos\\phi - \\cos\\psi\\sin\\phi \\\\\\ -\\sin\\theta \u0026amp; \\sin\\phi\\cos\\theta \u0026amp; \\cos\\phi\\cos\\theta \\end{matrix} \\right] $$\næ ¹æ®ç‰›é¡¿ç¬¬äºŒå®šå¾‹æ•´ç†å¾—ï¼š\n$$ \\dot v^e = g^e + R^e_b \\cdot \\frac{T^b}{m} $$\nå³ï¼š\n$$ \\begin{cases} \\dot v_x = -\\frac{f}{m}(\\cos\\psi\\sin\\theta\\cos\\phi + \\sin\\psi\\sin\\phi) \\\\\\ \\dot v_y = -\\frac{f}{m}(\\sin\\psi\\sin\\theta\\cos\\phi - \\cos\\psi\\sin\\theta) \\\\\\ \\dot v_z = g - \\frac{f}{m}\\cos\\phi\\cos\\theta \\end{cases} $$\nå§¿æ€åŠ¨åŠ›å­¦æ¨¡å‹ (åˆåŠ›çŸ©å’Œè§’é€Ÿåº¦çš„æ–¹ç¨‹)\nç”±æ¬§æ‹‰æ–¹ç¨‹çŸ¥ï¼š\n$$ J\\dot\\omega^b + \\omega^b \\times J\\omega^b = G^b_a + \\tau^b $$\n$$ \\omega^b = \\left[\\begin{matrix}\\omega_{xb} \u0026amp; \\omega_{yb} \u0026amp; \\omega_{zb}\\end{matrix} \\right]^T $$\nå¼ä¸­ï¼Œ $\\omega^b$ è¡¨ç¤ºåœ¨æœºä½“åæ ‡ç³»ä¸‹çš„è§’é€Ÿåº¦ï¼› $G_a$ è¡¨ç¤ºé™€èºåŠ›çŸ©ï¼› $\\tau$ è¡¨ç¤ºèºæ—‹æ¡¨åœ¨æœºä½“è½´ä¸Šäº§ç”Ÿçš„åŠ›çŸ©ï¼ŒåŒ…æ‹¬ç»• $O_bX_b$ è½´çš„æ»šè½¬åŠ›çŸ© $\\tau_x$ ã€ç»• $O_bY_b$ è½´çš„ä¿¯ä»°åŠ›çŸ© $\\tau_y$ ä»¥åŠç»• $O_bZ_b$ è½´çš„åèˆªåŠ›çŸ© $\\tau_z$ ã€‚\né™€èºåŠ›çŸ©Ga: å½“ç”µæœºé«˜é€Ÿæ—‹è½¬çš„æ—¶å€™ï¼Œç›¸å½“äºä¸€ä¸ªé™€èºã€‚é«˜é€Ÿæ—‹è½¬çš„é™€èºæ˜¯éå¸¸ç¨³å®šçš„ä¸ªä½“ï¼Œå…·æœ‰ä¿æŒè‡ªèº«è½´å‘ä¸å˜çš„èƒ½åŠ›ã€‚\n$$ G_a = \\left[ \\begin{matrix} G_{a,\\phi} \\\\\\ G_{a, \\theta} \\\\\\ G_{a,\\psi} \\end{matrix} \\right] = \\left[ \\begin{matrix} J_1q(\\overline\\omega_1 - \\overline\\omega_2 + \\overline\\omega_3 - \\overline\\omega_4) \\\\\\ J_1p(-\\overline\\omega_1 + \\overline\\omega_2 - \\overline\\omega_3 + \\overline\\omega_4) \\\\\\ 0 \\end{matrix} \\right] $$\nå¼ä¸­ï¼Œ $J_1$ è¡¨ç¤ºæ•´ä¸ªç”µæœºè½¬å­å’Œèºæ—‹æ¡¨ç»•æœºä½“è½¬è½´çš„æ€»è½¬åŠ¨æƒ¯é‡ï¼› $\\overline\\omega_i$ è¡¨ç¤ºèºæ—‹æ¡¨ 1,2,3,4 çš„è½¬é€Ÿã€‚\nç”±äºå‡è®¾å››æ—‹ç¿¼é£è¡Œå™¨æ˜¯å‡åŒ€å¯¹ç§°çš„åˆšä½“,æ‰€ä»¥ æƒ¯æ€§çŸ©é˜µJ å¯è¡¨ç¤ºä¸º:\n$$ J = \\left[ \\begin{matrix} I_{xx} \u0026amp; -I_{xy} \u0026amp; -I_{xz} \\\\\\ -I_{xy} \u0026amp; I_{yy} \u0026amp; -I_{yz} \\\\\\ -I_{xz} \u0026amp; -I_{yz} \u0026amp; I_{zz} \\end{matrix} \\right] = \\left[ \\begin{matrix} I_{xx} \u0026amp; \u0026amp; \\\\\\ \u0026amp; I_{yy} \u0026amp; \\\\\\ \u0026amp; \u0026amp; I_{zz} \\end{matrix} \\right] $$\næ‰€ä»¥ä¸Šå¼å¯åŒ–ä¸º:\n$$ \\begin{cases} \\dot p = \\dot\\omega_{xb} = \\frac{1}{I_{xx}}\\left[\\tau_x + qr(I_{yy} - I_{zz}) - J_{RP} q \\cdot \\Omega\\right]\t\\\\\\ \\dot q = \\dot\\omega_{yb} = \\frac{1}{I_{yy}}\\left[\\tau_y + pr(I_{zz} - I_{xx}) + J_{RP} p \\cdot\\Omega\\right]\t\\\\\\ \\dot r = \\dot\\omega_{zb} =\\frac{1}{I{zz}}\\left[\\tau_z + pq(I_{xx} - I_{yy})\\right] \\end{cases} $$\nå¼ä¸­ï¼Œ $\\Omega = -\\overline\\omega_1 + \\overline\\omega_2 - \\overline\\omega_3 + \\overline\\omega_4$\nå››æ—‹ç¿¼é£è¡Œå™¨çš„è¿åŠ¨å­¦æ¨¡å‹ è¾“å…¥ -\u0026gt;[é€Ÿåº¦å’Œè§’é€Ÿåº¦] è¾“å‡º -\u0026gt;[ä½ç½®å’Œå§¿æ€]\nä½ç½®ï¼š\n$$ \\dot p^e = v^e $$\nå§¿æ€ï¼š\n$$ \\left[ \\begin{matrix} \\dot\\phi \\\\\\ \\dot\\theta \\\\\\ \\dot\\psi \\end{matrix} \\right]\t= \\left[ \\begin{matrix} 1 \u0026amp; \\tan\\theta\\sin\\phi \u0026amp; \\tan\\theta\\cos\\phi \\\\\\ 0 \u0026amp; \\cos\\phi \u0026amp; -\\sin\\phi \\\\\\ 0 \u0026amp; \\frac{\\sin\\phi}{\\cos\\theta} \u0026amp; \\frac{\\cos\\phi}{\\cos\\theta} \\end{matrix} \\right] \\left[ \\begin{matrix} p \\\\\\ q \\\\\\ r \\end{matrix} \\right] $$\næ— äººæœºå§¿æ€ Pich,ä¿¯ä»°\nRollï¼Œæ¨ªæ»š\nYawï¼Œèˆªå‘ï¼ˆåèˆªï¼‰\nå…±è½´åŒæ¡¨æ—‹ç¿¼æ— äººæœºåŸºç¡€ å…±è½´åŒæ¡¨æ—‹ç¿¼æ— äººæœºçš„é£è¡ŒåŸç†ç±»ä¼¼äºå¸¸è§çš„ç›´å‡æœºã€‚ä½†æ˜¯å…±è½´åŒæ¡¨æ— äººæœºå–æ¶ˆäº†ç›´å‡æœºçš„å°¾æ¡¨ï¼Œè€Œä½¿ç”¨ä¸¤ä¸ªç›´å¾„ç›¸åŒå…±è½´å¸ƒå±€çš„èºæ—‹æ¡¨ï¼Œåˆ©ç”¨ä¸¤ä¸ªå…±è½´èºæ—‹æ¡¨åå‘æ—‹è½¬æ¥æŠµæ¶ˆæ‰­çŸ©ï¼Œå†é€šè¿‡å€¾æ–œç›˜ä½œä¸ºå˜è·æœºæ„ï¼Œä»è€Œæ§åˆ¶é£è¡Œå™¨çš„ä¿¯ä»°å’Œæ¨ªæ»šè‡ªç”±åº¦ã€‚\nè¯¥ç±»å‹é£è¡Œå™¨çš„ä¼˜ç‚¹ï¼š\næ²¡æœ‰å°¾æ¡¨çš„åŠŸç‡æŸè€—ï¼Œå…·æœ‰æ›´é«˜çš„æ‚¬åœæ•ˆç‡ï¼Œæ ¹æ®è«å¡å¤«è®¾è®¡å±€çš„ç ”ç©¶èµ„æ–™ï¼Œå…±è½´åŒæ—‹ç¿¼ç›´å‡æœºçš„æ‚¬åœæ•ˆç‡è¦æ¯”å•æ—‹ç¿¼å¸¦å°¾æ¡¨çš„ç›´å‡æœºé«˜å‡º17%~30%ã€‚ ç”±äºæ²¡æœ‰å°¾æ¡¨ï¼Œå¯ä»¥å°†æœºèº«åšçš„å¾ˆçŸ­ï¼Œå› æ­¤å…¶ç»“æ„é‡é‡å’Œè½½è·å‡é›†ä¸­åœ¨é‡å¿ƒå¤„ï¼Œä»è€Œå‡å°‘äº†ç›´å‡æœºä¿¯ä»°å’Œåèˆªçš„è½¬åŠ¨æƒ¯é‡ï¼Œè®¡æœ‰è¾ƒé«˜çš„åŠ é€Ÿç‰¹æ€§ã€‚ è¯¥ç±»é£è¡Œå™¨çš„ç¼ºç‚¹ï¼š\næœºæ¢°æœºæ„ç›¸å¯¹å¤æ‚ï¼Œåˆ¶é€ æˆæœ¬å’Œå¯ç»´æŠ¤æ€§ä¸Šä¸å¦‚å¤šæ—‹ç¿¼é£è¡Œå™¨ é£è¡Œæ¨¡æ€ç›¸å¯¹å¤šæ—‹ç¿¼å¤æ‚ä¸€äº›ï¼Œåœ¨é£æ§è®¾è®¡æ–¹é¢æœ‰ä¸€å®šçš„æŒ‘æˆ˜æ€§ å…±è½´åŒæ¡¨æ—‹ç¿¼æ— äººæœºåŸºæœ¬æ“çºµåŸç† å…±è½´æ—‹ç¿¼æ— äººæœºåœ¨ç©ºä¸­æœ‰6ä¸ªè‡ªç”±åº¦ï¼Œåˆ†åˆ«ä¸ºï¼š\næ²¿Xè½´çš„çºµå‘ç§»åŠ¨ã€ç»•Xè½´çš„æ¨ªæ»š æ²¿Yè½´çš„æ¨ªå‘ç§»åŠ¨ã€ç»•Zè½´çš„åèˆª æ²¿Zè½´çš„å‚ç›´ç§»åŠ¨ã€ç»•Yè½´çš„ä¿¯ä»° å…¶ä¸»è¦æ“çºµåŸç†å¦‚ä¸‹ï¼š\né€šè¿‡æ€»è·æ“çºµè°ƒèŠ‚ä¸Šä¸‹æ—‹ç¿¼çš„æ€»è·ï¼Œä»è€Œæ”¹å˜æ—‹ç¿¼æ‹‰åŠ›çš„å¤§å°ï¼Œæ“çºµæ— äººæœºçš„å‚ç›´è¿åŠ¨ã€‚ é€šè¿‡å‘¨æœŸå˜è·æ“çºµä½¿å€¾æ–œç›˜æ²¿ä¸åŒçš„æ–¹å‘å€¾æ–œï¼Œä»è€Œæ”¹å˜æ—‹ç¿¼æ‹‰åŠ›çš„æ–¹å‘ï¼Œæ“çºµæ— äººæœºçš„æ¨ªå‘è¿åŠ¨å’Œçºµå‘è¿åŠ¨ã€‚ é€šè¿‡èˆªå‘æ“çºµæ”¹å˜ä¸Šä¸‹æ—‹ç¿¼çš„æ‰­çŸ©å·®ä½¿æ— äººæœºçš„èˆªå‘æ”¹å˜æ¥æ“çºµèˆªå‘è¿åŠ¨ã€‚ å…³äºç›¸æœºçš„å†…å‚ ç›¸æœºå†…å‚çš„ä½œç”¨å°±æ˜¯æŠŠåæ ‡ä»ç›¸æœºåæ ‡ç³»è½¬æ¢åˆ°åƒç´ åæ ‡ç³»\nè®¾ $O - x - y - z$ ä¸ºç›¸æœºåæ ‡ç³»ï¼Œä¹ æƒ¯ä¸Šæˆ‘ä»¬æŠŠ $z$ è½´æŒ‡å‘ç›¸æœºå‰æ–¹ï¼Œ $x$ å‘å³ï¼Œ $y$ å‘ä¸‹ã€‚ $O$ ä¸ºæ‘„åƒæœºçš„å…‰å¿ƒï¼Œä¹Ÿå°±æ˜¯é’ˆå­”æ¨¡å‹ä¸­çš„é’ˆå­”ã€‚ P ä¸ºçœŸå®ä¸–ç•Œä¸­çš„ä¸€ç‚¹ï¼Œåœ¨ç›¸æœºåæ ‡ç³»ä¸­åæ ‡ä¸º $[X, Y, Z]^T$ï¼Œæˆåƒç‚¹**P\u0026rsquo;**çš„åæ ‡ä¸º $[X\u0026rsquo;, Y\u0026rsquo;, Z\u0026rsquo;]^T$ ï¼Œç„¦è·ï¼ˆç‰©ç†æˆåƒå¹³é¢å’Œå…‰å¿ƒçš„è·ç¦»ï¼‰ä¸º $f$ ã€‚\næ ¹æ®ç›¸ä¼¼ä¸‰è§’å½¢å¯çŸ¥ï¼š $$ X\u0026rsquo; = f \\frac{X} {Z} \\ Y\u0026rsquo; = f \\frac{Y} {Z} $$ è®¾ $O\u0026rsquo; - u - v$ æ˜¯åƒç´ åæ ‡ç³»ï¼ŒåŸç‚¹ $o\u0026rsquo;$ ä½äºå›¾åƒå·¦ä¸Šè§’ï¼Œ $u$ è½´å‘å³ä¸ $x$ è½´å¹³è¡Œï¼Œ $v$ è½´å‘ä¸‹ä¸ $y$ è½´å¹³è¡Œã€‚åƒç´ åæ ‡åœ¨ $u$ è½´ä¸Šç¼© $\\alpha$ æ”¾å€ï¼Œåœ¨vè½´ä¸Šç¼©æ”¾äº† $\\beta$ å€ï¼ŒåŸç‚¹å¹³ç§»äº† $[c_x, c_y]^T$ ã€‚**P\u0026rsquo;**åœ¨åƒç´ å¹³é¢åæ ‡ç³»ä¸Šçš„åæ ‡æ˜¯ $[u, v]^T$ ã€‚\nåˆ™å¯ä»¥å¾—åˆ°Pâ€˜ä¸åƒç´ åæ ‡ç³»çš„å…³ç³»ä¸ºï¼š $$ u = \\alpha X\u0026rsquo; + c_x \\ v = \\beta Y\u0026rsquo; + c_y $$ è¿›è€Œå¾—åˆ°Pä¸**Pâ€™**çš„å…³ç³»ï¼š $$ u = \\alpha f \\frac{X} {Z} + c_x = f_x \\frac{X} {Z} + c_x $$\n$$ v = \\beta f \\frac{Y} {Z} + c_y = f_y \\frac{Y} {Z} + c_y $$\nè½¬æ¢ä¸ºçŸ©é˜µå½¢å¼ï¼š $$ Z \\left( \\begin{matrix} u \\\\\\ v \\\\\\ 1 \\end{matrix} \\right) = \\left( \\begin{matrix} f_x \u0026amp; 0 \u0026amp; c_x \\\\\\ 0 \u0026amp; f_y \u0026amp; c_y \\\\\\ 0 \u0026amp; 0 \u0026amp; 1 \\end{matrix} \\right) \\left( \\begin{matrix} X \\\\\\ Y \\\\\\ Z \\end{matrix} \\right) =KP $$ å…¶ä¸­ï¼ŒKä¸ºç›¸æœºçš„å†…å‚çŸ©é˜µã€‚\nç›¸æœºå¤–å‚çš„ä½œç”¨æ˜¯æŠŠåæ ‡ä»ä¸–ç•Œåæ ‡ç³»è½¬æ¢åˆ°ç›¸æœºåæ ‡ç³»ä¸­\næœ€å³è¾¹é‚£ä¸ªçŸ©é˜µå°±æ˜¯ç›¸æœºçš„å¤–å‚çŸ©é˜µã€‚\n","date":"2023-04-18T05:59:13+08:00","image":"https://haoleng-wick.github.io/p/%E6%97%A0%E4%BA%BA%E6%9C%BA%E5%9F%BA%E7%A1%80/uav_hu12096962700665607028.jpg","permalink":"https://haoleng-wick.github.io/p/%E6%97%A0%E4%BA%BA%E6%9C%BA%E5%9F%BA%E7%A1%80/","title":"æ— äººæœºåŸºç¡€"},{"content":"ShellåŸºç¡€ åŸºç¡€æ­£åˆ™è¡¨è¾¾å¼ç¬¦å· REå­—ç¬¦ æ„ä¹‰ å¤‡æ³¨ ^word å¾…æŸ¥è¯wordåœ¨è¡Œé¦– word$ å¾…æŸ¥è¯wordåœ¨è¡Œå°¾ . ä¸€å®šæœ‰ä¸€ä¸ªä»»æ„å­—ç¬¦ * é‡å¤é›¶åˆ°æ— ç©·ä¸ª * å‰é¢çš„å­—ç¬¦ [ABC] ABCä¸­çš„ä¸€ä¸ªå­—ç¬¦ [a-z] a~zä¸­çš„ä¸€ä¸ªå­—ç¬¦ [^peach] åˆ—å‡ºä¸åŒ…å«peachä¸­ä¸€ä¸ªå­—ç¬¦çš„è¡Œ åå‘é€‰å– \\{n,m\\} è¿ç»­nï½mä¸ªçš„å‰ä¸€ä¸ªREå­—ç¬¦ \\{n,\\} è¡¨ç¤ºè¿ç»­nä¸ªä»¥ä¸Šçš„å‰ä¸€ä¸ªREå­—ç¬¦ grepç®¡é“å‘½ä»¤ grep -n '[^a-z]pple' filename.mdé€‰å–å‡ºppleå‰é¢ä¸åŒ…å«a~zä¸­ä¸€ä¸ªå­—ç¬¦çš„è¡Œï¼ˆåƒappleå°±ä¸ä¼šè¢«åˆ—å‡ºæ¥ï¼‰ grep -n '^$' filename.mdåˆ—å‡ºæ–‡ä»¶ä¸­çš„æ‰€æœ‰ç©ºè¡Œ grep -v '^$' /etc/rsyslog.conf |grep -v '^#'å»æ‰ç©ºè¡Œå’Œä»¥#å¼€å¤´çš„è¡Œ sedç®¡é“å‘½ä»¤ æ ¼å¼ï¼šsed -[nefr] {æ“ä½œ}\nsed '2,5dåˆ é™¤ç¬¬2ï½5è¡Œ sed '2,$dåˆ é™¤ç¬¬2è¡Œåˆ°æœ€åä¸€è¡Œ sed '2a add something'åœ¨ç¬¬äºŒè¡ŒååŠ å…¥add something sed '2i add something'åœ¨ç¬¬äºŒè¡Œå‰åŠ å…¥add something sed '2,5c Somethingå°†ç¬¬äºŒè¡Œåˆ°ç¬¬äº”è¡ŒæŒ‰è¡Œæ›¿æ¢ä¸ºSomething sed 's/è¦è¢«æ›¿æ¢çš„å­—ç¬¦/æ–°çš„å­—ç¬¦/gï¼ˆéƒ¨åˆ†æ›¿æ¢ï¼‰ æ —å­ï¼š\n1 2 cat /etc/man_db.conf|grep \u0026#34;MAN\u0026#34;|sed \u0026#39;s/#.*$//g\u0026#39;|sed \u0026#39;/^$/d\u0026#39; åˆ—å‡ºæ–‡ä»¶ä¸­å«æœ‰MANå­—ç¬¦çš„æ•´è¡Œå¹¶æŠŠä»¥#å¼€å¤´çš„è¡Œæ¢æˆç©ºè¡Œä¹‹ååˆ æ‰ç©ºè¡Œ sed -i xxx ä¿®æ”¹åŸæ–‡ä»¶è€Œä¸æ˜¯ä»…ä¿®æ”¹æ‰“å°ï¼Œæ¯”è¾ƒå±é™© ä¾‹å¦‚sed -i 's/\\.$/\\!/g' filename.mdè¡¨ç¤ºä¿®æ”¹filename.mdä¸­ä»¥.ç»“å°¾çš„è¡Œçš„å¥æœ«çš„.ä¸ºï¼ awk awkä¸æ˜¯æ•´è¡Œæ“ä½œçš„ï¼Œå®ƒæ›´å€¾å‘äºä¸€è¡Œä¸­åˆ†æˆæ•°ä¸ªå­—æ®µæ¥å¤„ç†ã€‚\n1 2 3 4 5 6 7 $ last -n 5 haoleng tty1 :0 Thu Jun 18 07:28 still logged in reboot system boot 5.7.2-arch1-1 Thu Jun 18 07:27 still running haoleng tty1 :0 Wed Jun 17 16:07 - down (00:41) haoleng tty1 :0 Wed Jun 17 16:04 - 16:07 (00:02) reboot system boot 5.7.2-arch1-1 Wed Jun 17 16:04 - 16:48 (00:44) wtmp begins Sat Apr 11 12:49:36 2020 ä½¿ç”¨awkä¹‹åï¼š\n1 2 3 4 5 6 7 8 $ last -n 5 |awk \u0026#39;{print $1 \u0026#34;\\t\u0026#34; $3}\u0026#39; haoleng\t:0 reboot\tboot haoleng\t:0 haoleng\t:0 reboot\tboot wtmp\tSat awkçš„å†…ç½®å˜é‡ å˜é‡åç§° ä»£è¡¨æ„ä¹‰ NF æ¯ä¸€è¡Œï¼ˆ$0ï¼‰æ‹¥æœ‰çš„å­—æ®µæ€»æ•° NR ç›®å‰awkæ‰€å¤„ç†çš„æ˜¯ç¬¬å‡ è¡Œæ•°æ® FS ç›®å‰çš„åˆ†å‰²å­—ç¬¦ 1 2 3 4 5 6 7 8 $ last -n 5|awk \u0026#39;{print $1 \u0026#34;\\t line_count: \u0026#34;NF \u0026#34;\\t line: \u0026#34; NR}\u0026#39; haoleng\tline_count: 10\tline: 1 reboot\tline_count: 10\tline: 2 haoleng\tline_count: 10\tline: 3 haoleng\tline_count: 10\tline: 4 reboot\tline_count: 11\tline: 5 line_count: 0\tline: 6 wtmp\tline_count: 7\tline: 7 å‡è®¾æœ‰ä¸€ä»½è–ªèµ„æ•°æ®è¡¨pay.txtï¼Œå†…å®¹å¦‚ä¸‹\n1 2 3 4 Name\t1st\t2nd\t3th John\t23000\t24000\t25000 Wick\t21000 20000\t26000 V\t43000\t42000\t41900 å¯ä»¥ç”¨awkæ±‚å’Œï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 $ cat pay.txt |\\ \u0026gt; awk \u0026#39;NR==1{printf \u0026#34;%10s %10s %10s %10s %10s\\n\u0026#34;,$1,$2,$3,$4,\u0026#34;Total\u0026#34;} \u0026gt; NR\u0026gt;=2{total = $2 +$3 +$4;\\ \u0026gt; printf \u0026#34;%10s %10s %10s %10s %10.2f\\n\u0026#34;,$1,$2,$3,$4,total}\u0026#39; Name 1st 2nd 3th Total John 23000 24000 25000 72000.00 Wick 21000 20000 26000 67000.00 V 43000 42000 41900 126900.00 æˆ–è€…ç”¨ä¸‹é¢çš„å‘½ä»¤åŒæ ·å¯ä»¥ï¼š $ cat pay.txt |\\ \u0026gt; awk \u0026#39;{if (NR==1) printf \u0026#34;%10s %10s %10s %10s %10s\\n\u0026#34;,$1,$2,$3,$4,\u0026#34;Total\u0026#34;} \u0026gt; NR\u0026gt;=2{total = $2 +$3 +$4;\\ \u0026gt; printf \u0026#34;%10s %10s %10s %10s %10.2f\\n\u0026#34;,$1,$2,$3,$4,total}\u0026#39; Name 1st 2nd 3th Total John 23000 24000 25000 72000.00 Wick 21000 20000 26000 67000.00 V 43000 42000 41900 126900.00 ç®€å•çš„æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ REå­—ç¬¦ æ„ä¹‰ èŒƒä¾‹ + ä¸€ä¸ªæˆ–ä¸€ä¸ªä»¥ä¸Š+å‰é¢çš„å­—ç¬¦ egrep -n 'go+d' filename.mdâ€”â€”good god\u0026hellip; ? ä¸€ä¸ªæˆ–è€…é›¶ä¸ªï¼Ÿå‰é¢çš„å­—ç¬¦ go+dä¸go?dçš„é›†åˆæ˜¯ go*d | ç”¨orçš„æ–¹æ³•æ‰¾å‡ºæ•°ä¸ªå­—ç¬¦ä¸² `egrep -n \u0026lsquo;god ( ) æ‰¾å‡º[ç»„ç¾¤]å­—ç¬¦ä¸² `egrep -n \u0026lsquo;g(lo ( )+ é‡å¤çš„ç»„ç¾¤ ä¸€ä¸ªç®€å•çš„æ —å­ï¼šgrep -v '^$' filename.md|grep -v '^#' ç­‰ä»·ä¸ egrep -v '^$|^#' filename.md\n","date":"2020-06-18T05:59:13+08:00","image":"https://haoleng-wick.github.io/p/shell%E5%9F%BA%E7%A1%80/terminal_hu1733500932178902221.png","permalink":"https://haoleng-wick.github.io/p/shell%E5%9F%BA%E7%A1%80/","title":"ShellåŸºç¡€"}]