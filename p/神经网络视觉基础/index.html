<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Êú¨‰∫∫Êï¥ÁêÜÁöÑÂÖ≥‰∫éÁ•ûÁªèÁΩëÁªúËßÜËßâÁöÑÂÜÖÂÆπÔºåÂåÖÊã¨‰∫ÜÂêÑÁßçÂõæÂ±ÇÁöÑ‰ªãÁªçÔºåËøòÊúâ‰∏Ä‰∫õÁªèÂÖ∏Á•ûÁªèÁΩëÁªúÁöÑÁªìÊûÑÂíåÂéüÁêÜ„ÄÇ'>
<title>Á•ûÁªèÁΩëÁªúËßÜËßâÂü∫Á°Ä</title>

<link rel='canonical' href='https://haoleng-wick.github.io/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/'>

<link rel="stylesheet" href="/scss/style.min.3a32c3f1ade81cbe3a3ab60c3481d3273386dfdf58faacf12aabf0c78b6f2c37.css"><meta property='og:title' content='Á•ûÁªèÁΩëÁªúËßÜËßâÂü∫Á°Ä'>
<meta property='og:description' content='Êú¨‰∫∫Êï¥ÁêÜÁöÑÂÖ≥‰∫éÁ•ûÁªèÁΩëÁªúËßÜËßâÁöÑÂÜÖÂÆπÔºåÂåÖÊã¨‰∫ÜÂêÑÁßçÂõæÂ±ÇÁöÑ‰ªãÁªçÔºåËøòÊúâ‰∏Ä‰∫õÁªèÂÖ∏Á•ûÁªèÁΩëÁªúÁöÑÁªìÊûÑÂíåÂéüÁêÜ„ÄÇ'>
<meta property='og:url' content='https://haoleng-wick.github.io/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/'>
<meta property='og:site_name' content='Â•ΩÂÜ∑„ÅÆÂ∞èÁ™ù'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Êú∫Âô®ËßÜËßâ' /><meta property='article:published_time' content='2023-05-11T05:59:13&#43;08:00'/><meta property='article:modified_time' content='2024-02-21T12:35:31&#43;08:00'/><meta property='og:image' content='https://haoleng-wick.github.io/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/cnn_total.jpg' />
<meta name="twitter:title" content="Á•ûÁªèÁΩëÁªúËßÜËßâÂü∫Á°Ä">
<meta name="twitter:description" content="Êú¨‰∫∫Êï¥ÁêÜÁöÑÂÖ≥‰∫éÁ•ûÁªèÁΩëÁªúËßÜËßâÁöÑÂÜÖÂÆπÔºåÂåÖÊã¨‰∫ÜÂêÑÁßçÂõæÂ±ÇÁöÑ‰ªãÁªçÔºåËøòÊúâ‰∏Ä‰∫õÁªèÂÖ∏Á•ûÁªèÁΩëÁªúÁöÑÁªìÊûÑÂíåÂéüÁêÜ„ÄÇ"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://haoleng-wick.github.io/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/cnn_total.jpg' />
    <link rel="shortcut icon" href="/favicon.ico" />

  



<script async src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/V_hu9f0bc702f392808b5056dd53948f34a5_1454089_300x0_resize_box_1.gif" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üíä</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Â•ΩÂÜ∑„ÅÆÂ∞èÁ™ù</a></h1>
            <h2 class="site-description">‰∏çÁßØË∑¨Ê≠•ÔºåÊó†‰ª•Ëá≥ÂçÉÈáå</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/haoleng-Wick'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://space.bilibili.com/103979628'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-bilibili" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" />
  <path d="M8 3l2 3" />
  <path d="M16 3l-2 3" />
  <path d="M9 13v-2" />
  <path d="M15 11v2" />
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://steamcommunity.com/profiles/76561198364816762'
                        target="_blank"
                        title="Steam"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-steam" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M16.5 5a4.5 4.5 0 1 1 -.653 8.953l-4.347 3.009l0 .038a3 3 0 0 1 -2.824 3l-.176 0a3 3 0 0 1 -2.94 -2.402l-2.56 -1.098v-3.5l3.51 1.755a2.989 2.989 0 0 1 2.834 -.635l2.727 -3.818a4.5 4.5 0 0 1 4.429 -5.302z" />
  <circle cx="16.5" cy="9.5" r="1" fill="currentColor" />
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='mailto:yhx2604918320@163.com'
                        target="_blank"
                        title="Mail"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M11 19h-6a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v6" />
  <path d="M3 7l9 6l9 -6" />
  <path d="M15 19l2 2l4 -4" />
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://haoleng-wick.github.io/index.xml'
                        target="_blank"
                        title="RSS"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="5" cy="19" r="1" />
  <path d="M4 4a16 16 0 0 1 16 16" />
  <path d="M4 11a9 9 0 0 1 9 9" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>‰∏ªÈ°µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>ÂÖ≥‰∫é</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>ÂΩíÊ°£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>ÊêúÁ¥¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>ÂèãÊÉÖÈìæÊé•</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
                <li id="i18n-switch">  
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                    <select name="language" onchange="window.location.href = this.selectedOptions[0].value">
                        
                            <option value="https://haoleng-wick.github.io/" selected>‰∏≠Êñá</option>
                        
                            <option value="https://haoleng-wick.github.io/en/" >English</option>
                        
                    </select>
                </li>
            
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>ÊöóËâ≤Ê®°Âºè</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#Âü∫Á°ÄÁü•ËØÜ">Âü∫Á°ÄÁü•ËØÜ</a>
      <ol>
        <li><a href="#Á•ûÁªèÁΩëÁªúÁöÑÂü∫Êú¨ÂéüÁêÜ">Á•ûÁªèÁΩëÁªúÁöÑÂü∫Êú¨ÂéüÁêÜ</a>
          <ol>
            <li><a href="#Âç∑ÁßØÂ±ÇÂ±ÄÈÉ®ÊÑüÁü•ÊùÉÂÄºÂÖ±‰∫´--ÂõæÂÉèÁâπÂæÅÊèêÂèñ">Âç∑ÁßØÂ±ÇÔºàÂ±ÄÈÉ®ÊÑüÁü•„ÄÅÊùÉÂÄºÂÖ±‰∫´Ôºâ&ndash;ÔºàÂõæÂÉèÁâπÂæÅÊèêÂèñÔºâ</a></li>
            <li><a href="#ÊøÄÊ¥ªÂ±Ç-ÈÄöËøáÂáΩÊï∞ÊääÁâπÂæÅ‰øùÁïôÂπ∂Êò†Â∞ÑÂà∞ËæìÂá∫Á´Ø">ÊøÄÊ¥ªÂ±Ç (ÈÄöËøáÂáΩÊï∞ÊääÁâπÂæÅ‰øùÁïôÂπ∂Êò†Â∞ÑÂà∞ËæìÂá∫Á´Ø)</a></li>
            <li><a href="#Ê±†ÂåñÂ±ÇÂØπÁâπÂæÅÂõæËøõË°åÁ®ÄÁñèÂ§ÑÁêÜ">Ê±†ÂåñÂ±ÇÔºàÂØπÁâπÂæÅÂõæËøõË°åÁ®ÄÁñèÂ§ÑÁêÜÔºâ</a></li>
            <li><a href="#ÂÖ®ËøûÊé•Â±ÇÁâπÂæÅÁ©∫Èó¥--Ê†∑Êú¨Ê†áËÆ∞Á©∫Èó¥">ÂÖ®ËøûÊé•Â±ÇÔºàÁâπÂæÅÁ©∫Èó¥&ndash;&gt;Ê†∑Êú¨Ê†áËÆ∞Á©∫Èó¥)</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#ÂõæÂÉèÂ§ÑÁêÜ‰∏≠ÁöÑÂç∑ÁßØÁ•ûÁªèÁΩëÁªú">ÂõæÂÉèÂ§ÑÁêÜ‰∏≠ÁöÑÂç∑ÁßØÁ•ûÁªèÁΩëÁªú</a>
      <ol>
        <li><a href="#lenetÊ®°Âûã1998">LeNetÊ®°ÂûãÔºà1998Ôºâ</a></li>
        <li><a href="#alexnetÊ®°Âûã2012">ALexNetÊ®°ÂûãÔºà2012Ôºâ</a></li>
        <li><a href="#googlenetÊ®°Âûã2014">GoogleNetÊ®°ÂûãÔºà2014Ôºâ</a></li>
        <li><a href="#vggnetÊ®°Âûã2014">VGGNetÊ®°ÂûãÔºà2014Ôºâ</a></li>
        <li><a href="#ssdÊ®°Âûã2016">SSDÊ®°ÂûãÔºà2016Ôºâ</a></li>
        <li><a href="#mobilenet2017">MobileNetÔºà2017Ôºâ</a>
          <ol>
            <li><a href="#mobilenetv1">MobileNetV1</a></li>
            <li><a href="#mobilenet-v2">MobileNet v2</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/">
                <img src="/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/cnn_total_hue114c50f1abc267ea1a1a271f180c42e_46393_800x0_resize_q75_box.jpg"
                        srcset="/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/cnn_total_hue114c50f1abc267ea1a1a271f180c42e_46393_800x0_resize_q75_box.jpg 800w, /p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/cnn_total_hue114c50f1abc267ea1a1a271f180c42e_46393_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="413" 
                        loading="lazy"
                        alt="Featured image of post Á•ûÁªèÁΩëÁªúËßÜËßâÂü∫Á°Ä" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E5%AD%A6%E4%B9%A0/" style="background-color: #2a9d8f; color: #fff;">
                Â≠¶‰π†
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/">Á•ûÁªèÁΩëÁªúËßÜËßâÂü∫Á°Ä</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Êú¨‰∫∫Êï¥ÁêÜÁöÑÂÖ≥‰∫éÁ•ûÁªèÁΩëÁªúËßÜËßâÁöÑÂÜÖÂÆπÔºåÂåÖÊã¨‰∫ÜÂêÑÁßçÂõæÂ±ÇÁöÑ‰ªãÁªçÔºåËøòÊúâ‰∏Ä‰∫õÁªèÂÖ∏Á•ûÁªèÁΩëÁªúÁöÑÁªìÊûÑÂíåÂéüÁêÜ„ÄÇ
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2023-05-11</time>
            </div>
        <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-edit" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1" />
  <path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z" />
  <path d="M16 5l3 3" />
</svg>

                <time class="article-lastmod">2024-02-21</time>
            </div>
        


        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    ÈòÖËØªÊó∂Èïø: 16 ÂàÜÈíü
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
     
<section class="toc toc--inline">
    <h2 class="">ÁõÆÂΩï</h2>
    <div class="" >
        <nav id="TableOfContents">
  <ol>
    <li><a href="#Âü∫Á°ÄÁü•ËØÜ">Âü∫Á°ÄÁü•ËØÜ</a>
      <ol>
        <li><a href="#Á•ûÁªèÁΩëÁªúÁöÑÂü∫Êú¨ÂéüÁêÜ">Á•ûÁªèÁΩëÁªúÁöÑÂü∫Êú¨ÂéüÁêÜ</a>
          <ol>
            <li><a href="#Âç∑ÁßØÂ±ÇÂ±ÄÈÉ®ÊÑüÁü•ÊùÉÂÄºÂÖ±‰∫´--ÂõæÂÉèÁâπÂæÅÊèêÂèñ">Âç∑ÁßØÂ±ÇÔºàÂ±ÄÈÉ®ÊÑüÁü•„ÄÅÊùÉÂÄºÂÖ±‰∫´Ôºâ&ndash;ÔºàÂõæÂÉèÁâπÂæÅÊèêÂèñÔºâ</a></li>
            <li><a href="#ÊøÄÊ¥ªÂ±Ç-ÈÄöËøáÂáΩÊï∞ÊääÁâπÂæÅ‰øùÁïôÂπ∂Êò†Â∞ÑÂà∞ËæìÂá∫Á´Ø">ÊøÄÊ¥ªÂ±Ç (ÈÄöËøáÂáΩÊï∞ÊääÁâπÂæÅ‰øùÁïôÂπ∂Êò†Â∞ÑÂà∞ËæìÂá∫Á´Ø)</a></li>
            <li><a href="#Ê±†ÂåñÂ±ÇÂØπÁâπÂæÅÂõæËøõË°åÁ®ÄÁñèÂ§ÑÁêÜ">Ê±†ÂåñÂ±ÇÔºàÂØπÁâπÂæÅÂõæËøõË°åÁ®ÄÁñèÂ§ÑÁêÜÔºâ</a></li>
            <li><a href="#ÂÖ®ËøûÊé•Â±ÇÁâπÂæÅÁ©∫Èó¥--Ê†∑Êú¨Ê†áËÆ∞Á©∫Èó¥">ÂÖ®ËøûÊé•Â±ÇÔºàÁâπÂæÅÁ©∫Èó¥&ndash;&gt;Ê†∑Êú¨Ê†áËÆ∞Á©∫Èó¥)</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#ÂõæÂÉèÂ§ÑÁêÜ‰∏≠ÁöÑÂç∑ÁßØÁ•ûÁªèÁΩëÁªú">ÂõæÂÉèÂ§ÑÁêÜ‰∏≠ÁöÑÂç∑ÁßØÁ•ûÁªèÁΩëÁªú</a>
      <ol>
        <li><a href="#lenetÊ®°Âûã1998">LeNetÊ®°ÂûãÔºà1998Ôºâ</a></li>
        <li><a href="#alexnetÊ®°Âûã2012">ALexNetÊ®°ÂûãÔºà2012Ôºâ</a></li>
        <li><a href="#googlenetÊ®°Âûã2014">GoogleNetÊ®°ÂûãÔºà2014Ôºâ</a></li>
        <li><a href="#vggnetÊ®°Âûã2014">VGGNetÊ®°ÂûãÔºà2014Ôºâ</a></li>
        <li><a href="#ssdÊ®°Âûã2016">SSDÊ®°ÂûãÔºà2016Ôºâ</a></li>
        <li><a href="#mobilenet2017">MobileNetÔºà2017Ôºâ</a>
          <ol>
            <li><a href="#mobilenetv1">MobileNetV1</a></li>
            <li><a href="#mobilenet-v2">MobileNet v2</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>

    </div>
</section>



    
    
    <h1 id="Á•ûÁªèÁΩëÁªúËßÜËßâÂü∫Á°Ä">Á•ûÁªèÁΩëÁªúËßÜËßâÂü∫Á°Ä</h1>
<h2 id="Âü∫Á°ÄÁü•ËØÜ">Âü∫Á°ÄÁü•ËØÜ</h2>
<h3 id="Á•ûÁªèÁΩëÁªúÁöÑÂü∫Êú¨ÂéüÁêÜ">Á•ûÁªèÁΩëÁªúÁöÑÂü∫Êú¨ÂéüÁêÜ</h3>
<div align=center><img src="./cnn.png" alt="CNN" /></div>
<blockquote>
<p>Á•ûÁªèÁΩëÁªúÁöÑËÆ≠ÁªÉÔºå‰∏ªË¶ÅÁõÆÁöÑÂ∞±ÊòØÈÄöËøáÂ≠¶‰π†ÁÆóÊ≥ïÂæóÂà∞ÂêÑÂ±ÇÁ•ûÁªèÂÖÉ‰πãÈó¥ÁöÑËøûÊé•ÊùÉÈáçÂíåÂÅèÁΩÆÂèÇÊï∞Á≠âÔºåÁÑ∂ÂêéÈÄöËøáÂèÇÊï∞ËÆ°ÁÆóÂá∫ËæìÂÖ•ÂÄºÁöÑËæìÂá∫„ÄÇ</p>
</blockquote>
<p>Âç∑ÁßØÁ•ûÁªèÁΩëÁªúÂåÖÊã¨<strong>ËæìÂÖ•Â±Ç„ÄÅ‰∏≠Èó¥Â±Ç„ÄÅËæìÂá∫Â±Ç</strong>„ÄÇËÄå‰∏≠Èó¥Â±ÇÂèØ‰ª•ÁªÜÂåñ‰∏∫<strong>Âç∑ÁßØÂ±Ç„ÄÅÊøÄÊ¥ªÂ±Ç„ÄÅÊ±†ÂåñÂ±ÇÂíåÂÖ®ËøûÊé•Â±Ç</strong>„ÄÇ</p>
<h4 id="Âç∑ÁßØÂ±ÇÂ±ÄÈÉ®ÊÑüÁü•ÊùÉÂÄºÂÖ±‰∫´--ÂõæÂÉèÁâπÂæÅÊèêÂèñ">Âç∑ÁßØÂ±ÇÔºàÂ±ÄÈÉ®ÊÑüÁü•„ÄÅÊùÉÂÄºÂÖ±‰∫´Ôºâ&ndash;ÔºàÂõæÂÉèÁâπÂæÅÊèêÂèñÔºâ</h4>
<blockquote>
<p>Âç∑ÁßØÂ±Ç‰∏≠ÔºåÂç∑ÁßØÊìç‰ΩúÁî±‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™Âç∑ÁßØÊ†∏(filter)Âú®ÂâçÂ±ÇÂõæÂÉè‰∏äÈÄâÊã©Áõ∏Â∫îÁöÑÂå∫ÂüüÂÅöÂç∑ÁßØËøêÁÆóÔºåÁÑ∂ÂêéÊåâ‰∏ÄÂÆöÁöÑÊ≠•Èïø‰ΩúÊªëÂä®ËøêÁÆóÔºå‰æùÊ¨°ÊèêÂèñÂõæÂÉèÂå∫ÂüüÁöÑÂÉèÁ¥†Á∫ßÁâπÂæÅÔºåÂõæÂÉèÁâπÂæÅÁªºÂêàÂêéÁªèËøá<strong>ÊøÄÊ¥ªÂáΩÊï∞</strong>ÊøÄÊ¥ªÔºåÂÆåÊàê‰∏ÄÊ¨°ËæìÂÖ•Âà∞ËæìÂá∫ÁöÑÁâπÂæÅÊèêÂèñËøáÁ®ãÔºå<strong>Âç∑ÁßØÂêéÁöÑÁâπÂæÅÂõæÂèçÊò†‰∫ÜÂâçÂ±ÇÂõæÂÉèÁöÑËûçÂêàÁâπÂæÅ</strong>„ÄÇ</p>
</blockquote>
<h5 id="Âç∑ÁßØÊìç‰Ωú">Âç∑ÁßØÊìç‰Ωú</h5>
<div align=center><img src="./conver.png" alt="Âç∑ÁßØËøêÁÆó" /></div>
<p><strong>ÁªèÂç∑ÁßØÂêéÁöÑÁü©ÈòµÂ∞∫ÂØ∏Â§ßÂ∞èËÆ°ÁÆóÂÖ¨Âºè‰∏∫</strong>(ËæìÂÖ•ÂõæÁâáÂ§ßÂ∞èWxWÔºåÂç∑ÁßØÊ†∏FxFÔºåÊ≠•ÈïøSÔºåpadding = P)
$$
N = (W - F + 2P) / S + 1
$$</p>
<h4 id="ÊøÄÊ¥ªÂ±Ç-ÈÄöËøáÂáΩÊï∞ÊääÁâπÂæÅ‰øùÁïôÂπ∂Êò†Â∞ÑÂà∞ËæìÂá∫Á´Ø">ÊøÄÊ¥ªÂ±Ç (ÈÄöËøáÂáΩÊï∞ÊääÁâπÂæÅ‰øùÁïôÂπ∂Êò†Â∞ÑÂà∞ËæìÂá∫Á´Ø)</h4>
<blockquote>
<p>Âç∑ÁßØÁ•ûÁªèÁΩëÁªúÂú®Âç∑ÁßØÊìç‰ΩúÂêé‰ΩúÁî®ÈùûÁ∫øÊÄßÊøÄÊ¥ªÂáΩÊï∞ÔºåÂèØ‰ª•ÂÆûÁé∞ÂØπËæìÂÖ•‰ø°ÊÅØÁöÑÈùûÁ∫øÊÄßÂèòÂåñÔºå‰ªéËÄå‰ΩøÁΩëÁªúÁöÑËæìÂÖ•ÂíåËæìÂá∫‰∫ßÁîüÈùûÁ∫øÊÄßÊò†Â∞ÑÂÖ≥Á≥ªÔºåÊøÄÊ¥ªÂ±ÇÂØπÂç∑ÁßØÂêéÁöÑÈÄêÂÖÉÁ¥†‰ΩúÁî®ÊøÄÊ¥ªÂáΩÊï∞ÔºåÂÆûÁé∞ËæìÂÖ•ÂíåËæìÂá∫‰ø°ÊÅØÁöÑÂêåÁª¥„ÄÇÂºïÂÖ•ÊøÄÊ¥ªÂáΩÊï∞ÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫Ü<strong>Â¢ûÂä†Á•ûÁªèÁΩëÁªúÁöÑÈùûÁ∫øÊÄßÊãüÂêàËÉΩÂäõ</strong>„ÄÇ</p>
</blockquote>
<ul>
<li>
<p>&ldquo;‰∏∫‰ªÄ‰πà‰∏ÄÂÆöË¶ÅÈùûÁ∫øÊÄßÔºü&rdquo;</p>
<p>Âõ†‰∏∫Á•ûÁªèÁΩëÁªúÁöÑÊØè‰∏ÄÊ¨°ËæìÂÖ•ÂíåËæìÂá∫ÈÉΩÊòØÁ∫øÊÄßÊ±ÇÂíåËøáÁ®ãÔºå‰∏ã‰∏ÄÂ±ÇËæìÂá∫ÊâøÊé•‰∫Ü‰∏ä‰∏ÄÂ±ÇËæìÂÖ•ÂáΩÊï∞ÁöÑÁ∫øÊÄßÂèòÊç¢ÔºåÂ¶ÇÊûúÊ≤°ÊúâÈùûÁ∫øÊÄßÊøÄÊ¥ªÂáΩÊï∞ÔºåÈÇ£‰πàÊó†ËÆ∫Á•ûÁªèÁΩëÁªúÊúâÂ§öÂ∞ëÂ±ÇÔºåÊúÄÂêéÁöÑËæìÂá∫ÈÉΩÊòØËæìÂÖ•ÁöÑÁ∫øÊÄßÁªÑÂêà„ÄÇËøôÊ†∑ÁöÑÁ∫øÊÄßÁªÑÂêàÂπ∂‰∏çËÉΩËß£ÂÜ≥Â§çÊùÇÁöÑÈóÆÈ¢ò„ÄÇ</p>
</li>
</ul>
<h5 id="ÊøÄÊ¥ªÂáΩÊï∞">ÊøÄÊ¥ªÂáΩÊï∞</h5>
<ol>
<li><em>Sigmoid</em>ÔºàÂèàÁß∞‚ÄúÈÄªËæëÂáΩÊï∞‚ÄùÔºâ</li>
</ol>
<p>$$
f(x) = \frac {1} {1 + e^{-x}}
$$</p>
<p>$$
y = \begin{cases} 1, ÂΩìS(x) \ge 0.5 \\\
0, ÂΩìS(x) &lt; 0.5
\end{cases}
$$</p>
<p>$$
S(x)&rsquo; = \frac{e^{-x}}{(1+e^{-x})^2}
$$</p>
<div align=center><img src="./sigmoid.png" alt="SigmoidÂáΩÊï∞ÂõæÂÉè" /></div>
<p>‚Äã	<strong>‰ºòÁÇπ</strong>Ôºö</p>
<ul>
<li>ÂÄºÂüü‰∏∫[0,1]Ôºå‰ªñÂØπÊØè‰∏™Á•ûÁªèÂÖÉÁöÑËæìÂá∫ËøõË°å‰∫ÜÂΩí‰∏ÄÂåñÔºåÈÄÇÂêàÁî®‰∫éÂ∞Ü<strong>È¢ÑÊµãÊ¶ÇÁéá</strong>‰Ωú‰∏∫ËæìÂá∫ÁöÑÊ®°Âûã</li>
<li>Ê¢ØÂ∫¶Âπ≥ÊªëÔºåÈÅøÂÖç‰∫Ü<em>Ë∑≥Ë∑ÉÂºè</em> ÁöÑËæìÂá∫</li>
</ul>
<p>‚Äã	<strong>Áº∫ÁÇπ</strong>Ôºö</p>
<ul>
<li>Êé•Ëøë0Êàñ1ÁöÑÁ•ûÁªèÂÖÉÊ¢ØÂ∫¶Ë∂ãËøë‰∫é0ÔºåÂÆπÊòìÂºïËµ∑<strong>Ê¢ØÂ∫¶Ê∂àÂ§±</strong>ÔºåÂç≥Êó†Ê≥ïÂèçÂêë‰º†Êí≠Êõ¥Êñ∞ÊùÉÈáç„ÄÇ</li>
<li><strong>ËÆ°ÁÆóÈáèÂ§ß</strong>ÔºåÈúÄË¶ÅÊõ¥È´òÁöÑÁÆóÂäõ</li>
</ul>
<ol start="2">
<li><em>ReLU</em>ÔºàÁõÆÂâç‰∏ªÊµÅÁöÑÊøÄÊ¥ªÂáΩÊï∞Ôºâ</li>
</ol>
<p>$$
f(x) = Max(0, x)
$$</p>
<p>$$
f&rsquo;(x) = Sgn(x)
$$</p>
<p>‚Äã		Áõ∏ÊØîsigmoidÂáΩÊï∞ÔºåÂÖ∂<strong>ËÆ°ÁÆóÈÄüÂ∫¶Âø´</strong>Ôºå<strong>Êî∂ÊïõÈÄüÂ∫¶Âø´</strong>ÔºàÂõ†‰∏∫ËæìÂÖ•‰∏∫Ë¥üÂÄºÊó∂ÔºåÁ•ûÁªèÂÖÉ‰∏ç‰ºöË¢´ÊøÄÊ¥ªÔºåÊâÄ‰ª•ÁΩëÁªúÂæàÁ®ÄÁñèÔºåËÉΩÊõ¥Â•ΩÁöÑÊèêÂèñÁõ∏ÂÖ≥ÁâπÂæÅÔºåÊãüÂêàËÆ≠ÁªÉÊï∞ÊçÆÔºâ„ÄÇ<em>ReLU</em>ÂáΩÊï∞ËÉΩÂ§üÊúÄÂ§ßÂåñÂèëÊå•Á•ûÁªèÂÖÉÁöÑÁ≠õÈÄâËÉΩÂäõ„ÄÇ</p>
<ul>
<li>
<p><strong>‰∏çË∂≥</strong>ÔºöÂæàÂÆπÊòìËÆ≠ÁªÉËøáÁ®ã‰∏≠‰ΩøÈÉ®ÂàÜkernelÂ∫üÊéâÔºå‰∏îÊó†Ê≥ïÂÜçÊ¨°Ë¢´ÊøÄÊ¥ª„ÄÇ</p>
</li>
<li>
<p>&ldquo;ReLUÊòØÂàÜÊÆµÁ∫øÊÄßÂáΩÊï∞ÔºåÂÆÉÊòØÊÄé‰πàÂÆûÁé∞ÈùûÁ∫øÊÄßÁöÑÔºü&rdquo;</p>
<p><em>ReLU</em>Âú®Êï¥‰∏™ÂÆö‰πâÂüüÂÜÖÂπ∂‰∏çÊòØÁ∫øÊÄßÁöÑÔºåÁªÑÂêàÂ§ö‰∏™ÔºàÁ∫øÊÄßÊìç‰Ωú+<em>ReLU</em>ÔºâÂ∞±ÂèØ‰ª•‰ªªÊÑèÂàíÂàÜÁ©∫Èó¥ÔºåÂØπ‰∫éÂ±ÇÊï∞ÊØîËæÉÂ∞ëÁöÑÁ•ûÁªèÁΩëÁªúÔºåÁî®<em>ReLU</em>‰Ωú‰∏∫ÊøÄÊ¥ªÂáΩÊï∞ÔºåÈÇ£ÈùûÁ∫øÊÄßËÇØÂÆöÊ≤°ÊúâÈÇ£‰πàÂº∫Ôºå‰ΩÜÊòØÂΩìÂ±ÇÊï∞Â§öËææÂá†ÂçÅÁîöËá≥‰∏äÂçÉÔºåËôΩÁÑ∂ÔºåÂçïÁã¨ÁöÑÈöêËóèÂ±ÇÊòØÁ∫øÊÄßÁöÑÔºå‰ΩÜÊòØÂæàÂ§öÁöÑÈöêËóèÂ±ÇË°®Áé∞Âá∫Êù•ÁöÑÂ∞±ÊòØÈùûÁ∫øÊÄßÁöÑ„ÄÇÔºàÂç≥Áî®ÂæàÂ§öÂ∞èÁöÑÁõ¥Á∫øÂèØ‰ª•ÊãüÂêàÂá∫Êõ≤Á∫øÊïàÊûú‰∏ÄÊ†∑Ôºâ„ÄÇ</p>
</li>
</ul>
<ol start="3">
<li><em>Leaky ReLU</em></li>
</ol>
<div align=center><img src="./ReLu.png"  ! alt="ReLu" /></div>
$$
   f(x) = max(\alpha x, x)
$$
   ‚Äã	ÂÖ∂‰∏≠$\alpha$‰∏∫(0,1)ÁöÑÁ≥ªÊï∞ÔºåÂèØ‰ª•ÊúâÊïàËß£ÂÜ≥*ReLU*ÂáΩÊï∞Á•ûÁªèÂÖÉÊ≠ª‰∫°ÁöÑÁé∞Ë±°„ÄÇ
<ol start="4">
<li><em>Softmax</em> (ÊâÄÊúâËæìÂá∫Ê¶ÇÁéáÂíå‰∏∫<strong>1</strong>)</li>
</ol>
<p>$$
o_i = \frac {e^{y_i}} {\sum_je^{y_j}}
$$</p>
<ul>
<li>Áî®‰∫éÂ§öÂàÜÁ±ªÈóÆÈ¢òÁöÑÊøÄÊ¥ªÂáΩÊï∞</li>
<li>Âú®Èõ∂ÁÇπ‰∏çÂèØÂæÆÔºåË¥üËæìÂÖ•ÁöÑÊ¢ØÂ∫¶‰∏∫Èõ∂‰ºö‰∫ßÁîü‚ÄúÊ≠ª‰∫°Á•ûÁªèÂÖÉ‚Äù</li>
</ul>
<blockquote>
<p>ÂØπ‰∫é‰∫åÂàÜÁ±ªÈóÆÈ¢òÔºåÁêÜËÆ∫‰∏ä‰ΩøÁî®sigmoidÂíåsoftmaxÊ≤°ÊúâÂå∫Âà´ÔºåÂõ†‰∏∫Êï∞Â≠¶Ë°®ËææÂºèÁöÑÂΩ¢ÂºèÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ
ÂØπ‰∫éÂ§öÂàÜÁ±ªÈùû‰∫íÊñ•ÈóÆÈ¢òÔºàÂ§öÊ†áÁ≠æÂàÜÁ±ªÔºâÂ¶Ç‰∫∫ÂíåÂ•≥‰∫∫Ôºå‰ΩøÁî®sigmoidÊõ¥ÂêàÈÄÇ„ÄÇ
ÂØπ‰∫éÂ§öÂàÜÁ±ª‰∫íÊñ•ÈóÆÈ¢òÔºàÂçïÊ†áÁ≠æÂàÜÁ±ªÔºâÔºå‰ΩøÁî®softmaxÊõ¥ÂêàÈÄÇ„ÄÇ</p>
</blockquote>
<h4 id="Ê±†ÂåñÂ±ÇÂØπÁâπÂæÅÂõæËøõË°åÁ®ÄÁñèÂ§ÑÁêÜ">Ê±†ÂåñÂ±ÇÔºàÂØπÁâπÂæÅÂõæËøõË°åÁ®ÄÁñèÂ§ÑÁêÜÔºâ</h4>
<blockquote>
<p>Èôç‰Ωé‰ø°ÊÅØÂÜó‰ΩôÔºåÊèêÂçáÊ®°ÂûãÁöÑÂ∞∫Â∫¶‰∏çÂèòÊÄß„ÄÅÊóãËΩ¨‰∏çÂèòÊÄß„ÄÅÈò≤Ê≠¢ËøáÊãüÂêà„ÄÇ</p>
</blockquote>
<p><em>MaxPooling</em>ÔºàÊúÄÂ§ßÂÄºÊ±†ÂåñÔºâ</p>
<div align=center><img src="./max_pooling.png" alt="ÊúÄÂ§ßÂÄºÊ±†Âåñ" /></div>
<h4 id="ÂÖ®ËøûÊé•Â±ÇÁâπÂæÅÁ©∫Èó¥--Ê†∑Êú¨Ê†áËÆ∞Á©∫Èó¥">ÂÖ®ËøûÊé•Â±ÇÔºàÁâπÂæÅÁ©∫Èó¥&ndash;&gt;Ê†∑Êú¨Ê†áËÆ∞Á©∫Èó¥)</h4>
<blockquote>
<p>Âç∑ÁßØÂ±ÇÊèêÂèñ‰∫ÜÂêÑÁßçÁâπÂæÅÔºå‰ΩÜÂæàÂ§öÁâ©‰ΩìÂèØËÉΩÊã•ÊúâÂêå‰∏ÄÁ±ªÁâπÂæÅÔºåÂÖ®ËøûÊé•Â±ÇÁõ∏ÂΩì‰∫é<strong>ÁªÑÂêà‰∫ÜËøô‰∫õÁâπÂæÅ</strong>Ëµ∑Âà∞‰∫Ü<strong>ÂàÜÁ±ªÂô®</strong>ÁöÑÂäüËÉΩ„ÄÇ</p>
</blockquote>
<div align=center><img src="./full_connection.png" alt="ÂÖ®ËøûÊé•Â±Ç" /></div>
<h5 id="ÊçüÂ§±ÂáΩÊï∞">ÊçüÂ§±ÂáΩÊï∞</h5>
<blockquote>
<p>ÊçüÂ§±ÂáΩÊï∞ÊòØÁî®Êù•Ë°°ÈáèÊ®°ÂûãÈ¢ÑÊµãÂÄº$f(x)$‰∏éÁúüÂÆûÂÄº$Y$ÁöÑÂ∑ÆÂºÇÁ®ãÂ∫¶ÁöÑËøêÁÆóÂáΩÊï∞Ôºå‰ªñÊòØ‰∏Ä‰∏™ÈùûË¥üÂÆûÊï∞ÂÄºÂáΩÊï∞ÔºåÈÄöÂ∏∏Ë°®Á§∫‰∏∫$L(Y|f(x))$„ÄÇ</p>
</blockquote>
<p><strong>ÊçüÂ§±ÂáΩÊï∞</strong>‰ΩøÁî®‰∏ªË¶ÅÊòØÂú®Ê®°ÂûãÁöÑËÆ≠ÁªÉÈò∂ÊÆµÔºåÊØèÊâπËÆ≠ÁªÉÊï∞ÊçÆÈÄÅÂÖ•Ê®°ÂûãÂêéÔºåÈÄöËøá<strong>ÂâçÂêë‰º†Êí≠ËæìÂá∫È¢ÑÊµãÂÄº</strong>ÔºåÁÑ∂ÂêéÊçüÂ§±ÂáΩÊï∞‰ºöËÆ°ÁÆóÂá∫È¢ÑÊµãÂÄºÂíåÁúüÂÆûÂÄº‰πãÈó¥ÁöÑÂ∑ÆÂºÇÂÄºÔºå‰πüÂ∞±ÊòØÊçüÂ§±ÂÄº„ÄÇÂæóÂà∞ÊçüÂ§±ÂÄº‰πãÂêéÔºåÊ®°ÂûãÈÄöËøá<strong>ÂèçÂêë‰º†Êí≠ÂéªÊõ¥Êñ∞ÂêÑ‰∏™ÂèÇÊï∞</strong>ÔºåÊù•Èôç‰ΩéÁúüÂÆûÂÄº‰∏éÈ¢ÑÊµãÂÄº‰πãÈó¥ÁöÑÊçüÂ§±Ôºå‰ΩøÊ®°ÂûãË∂äÊù•Ë∂äÂáÜÁ°Æ„ÄÇ</p>
<p>&ldquo;ÂèçÂêë‰º†Êí≠ËøáÁ®ã&rdquo;
$$
\omega_{11} = \omega_{11} - \eta \frac{\partial \delta}{\partial \omega_{11}}
$$
ÈÄöËøá<strong>ÈìæÂºèÊ±ÇÂØºÊ≥ïÂàô</strong>Âíå<strong>Ê¢ØÂ∫¶‰∏ãÈôç</strong>ÔºåÈÄêÊ≠•‰øÆÊîπÊùÉÈáçÂèÇÊï∞$\omega$„ÄÇÂÖ∂‰∏≠ $\eta$ ‰∏∫Â≠¶‰π†ÁéáÔºå$\delta$‰∏∫ÊçüÂ§±ÂÄº„ÄÇ</p>
<p><strong>Âü∫‰∫éË∑ùÁ¶ªÂ∫¶ÈáèÁöÑÊçüÂ§±ÂáΩÊï∞</strong>Ôºö</p>
<ol>
<li>
<p>ÂùáÊñπËØØÂ∑ÆÊçüÂ§±ÂáΩÊï∞ÔºàMSEÔºâ
$$
L(Y|f(x)) = \frac{1}{n} \sum_{i=1}^N(Y_i - f(x_i))^2
$$</p>
</li>
<li>
<p>L2ÊçüÂ§±ÂáΩÊï∞(Ê¨ßÊ∞èË∑ùÁ¶ª)
$$
L(Y|f(x)) = \sqrt{\frac{1}{n} \sum_{i=1}^N (Y_i - f(x_i))^2}
$$</p>
</li>
<li>
<p>L2ÊçüÂ§±ÂáΩÊï∞(ÊõºÂìàÈ°øË∑ùÁ¶ª)
$$
L(Y|f(x)) = \sum_{i=1}^N |Y_i - f(x_i)|
$$</p>
</li>
<li>
<p>Smooth L1ÊçüÂ§±ÂáΩÊï∞(‰∏ªË¶ÅÁî®Âú®ÁõÆÊ†áÊ£ÄÊµã‰∏≠Èò≤Ê≠¢Ê¢ØÂ∫¶ÁàÜÁÇ∏)
$$
L(Y|f(x)) = \begin{cases}
\frac{1}{2}(Y-f(x))^2 \qquad \quad |Y-f(x)| &lt; 1 \\\
|Y-f(x)|- \frac{1}{2} \qquad |Y-f(x)| \ge 1
\end{cases}
$$</p>
</li>
<li>
<p>huberÊçüÂ§±ÂáΩÊï∞(Âπ≥ÊñπÊçüÂ§±+ÁªùÂØπÊçüÂ§±)
$$
L(Y|f(x)) = \begin{cases}
\frac{1}{2}(Y-f(x))^2 \qquad \qquad |Y-f(x)| \le \delta \\\
\delta |Y-f(x)|- \frac{1}{2} \delta^2 \qquad |Y-f(x)| &gt; \delta
\end{cases}
$$</p>
</li>
</ol>
<p><strong>Âü∫‰∫éÊ¶ÇÁéáÂàÜÂ∏ÉÂ∫¶ÈáèÁöÑÊçüÂ§±ÂáΩÊï∞</strong>Ôºö(Ê∂âÂèäÊ¶ÇÁéáÂàÜÂ∏ÉÊàñÈ¢ÑÊµãÁ±ªÂà´Âá∫Áé∞ÁöÑÊ¶ÇÁéáÁöÑÈóÆÈ¢ò‰∏≠Â∫îÁî®ÂπøÊ≥õ)</p>
<ol>
<li>
<p>KLÊï£Â∫¶ÂáΩÊï∞(Áõ∏ÂØπÁÜµ)
$$
L(Y|f(x)) = \sum_{i=1}^n Y_i \times log(\frac{Y_i}{f(x_i)})
$$</p>
</li>
<li>
<p><strong>‰∫§ÂèâÁÜµÊçüÂ§±</strong>
$$
L(Y|f(x)) = - \sum_{i=1}^n Y_i \times logf(x_i)
$$
‰∫§ÂèâÁÜµÊçüÂ§±ÂáΩÊï∞ÂàªÁîª‰∫ÜÂÆûÈôÖËæìÂá∫Ê¶ÇÁéá‰∏éÊúüÊúõËæìÂá∫Ê¶ÇÁéá‰πãÈó¥ÁöÑÁõ∏‰ººÂ∫¶Ôºå‰∫§ÂèâÁÜµÁöÑÂÄºË∂äÂ∞èÔºå‰∏§‰∏™Ê¶ÇÁéáÂàÜÂ∏ÉÂ∞±Ë∂äÊé•ËøëÔºåÁâπÂà´ÊòØÂú®Ê≠£Ë¥üÊ†∑Êú¨‰∏çÂùáË°°ÁöÑÂàÜÁ±ªÈóÆÈ¢ò‰∏≠ÔºåÂ∏∏Áî®‰∫§ÂèâÁÜµ‰Ωú‰∏∫ÊçüÂ§±ÂáΩÊï∞„ÄÇ</p>
<p>ÁõÆÂâçÔºå‰∫§ÂèâÁÜµÊçüÂ§±ÂáΩÊï∞ÊòØÂç∑ÁßØÁ•ûÁªèÁΩëÁªú‰∏≠ÊúÄÂ∏∏‰ΩøÁî®ÁöÑÂàÜÁ±ªÊçüÂ§±ÂáΩÊï∞ÔºåÂÆÉÂèØ‰ª•ÊúâÊïàÈÅøÂÖçÊ¢ØÂ∫¶Ê∂àÊï£„ÄÇÂú®‰∫åÂàÜÁ±ªÊÉÖÂÜµ‰∏ã‰πüÂè´ÂÅöÂØπÊï∞ÊçüÂ§±ÂáΩÊï∞„ÄÇ</p>
</li>
<li>
<p>softmaxÊçüÂ§±ÂáΩÊï∞
$$
L(Y|f(x)) = -\frac{1}{n} \sum_{i=1}^n Y_i \times log \frac{e^{f_{Y_i}}}{\sum_{j=1}^c e^{f_j}}
$$</p>
</li>
<li>
<p>Focal loss
$$
FE = \begin{cases}
-\alpha(1-p)^\gamma log(p) \qquad \quad y = 1 \\\
-(1 - \alpha)p^\gamma log(1-p) \quad y = 0
\end{cases}
$$</p>
</li>
</ol>
<h5 id="‰ºòÂåñÂô®">‰ºòÂåñÂô®</h5>
<blockquote>
<p>‰ºòÂåñÂô®Â∞±ÊòØÂú®Ê∑±Â∫¶Â≠¶‰π†<strong>ÂèçÂêë‰º†Êí≠</strong>ËøáÁ®ã‰∏≠Ôºå<strong>ÊåáÂºïÊçüÂ§±ÂáΩÊï∞</strong>ÔºàÁõÆÊ†áÂáΩÊï∞ÔºâÁöÑÂêÑ‰∏™ÂèÇÊï∞ÂæÄ<strong>Ê≠£Á°ÆÁöÑÊñπÂêë</strong>Êõ¥Êñ∞ÂêàÈÄÇÁöÑÂ§ßÂ∞èÔºå‰ΩøÂæóÊõ¥Êñ∞ÂêéÁöÑÂêÑ‰∏™ÂèÇÊï∞ËÆ©ÊçüÂ§±ÂáΩÊï∞ÔºàÁõÆÊ†áÂáΩÊï∞ÔºâÂÄº‰∏çÊñ≠ÈÄºËøë<strong>ÂÖ®Â±ÄÊúÄÂ∞è</strong>„ÄÇ</p>
</blockquote>
<ol>
<li><em>SGD‰ºòÂåñÂô®</em>Ôºà<strong>ÈöèÊú∫Ê¢ØÂ∫¶‰∏ãÈôçÊ≥ï</strong>ÔºåÊòìÂèóÂô™Â£∞ÂΩ±ÂìçÔºåÂèØËÉΩÈô∑ÂÖ•Â±ÄÈÉ®ÊúÄ‰ºòËß£Ôºâ</li>
</ol>
<p>$$
\omega_{t+1} = \omega_t - \alpha \cdot g(\omega_t)
$$</p>
<p>‚Äã	$\alpha$‰∏∫Â≠¶‰π†ÁéáÔºå$g(\omega_t)$ ‰∏∫$t$ Êó∂ÂàªÂØπÂèÇÊï∞$\omega_t$ ÁöÑÊçüÂ§±Ê¢ØÂ∫¶„ÄÇ</p>
<p>‚Äã	<strong>‰ºòÁÇπ</strong>Ôºö</p>
<ul>
<li>
<p>ÊØèÊ¨°Âè™Áî®‰∏Ä‰∏™Ê†∑Êú¨Êõ¥Êñ∞ÂèÇÊï∞ÔºåËÆ≠ÁªÉÈÄüÂ∫¶Âø´</p>
</li>
<li>
<p>ÈöèÊú∫Ê¢ØÂ∫¶‰∏ãÈôçÊâÄÂ∏¶Êù•ÁöÑÊ≥¢Âä®ÊúâÂà©‰∫é‰ºòÂåñÁöÑÊñπÂêë‰ªéÂΩìÂâçÁöÑÂ±ÄÈÉ®ÊûÅÂ∞èÂÄºÁÇπË∑≥Âà∞Âè¶‰∏Ä‰∏™Êõ¥Â•ΩÁöÑÂ±ÄÈÉ®ÊûÅÂ∞èÂÄºÁÇπÔºåËøôÊ†∑ÂØπ‰∫éÈùûÂá∏ÂáΩÊï∞ÔºåÊúÄÁªàÊî∂Êïõ‰∫é‰∏Ä‰∏™ËæÉÂ•ΩÁöÑÂ±ÄÈÉ®ÊûÅÂÄºÁÇπÔºåÁîöËá≥ÂÖ®Â±ÄÊûÅÂÄºÁÇπ„ÄÇ</p>
</li>
</ul>
<p>‚Äã	<strong>Áº∫ÁÇπ</strong>Ôºö</p>
<ul>
<li>ÂΩìÈÅáÂà∞Â±ÄÈÉ®ÊúÄ‰ºòÁÇπÊàñÈûçÁÇπÊó∂ÔºåÊ¢ØÂ∫¶‰∏∫0ÔºåÊó†Ê≥ïÁªßÁª≠Êõ¥Êñ∞ÂèÇÊï∞</li>
<li>Ê≤øÈô°Â≥≠ÊñπÂêëÈúáËç°ÔºåËÄåÊ≤øÂπ≥ÁºìÁª¥Â∫¶ËøõÂ±ïÁºìÊÖ¢ÔºåÈöæ‰ª•ËøÖÈÄüÊî∂Êïõ</li>
</ul>
<ol start="2">
<li><em><strong>SGD+Momentum</strong>‰ºòÂåñÂô®</em>ÔºàÂºïÂÖ•Âä®ÈáèÔºåÊäëÂà∂Ê†∑Êú¨Âô™Â£∞ÁöÑÂπ≤Êâ∞Ôºâ</li>
</ol>
<p>$$
v_t = \eta \cdot v_{t-1} + \alpha \cdot g(\omega_t) \\\
\omega_{t+1} = \omega_t - v_t
$$</p>
<p>‚Äã		$\alpha$‰∏∫Â≠¶‰π†ÁéáÔºå$g(\omega_t)$ ‰∏∫$t$ Êó∂ÂàªÂØπÂèÇÊï∞$\omega_t$ ÁöÑÊçüÂ§±Ê¢ØÂ∫¶Ôºå$\eta(0.9)$ ‰∏∫Âä®ÈáèÁ≥ªÊï∞„ÄÇ</p>
<ul>
<li>Âä†ÂÖ•‰∫ÜÂä®ÈáèÂõ†Á¥†ÔºåÁºìËß£‰∫ÜSGDÂú®Â±ÄÈÉ®ÊúÄ‰ºòÁÇπÊó†Ê≥ïÊåÅÁª≠Êõ¥Êñ∞ÁöÑÈóÆÈ¢òÂíåÈúáËç°ÂπÖÂ∫¶ËøáÂ§ßÁöÑÈóÆÈ¢òÔºå‰ΩÜÂπ∂Ê≤°ÊúâÂÆåÂÖ®Ëß£ÂÜ≥ÔºåÂΩìÂ±ÄÈÉ®Ê≤üÂ£ëÊØîËæÉÊ∑±ÔºåÂä®ÈáèÂä†ÊåÅÁî®ÂÆå‰∫ÜÔºå‰æùÁÑ∂‰ºöÂõ∞Âú®Â±ÄÈÉ®ÊúÄ‰ºòÈáåÊù•ÂõûÊåØËç°„ÄÇ</li>
</ul>
<ol start="3">
<li><em>Adagrad‰ºòÂåñÂô®</em>ÔºàËá™ÈÄÇÂ∫îÂ≠¶‰π†ÁéáÔºå‰∫åÈò∂Âä®ÈáèÔºâ</li>
</ol>
<p>$$
s_t = s_{t-1} + g(\omega_t) \cdot g(\omega_t) \\\
\omega_{t+1} = \omega_t - \frac{\alpha} {\sqrt{s_t + \varepsilon}} \cdot g(\omega_t)
$$</p>
<p>‚Äã		$\alpha$‰∏∫Â≠¶‰π†ÁéáÔºå$g(\omega_t)$ ‰∏∫$t$ Êó∂ÂàªÂØπÂèÇÊï∞$\omega_t$ ÁöÑÊçüÂ§±Ê¢ØÂ∫¶Ôºå$\varepsilon(10^{-7})$ ‰∏∫Èò≤Ê≠¢ÂàÜÊØç‰∏∫Èõ∂ÁöÑÂ∞èÊï∞„ÄÇ<em>Â≠¶‰π†Áéá‰∏ãÈôçËøáÂø´ÂÆπÊòìÊú™Êî∂ÊïõÂ∞±ÂÅúÊ≠¢ËÆ≠ÁªÉ</em></p>
<ol start="4">
<li><em><strong>RMSProp</strong>‰ºòÂåñÂô®</em>ÔºàËá™ÈÄÇÂ∫îÂ≠¶‰π†ÁéáÔºâ</li>
</ol>
<p>$$
s_t = \eta \cdot s_{t-1} + (1-\eta) \cdot g(\omega_t) \cdot g(\omega_t) \\\
\omega_{t+1} = \omega_t - \frac{\alpha} {\sqrt{s_t + \varepsilon}} \cdot g(\omega_t)
$$</p>
<p>‚Äã		$\alpha$‰∏∫Â≠¶‰π†ÁéáÔºå$g(\omega_t)$ ‰∏∫$t$ Êó∂ÂàªÂØπÂèÇÊï∞$\omega_t$ ÁöÑÊçüÂ§±Ê¢ØÂ∫¶Ôºå$\eta(0.9)$ ÊéßÂà∂Ë°∞ÂáèÈÄüÂ∫¶Ôºå$\varepsilon(10^{-7})$ ‰∏∫Èò≤Ê≠¢ÂàÜÊØç‰∏∫Èõ∂ÁöÑÂ∞èÊï∞„ÄÇ</p>
<ol start="5">
<li><em><strong>Adam</strong>‰ºòÂåñÂô®</em>ÔºàËá™ÈÄÇÂ∫îÂ≠¶‰π†ÁéáÔºâ</li>
</ol>
<p>$$
m_t = \beta_1 \cdot m_{t-1} + (1 - \beta_1) \cdot g(\omega_t) \qquad‰∏ÄÈò∂Âä®Èáè \\\
v_t = \beta_2 \cdot v_{t-1} + (1 - \beta_2) \cdot g(\omega_t) \cdot g(\omega_t) \quad‰∫åÈò∂Âä®Èáè \\\
\hat{m_t} = \frac{m_t}{1 - \beta^t_1} \quad \hat{\frac{v_t} {1 - \beta^t_2}} \\\
\omega_{t + 1} = \omega_t - \frac{\alpha} {\sqrt{\hat{v_t} + \varepsilon}} \hat{m_t}
$$</p>
<p>‚Äã		$\alpha$‰∏∫Â≠¶‰π†ÁéáÔºå$g(\omega_t)$ ‰∏∫$t$ Êó∂ÂàªÂØπÂèÇÊï∞$\omega_t$ ÁöÑÊçüÂ§±Ê¢ØÂ∫¶Ôºå$\beta_1(0.9)$„ÄÅ$\beta_2(0.999)$ ÊéßÂà∂Ë°∞ÂáèÈÄüÂ∫¶Ôºå$\varepsilon(10^{-7})$ ‰∏∫Èò≤Ê≠¢ÂàÜÊØç‰∏∫Èõ∂ÁöÑÂ∞èÊï∞„ÄÇ</p>
<ul>
<li>ÈÄöËøá‰∏ÄÈò∂Âä®ÈáèÂíå‰∫åÈò∂Âä®ÈáèÔºåÊúâÊïàÊéßÂà∂Â≠¶‰π†ÁéáÂíåÊ¢ØÂ∫¶ÊñπÂêëÔºåÈò≤Ê≠¢Ê¢ØÂ∫¶ÁöÑÊåØËç°ÂíåÂú®ÈûçÁÇπÁöÑÈùôÊ≠¢„ÄÇ</li>
<li>ÂèØËÉΩÈîôËøáÂÖ®Â±ÄÊúÄ‰ºòËß£„ÄÇËá™ÈÄÇÂ∫îÂ≠¶‰π†ÁéáÁÆóÊ≥ïÂèØËÉΩ‰ºöÂØπÂâçÊúüÂá∫Áé∞ÁöÑÁâπÂæÅËøáÊãüÂêàÔºåÂêéÊúüÊâçÂá∫Áé∞ÁöÑÁâπÂæÅÂæàÈöæÁ∫†Ê≠£ÂâçÊúüÁöÑÊãüÂêàÊïàÊûú„ÄÇÂêéÊúüAdamÁöÑÂ≠¶‰π†ÁéáÂ§™‰ΩéÔºåÂΩ±Âìç‰∫ÜÊúâÊïàÁöÑÊî∂Êïõ„ÄÇ</li>
</ul>
<h5 id="ËØÑ‰º∞ÊåáÊ†á--f1ÂàÜÊï∞">ËØÑ‰º∞ÊåáÊ†á&ndash;F1ÂàÜÊï∞</h5>
<p><strong>‰∫åÂàÜÁ±ªÔºö</strong></p>
<div align=center><img src="./Matrix_F1.png" alt="‰∫åÂàÜÁ±ªÁöÑÊ∑∑Ê∑ÜÁü©Èòµ" /></div>
<p><strong>Èò≥ÊÄßÊ†∑Êú¨ÁöÑÁúüÂÆûÊï∞Èáè</strong>Ôºö$TP + FN$</p>
<p><strong>Èò¥ÊÄßÊ†∑Êú¨ÁöÑÁúüÂÆûÊï∞Èáè</strong>Ôºö$FP + TN$</p>
<p>$Precision$ ÔºàÁ≤æÁ°ÆÁéáÔºåÂèàÁß∞Êü•ÂáÜÁéáÔºâÔºàÂÄºË∂äÈ´òË°®Á§∫ËØØËØäÊï∞Ë∂ä‰ΩéÔºâÔºö
$$
Precision = \frac {TP} {TP + FP}
$$
$Recall$ ÔºàÂè¨ÂõûÁéáÔºåÂèàÁß∞Êü•ÂÖ®ÁéáÔºâÔºàÂÄºË∂äÈ´òË°®Á§∫ÊºèÊéâÁöÑÁóÖ‰∫∫Ë∂äÂ∞ëÔºâÔºö
$$
Recall = \frac {TP} {TP + FN}
$$
$Accuracy$ ÔºàÂáÜÁ°ÆÁéáÔºâÔºàÊ≠£Á°ÆÁöÑÊ†∑Êú¨Âç†Ê†∑Êú¨ÊÄªÊï∞ÁöÑÊØî‰æãÔºâÔºö
$$
Accuracy = \frac {TP + TN} {TP + FN + FP + TN}
$$
$F1ÂàÜÊï∞$ ÔºàÁªºÂêàËÄÉËôë‰∫ÜÁ≤æÁ°ÆÁéáÂíåÂè¨ÂõûÁéáÔºåËÆ§‰∏∫‰ªñ‰ª¨ÂêåÁ≠âÈáçË¶ÅÔºâÔºö
$$
F1 = 2 \times \frac {Precision \times Recall} {Precision + Recall}
$$
<strong>Â§öÂàÜÁ±ªÈóÆÈ¢òÔºö</strong></p>
<ul>
<li>
<p>ÂæÆËßÇÔºö
$$
(Êü•ÂáÜÁéá) \quad microP = \frac {TP_1 + TP_2} {TP_1 + FP_1 + TP_2 + FP_2}
$$</p>
<p>$$
(Êü•ÂÖ®Áéá) \quad microR = \frac {TP_1 + TP_2} {TP_1 + FN_1 + TP_2 + FN_2}
$$</p>
<p>$$
microF1 = 2 \times \frac {microP \times microR} {microP + microR}
$$</p>
</li>
<li>
<p>ÂÆèËßÇÔºö
$$
(Êü•ÂáÜÁéá) \quad macroP = \frac {Precision1 + Precision2} {2}
$$</p>
<p>$$
(Êü•ÂÖ®Áéá) \quad macroR = \frac {Recall1 + Recall2} {2}
$$</p>
<p>$$
macroF1 = 2 \times \frac {macroP \times macroR} {macroP + macroR}
$$</p>
</li>
<li>
<p>&ldquo;ËØÑ‰º∞ÊåáÊ†áÁöÑÈÄâÊã©&rdquo;</p>
<p>ÂΩìÁ±ªÂà´ÁöÑÂàÜÂ∏ÉÁõ∏‰ººÊó∂ÔºåÂèØ‰ª•‰ΩøÁî®ÂáÜÁ°ÆÁéáÔºåÂΩì<strong>Á±ªÂà´ÁöÑÂàÜÂ∏É‰∏çÂπ≥Ë°°Êó∂</strong>ÔºåF1ÂàÜÊï∞ÊòØÊõ¥Â•ΩÁöÑËØÑ‰º∞ÊåáÊ†á„ÄÇ</p>
</li>
</ul>
<h2 id="ÂõæÂÉèÂ§ÑÁêÜ‰∏≠ÁöÑÂç∑ÁßØÁ•ûÁªèÁΩëÁªú">ÂõæÂÉèÂ§ÑÁêÜ‰∏≠ÁöÑÂç∑ÁßØÁ•ûÁªèÁΩëÁªú</h2>
<h3 id="lenetÊ®°Âûã1998">LeNetÊ®°ÂûãÔºà1998Ôºâ</h3>
<p>Áî±Yann Le Cun‰∫é1998Âπ¥ÊèêÂá∫Ôºå<strong>Â•†ÂÆö‰∫ÜÂç∑ÁßØÁ•ûÁªèÁΩëÁªúÁöÑÂü∫Á°Ä</strong>ÔºåÁî±‰∏§‰∏™Âç∑ÁßØÂ±Ç„ÄÅ‰∏§‰∏™ÂÖ®ËøûÊé•Â±ÇÂíå‰∏Ä‰∏™ËæìÂá∫Â±ÇÁªÑÊàê„ÄÇÊøÄÊ¥ªÂáΩÊï∞ÈááÁî®<em>softmax</em>ÔºåÊ±†ÂåñÂ±ÇÈááÁî®Âπ≥ÂùáÊ±†Âåñ„ÄÇËØ•Ê®°ÂûãÊó©Êúü‰∏ªË¶ÅÁî®‰∫éÊâãÂÜôÂ≠óÁ¨¶ÁöÑËØÜÂà´ÂíåÂàÜÁ±ª„ÄÇ</p>
<div align=center><img src="./LeNet.jpg" alt="LeNet" /></div>
<h3 id="alexnetÊ®°Âûã2012">ALexNetÊ®°ÂûãÔºà2012Ôºâ</h3>
<ul>
<li>È¶ñÊ¨°Âà©Áî®GPUËøõË°åÁΩëÁªúÂä†ÈÄüËÆ≠ÁªÉ</li>
<li>‰ΩøÁî®‰∫ÜReLuÊøÄÊ¥ªÂáΩÊï∞Ôºå‰ΩøÁî®ÊúÄÂ§ßÊ±†ÂåñÊñπÊ≥ï</li>
<li>‰ΩøÁî®‰∫ÜLRNÂ±ÄÈÉ®Áõ∏Â∫îÂΩí‰∏ÄÂåñ</li>
<li>Âú®ÂÖ®ËøûÊé•Â±ÇÁöÑÂâç‰∏§Â±Ç‰ΩøÁî®‰∫ÜDropoutÈöèÊú∫Â§±Ê¥ªÁ•ûÁªèÂÖÉÔºåÂáèÂ∞ëËøáÊãüÂêà</li>
</ul>
<div align=center><img src="./AlexNet.png" alt="AlexNet" /></div>
<blockquote>
<p>ËøáÊãüÂêàÊ†πÊú¨ÂéüÂõ†ÊòØ<strong>ÁâπÂæÅÁª¥Â∫¶ËøáÂ§ö</strong>ÔºåÊ®°ÂûãÂÅáËÆæËøá‰∫éÂ§çÊùÇÔºåÂèÇÊï∞ËøáÂ§öËÄåËÆ≠ÁªÉÊï∞ÊçÆËøáÂ∞ëÔºåÂô™Â£∞Â§öÔºåÂØºËá¥ÊãüÂêàÁöÑÂáΩÊï∞ÂÆåÁæéÁöÑÈ¢ÑÊµã‰∫ÜËÆ≠ÁªÉÈõÜËÄåÂØπÊµãËØïÈõÜÈ¢ÑÊµãÁªìÊûúÂ∑Æ„ÄÇ</p>
</blockquote>
<p>Âç∑ÁßØËÆ°ÁÆóÂÖ¨ÂºèÔºö</p>
<p>$$
N = \frac {(W - F + 2P)} {S} + 1
$$</p>
<p>AlexNet ÁΩëÁªúÁöÑÂÖ∑‰ΩìÂÆûÁé∞</p>
<blockquote>
<p>ÂéüÂõæËæìÂÖ•224x224 ÂÆûÈôÖ‰∏äËøõË°å‰∫ÜÈöèÊú∫Ë£ÅÂâ™ÔºåÂÆûÈôÖÂ§ßÂ∞è‰∏∫227x227</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">MaxPooling2D</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">deserialize</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Model</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">ALexNet</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">img_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Block 1</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (227, 227, 3) --&gt; (27, 27, 96)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                    <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv1&#39;</span><span class="p">)(</span><span class="n">img_input</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (55, 55, 96)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">MaxPooling2D</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;maxpool1&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Block 2</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (27, 27, 96) --&gt; (13, 13, 256)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv2&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (27, 27, 256)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">MaxPooling2D</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;maxpool2&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Block 3</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (13, 13, 256) --&gt; (13, 13, 384)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">384</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv3&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Block 4</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (13, 13, 384) --&gt; (13, 13, 384)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">384</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv4&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Block 5</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (13, 13, 384) --&gt; (6, 6, 256)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv5&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (13, 13, 256)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">MaxPooling2D</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;maxpool3&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Block 6</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (6, 6, 256) --&gt; (1, 4096)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;flatten&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;predictions&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">inputs</span> <span class="o">=</span> <span class="n">img_input</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;alexnet&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">model</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">ALexNet</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">227</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="googlenetÊ®°Âûã2014">GoogleNetÊ®°ÂûãÔºà2014Ôºâ</h3>
<ul>
<li>ÈÄöËøáÂºïÂÖ•InceptionÊ®°ÂùóÊù•Â¢ûÂä†ÁΩëÁªú<strong>ÂÆΩÂ∫¶</strong></li>
<li>ÂºïÂÖ•1x1ÁöÑÂç∑ÁßØÂ±ÇÊù•ÂéãÁº©ÈÄöÈÅìÊï∞ÈáèÔºåÈôç‰ΩéËÆ°ÁÆóÈáèÔºå‰ªéËÄåËøõ‰∏ÄÊ≠•Â¢ûÂä†ÁΩëÁªú<strong>Ê∑±Â∫¶</strong></li>
<li>Ê∑ªÂä†‰∏§‰∏™softmaxËæÖÂä©ÂàÜÁ±ªÂô®ÔºåÁºìËß£Ê¢ØÂ∫¶Ê∂àÂ§±Áé∞Ë±°</li>
</ul>
<p>InceptionÂ∞±ÊòØÊääÂ§ö‰∏™Âç∑ÁßØÊàñÊ±†ÂåñÊìç‰ΩúÊîæÂú®‰∏ÄËµ∑ÁªÑË£ÖÊàê‰∏Ä‰∏™ÁΩëÁªúÊ®°Âùó„ÄÇ</p>
<h3 id="vggnetÊ®°Âûã2014">VGGNetÊ®°ÂûãÔºà2014Ôºâ</h3>
<ul>
<li>‰ΩøÁî®Â§ö‰∏™3x3Â∞èÂ∞∫ÂØ∏Âç∑ÁßØÊ†∏ÂíåÊ±†ÂåñÂ±ÇÊûÑÈÄ†Ê∑±Â∫¶Âç∑ÁßØ</li>
<li>Âú®ÊúÄÂêé‰ΩøÁî®‰∏âÂ±ÇÂÖ®ËøûÊé•Â±ÇÔºåÁî®ÊúÄÂêé‰∏ÄÂ±ÇÂÖ®ËøûÊé•Â±ÇÁöÑËæìÂá∫‰Ωú‰∏∫ÂàÜÁ±ªÁöÑÈ¢ÑÊµã</li>
<li>ÊàêÂäüËØÅÊòé‰∫ÜÂ¢ûÂä†ÁΩëÁªúÁöÑÊ∑±Â∫¶ÔºåÂèØ‰ª•Êõ¥Â•ΩÁöÑÂ≠¶‰π†ÂõæÂÉè‰∏≠ÁöÑÁâπÂæÅÊ®°Âºè</li>
</ul>
<div align=center><img src="./VGG_Net.png" alt="VGG" /></div>
<p>VGG16 ÁΩëÁªúÁöÑÂÖ∑‰ΩìÁªìÊûÑ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Model</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span><span class="n">Activation</span><span class="p">,</span><span class="n">Dropout</span><span class="p">,</span><span class="n">Reshape</span><span class="p">,</span><span class="n">Conv2D</span><span class="p">,</span><span class="n">MaxPooling2D</span><span class="p">,</span><span class="n">Dense</span><span class="p">,</span><span class="n">Flatten</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">VGG16</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">img_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Block 1</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (224, 224, 3) --&gt; (112, 112, 64)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block1_conv1&#39;</span><span class="p">)(</span><span class="n">img_input</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block1_conv2&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">MaxPooling2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block1_pool&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Block 2</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (112, 112, 64) --&gt; (56, 56, 128)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block2_conv1&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block2_conv2&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">MaxPooling2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block2_pool&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Block 3</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (56, 56, 128) --&gt; (28, 28, 256)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block3_conv1&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block3_conv2&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block3_conv3&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">MaxPooling2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block3_pool&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Block 4</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (28, 28, 256) --&gt; (14, 14, 512)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block4_conv1&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block4_conv2&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block4_conv3&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">MaxPooling2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block4_pool&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Block 5</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (14, 14, 512) --&gt; (7, 7, 512)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block5_conv1&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block5_conv2&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block5_conv3&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">MaxPooling2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;block5_pool&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂØπÁªìÊûúËøõË°åÂπ≥Èì∫</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;flatten&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ‰∏§Ê¨°Á•ûÁªèÂÖÉ‰∏∫4096ÁöÑÂÖ®ËøûÊé•Â±Ç</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">4096</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;fc1&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">4096</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;fc2&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂÜçÂÖ®ËøûÊé•Âà∞1000Áª¥ÔºåÁî®‰ª•ÂàÜÁ±ª‰ªªÂä°</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;predictions&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">inputs</span> <span class="o">=</span> <span class="n">img_input</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;vgg16&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">model</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">VGG16</span><span class="p">(</span><span class="n">intput_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ssdÊ®°Âûã2016">SSDÊ®°ÂûãÔºà2016Ôºâ</h3>
<p>SSDÊòØÂü∫‰∫é‰∏Ä‰∏™ÂâçÂêë‰º†Êí≠ÂèçÈ¶àÁöÑCNNÁΩëÁªúÔºåÂ±û‰∫éone-stageÁ±ªÂûã„ÄÇ</p>
<ul>
<li>ÂØπÂ§öÂ∞∫Â∫¶ÁâπÂæÅÂõæËøõË°åÊ£ÄÊµã</li>
<li>ËÆæÁΩÆ‰∏çÂêåÈïøÂÆΩÊØîÁöÑÂÖàÈ™åÊ°Ü</li>
</ul>
<div align=center><img src="./SSD_structure.webp" alt="SSD" /></div>
<p>Âü∫Êú¨ÁöÑSSDÊ®°ÂûãÊòØÂú®VGGÁΩëÁªúÊ®°ÂûãÁöÑÂü∫Á°Ä‰∏äÊûÑÂª∫ÁöÑÔºåÈÄöËøáËûçÂêà‰∏çÂêåÂç∑ÁßØÂ±ÇÁöÑÁâπÂæÅÂõæÊù•Â¢ûÂº∫ÁΩëÁªúÂØπÁâπÂæÅÁöÑË°®ËææËÉΩÂäõÔºåÈááÁî®<strong>Â§öÂ∞∫Â∫¶Âç∑ÁßØÊ£ÄÊµã</strong>ÁöÑÊñπÊ≥ïÊù•ËøõË°åÁõÆÊ†áÊ£ÄÊµãÂÖ∂ÁªìÊûÑÂ¶ÇÂõæÊâÄÁ§∫Ôºö</p>
<p>ËØ•Ê®°ÂûãÂü∫‰∫éVGGÊ®°Âûã(ÊîπËøõÁâà)Êù•ÊèêÂèñÁâπÂæÅÔºåÂ∞ÜÂêÑÁ∫ßÁöÑÂç∑ÁßØÁâπÂæÅÂõæ‰Ωú‰∏∫ËØ•‰∏ÄÁ∫ßÁöÑÁâπÂæÅË°®Á§∫Ôºå‰∏çÂêåÂç∑ÁßØÁ∫ßÂà´ÁöÑÂõæÂÉèÂç∑ÁßØÁâπÂæÅÊèèËø∞‰∫Ü‰∏çÂêåÁöÑËØ≠‰πâÔºåÂç∑ÁßØÂ±ÇË∂äÊ∑±Ë°®ËææÁöÑÂõæÂÉèÁâπÂæÅ‰ø°ÊÅØÁ∫ßÂà´Ë∂äÈ´ò„ÄÇSSDÊ®°Âûã‰∏≠<strong>ÁâπÂæÅÁöÑÊèêÂèñÈááÁî®ÁöÑÊòØÈÄêÂ±ÇÊèêÂèñÂπ∂ÊäΩË±°ÂåñÁöÑÊÄùÊÉ≥Ôºå‰ΩéÂ±ÇÁöÑÁâπÂæÅ‰∏ªË¶ÅÂØπÂ∫î‰∫éÂç†ÊØîËæÉÂ∞èÁöÑÁõÆÊ†áÔºåÈ´òÂ±ÇÁöÑÁâπÂæÅ‰∏ªË¶ÅÂØπÂ∫î‰∫éÂç†ÊØîËæÉÂ§ßÁöÑÁõÆÊ†áÁöÑÊäΩË±°ÂåñÁöÑ‰ø°ÊÅØ„ÄÇ</strong> Âü∫Êú¨ÁöÑSSDÊ®°ÂûãÈÄöËøá<strong>ÈáëÂ≠óÂ°îÁâπÂæÅÂ±Ç</strong>ËøõË°åÁâπÂæÅÊèêÂèñÔºå‰∏îÂêÑÁâπÂæÅÂ±Ç‰πãÈó¥Áõ∏‰∫íÁã¨Á´ãÔºåÊ≤°ÊúâÁõÆÊ†á‰ø°ÊÅØÁöÑÁõ∏‰∫íË°•ÂÖÖÔºå‰ΩéÁâπÂæÅÂ±Ç‰ªÖÊúâConv4_3Â±ÇÁî®‰∫éÊ£ÄÊµãÂç†ÊØîÂ∞èÁöÑÁõÆÊ†áÂõ†ËÄåÂú®Áº∫‰πèÂÖÖË∂≥ÁöÑÁâπÂæÅ‰ø°ÊÅØÁöÑÊÉÖÂÜµ‰∏ãÂ≠òÂú®ÁâπÂæÅÊèêÂèñ‰∏çÂÖÖÂàÜÁöÑÈóÆÈ¢òÔºåÂõ†ËÄåÂØºËá¥<strong>ÂØπÂ∞èÂûãÁõÆÊ†áÁöÑËØÜÂà´ÊïàÊûú‰∏ÄËà¨</strong>„ÄÇ</p>
<div align=center><img src="./SSD_Net.jpg" alt="SSD" /></div>
<p>SSD ÁΩëÁªúÁöÑÂÖ∑‰ΩìÁªìÊûÑÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">keras.backend</span> <span class="k">as</span> <span class="nn">K</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.engine.topology</span> <span class="kn">import</span> <span class="n">InputSpec</span><span class="p">,</span> <span class="n">Layer</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="p">(</span><span class="n">Activation</span><span class="p">,</span> <span class="n">Concatenate</span><span class="p">,</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Reshape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Model</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">vgg</span> <span class="kn">import</span> <span class="n">VGG16</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Normalize</span><span class="p">(</span><span class="n">Layer</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">(</span><span class="n">Normalize</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="p">[</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">input_shape</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">],)</span>
</span></span><span class="line"><span class="cl">        <span class="n">init_gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="n">init_gamma</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_gamma&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">trainable_weights</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">output</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">l2_normalize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">output</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">output</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">SSD300</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">21</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ------ ËæìÂÖ•Â∞∫ÂØ∏(300, 300, 3) ------ #</span>
</span></span><span class="line"><span class="cl">    <span class="n">input_tensor</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">net</span> <span class="o">=</span> <span class="n">VGG16</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ------- ÂØπ‰∏ªÂπ≤ÁΩëÁªúÊèêÂèñÂà∞ÁöÑÊúâÊïàÁâπÂæÅËøõË°åÂ§ÑÁêÜ ------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂØπconv4_3ÁöÑÈÄöÈÅìËøõË°ål2Ê†áÂáÜÂåñÂ§ÑÁêÜ </span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (38, 38, 512)</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv4_3_norm&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_anchors</span> <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂØπÈ¢ÑÊµãÊ°ÜÁöÑÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># num_anchorsË°®Á§∫ÊØè‰∏™ÁΩëÊ†ºÁÇπÂÖàÈ™åÊ°ÜÁöÑÊï∞Èáè</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 4 ÊòØx,y(Ê°Ü‰∏≠ÂøÉÂÅèÁßª),h,w(Ê°ÜÁöÑÈ´òÂíåÂÆΩ)ÁöÑË∞ÉÊï¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3_norm_mbox_loc&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv4_3_norm_mbox_loc&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3_norm&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3_norm_mbox_loc_flat&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv4_3_norm_mbox_loc_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3_norm_mbox_loc&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># num_classesÊòØÊâÄÂàÜÁöÑÁ±ª</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3_norm_mbox_conf&#39;</span><span class="p">]</span>       <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv4_3_norm_mbox_conf&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3_norm&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3_norm_mbox_conf_flat&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv4_3_norm_mbox_conf_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3_norm_mbox_conf&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂØπfc7Â±ÇËøõË°åÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (19, 19, 1024)</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_anchors</span> <span class="o">=</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># È¢ÑÊµãÊ°ÜÁöÑÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 4 ÊòØx,y,h,wÁöÑË∞ÉÊï¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;fc7_mbox_loc&#39;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;fc7_mbox_loc&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;fc7&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;fc7_mbox_loc_flat&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;fc7_mbox_loc_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;fc7_mbox_loc&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># num_classesÊòØÊâÄÂàÜÁöÑÁ±ª</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;fc7_mbox_conf&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;fc7_mbox_conf&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;fc7&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;fc7_mbox_conf_flat&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;fc7_mbox_conf_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;fc7_mbox_conf&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂØπconv6_2ËøõË°åÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (10, 10, 512)</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_anchors</span> <span class="o">=</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># È¢ÑÊµãÊ°ÜÁöÑÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 4 ÊòØx,y,h,wÁöÑË∞ÉÊï¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv6_2_mbox_loc&#39;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv6_2_mbox_loc&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv6_2&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv6_2_mbox_loc_flat&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv6_2_mbox_loc_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv6_2_mbox_loc&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># num_classesÊòØÊâÄÂàÜÁöÑÁ±ª</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv6_2_mbox_conf&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv6_2_mbox_conf&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv6_2&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv6_2_mbox_conf_flat&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv6_2_mbox_conf_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv6_2_mbox_conf&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂØπconv7_2ËøõË°åÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (5, 5, 256)</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_anchors</span> <span class="o">=</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># È¢ÑÊµãÊ°ÜÁöÑÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 4 ÊòØx,y,h,wÁöÑË∞ÉÊï¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv7_2_mbox_loc&#39;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv7_2_mbox_loc&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv7_2&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv7_2_mbox_loc_flat&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv7_2_mbox_loc_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv7_2_mbox_loc&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># num_classesÊòØÊâÄÂàÜÁöÑÁ±ª</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv7_2_mbox_conf&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv7_2_mbox_conf&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv7_2&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv7_2_mbox_conf_flat&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv7_2_mbox_conf_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv7_2_mbox_conf&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂØπconv8_2ËøõË°åÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (3, 3, 256)</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_anchors</span> <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># È¢ÑÊµãÊ°ÜÁöÑÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 4ÊòØx,y,h,wÁöÑË∞ÉÊï¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv8_2_mbox_loc&#39;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv8_2_mbox_loc&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv8_2&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv8_2_mbox_loc_flat&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv8_2_mbox_loc_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv8_2_mbox_loc&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># num_classesÊòØÊâÄÂàÜÁöÑÁ±ª</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv8_2_mbox_conf&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv8_2_mbox_conf&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv8_2&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv8_2_mbox_conf_flat&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv8_2_mbox_conf_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv8_2_mbox_conf&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂØπconv9_2ËøõË°åÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (1, 1, 256)</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_anchors</span> <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># È¢ÑÊµãÊ°ÜÁöÑÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 4ÊòØx,y,h,wÁöÑË∞ÉÊï¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv9_2_mbox_loc&#39;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv9_2_mbox_loc&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv9_2&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv9_2_mbox_loc_flat&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv9_2_mbox_loc_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv9_2_mbox_loc&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># num_classesÊòØÊâÄÂàÜÁöÑÁ±ª</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv9_2_mbox_conf&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">num_anchors</span> <span class="o">*</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv9_2_mbox_conf&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv9_2&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv9_2_mbox_conf_flat&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv9_2_mbox_conf_flat&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv9_2_mbox_conf&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ------- Â∞ÜÊâÄÊúâÁªìÊûúËøõË°åÂ†ÜÂè† ------- #</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;mbox_loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Concatenate</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mbox_loc&#39;</span><span class="p">)([</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3_norm_mbox_loc_flat&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                                            <span class="n">net</span><span class="p">[</span><span class="s1">&#39;fc7_mbox_loc_flat&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                                            <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv6_2_mbox_loc_flat&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                                            <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv7_2_mbox_loc_flat&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                                            <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv8_2_mbox_loc_flat&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                                            <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv9_2_mbox_loc_flat&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">                                    
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;mbox_conf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Concatenate</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mbox_conf&#39;</span><span class="p">)([</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv4_3_norm_mbox_conf_flat&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                                            <span class="n">net</span><span class="p">[</span><span class="s1">&#39;fc7_mbox_conf_flat&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                                            <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv6_2_mbox_conf_flat&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                                            <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv7_2_mbox_conf_flat&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                                            <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv8_2_mbox_conf_flat&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                                            <span class="n">net</span><span class="p">[</span><span class="s1">&#39;conv9_2_mbox_conf_flat&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (8732, 4)</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;mbox_loc&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="n">Reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mbox_loc_final&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;mbox_loc&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (8732, 21)</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;mbox_conf&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">Reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mbox_conf_logits&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;mbox_conf&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;mbox_conf&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;softmax&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mbox_conf_final&#39;</span><span class="p">)(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;mbox_conf&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (8732, 25)</span>
</span></span><span class="line"><span class="cl">    <span class="n">net</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">Concatenate</span><span class="p">(</span><span class="n">axis</span> <span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;predictions&#39;</span><span class="p">)([</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;mbox_loc&#39;</span><span class="p">],</span> <span class="n">net</span><span class="p">[</span><span class="s1">&#39;mbox_conf&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">net</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">],</span> <span class="n">net</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">model</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊÄªÁªìËÄåË®ÄÔºåSSDÊòØÊää‰∏ÄÂº†ÂõæÁâáÂàíÂàÜ‰∏∫‰∏çÂêåÁöÑÁΩëÊ†ºÔºåÂΩìÊüê‰∏ÄÁâ©‰ΩìÁöÑ‰∏≠ÂøÉÁÇπËêΩÂú®Ëøô‰∏™Âå∫ÂüüÔºåËøô‰∏™Áâ©‰ΩìÂ∞±Áî±Ëøô‰∏™ÁΩëÊ†ºÊù•Á°ÆÂÆö„ÄÇ</p>
<h3 id="mobilenet2017">MobileNetÔºà2017Ôºâ</h3>
<h4 id="mobilenetv1">MobileNetV1</h4>
<div align=center><img src="./MobileNetV1.png" alt="ÁΩëÁªúÁªìÊûÑ" /></div>
<ol>
<li>Deptwise Convolution(<strong>Ê∑±Â∫¶ÂèØÂàÜÁ¶ªÂç∑ÁßØ</strong>)(Â§ßÂ§ßÂáèÂ∞ëËøêÁÆóÈáèÂíåÂèÇÊï∞Êï∞Èáè)</li>
</ol>
<p>Ê†áÂáÜÁöÑÂç∑ÁßØÁΩëÁªúÁªìÊûÑÔºö</p>
<div align=center><img src="./mobilenetv1_1.png" alt="CNN" /></div>
<p>Ê∑±Â∫¶ÂèØÂàÜÁ¶ªÂç∑ÁßØÁΩëÁªúÁªìÊûÑÔºö</p>
<div align=center><img src="./mobilenetv1_2.png" alt="Ê∑±Â∫¶ÂèØÂàÜÁ¶ªÂç∑ÁßØ" /></div>
<p>ÂΩìËæìÂÖ•ÁâπÂæÅÂõæÁöÑ <em>shape</em> ÊòØ$D_F \times D_F \times M$ÔºåÂÖ∂‰∏≠ $M$ ‰∏∫ÈÄöÈÅìÊï∞ÔºåËæìÂá∫ÁâπÂæÅÂõæÁöÑ <em>shape</em> ‰∏∫$D_G \times D_G \times N$ÔºåÈÄöÈÅìÊï∞‰∏∫ $N$ ÔºåÊ†áÂáÜÂç∑ÁßØÊ†∏ÁöÑÂ∞∫ÂØ∏‰∏∫$D_k \times D_k \times M$Êó∂ÔºåÂç∑ÁßØÊ†∏ÁöÑÂèÇ‰∏é‰∏™Êï∞‰∏∫ $D_k \cdot D_k \cdot M \cdot N$ „ÄÇÊ∑±Â∫¶ÂèØÂàÜÁ¶ªÂç∑ÁßØ‰∏ÄÂÖ±ÂàÜ‰∏∫‰∏§‰∏™Ê≠•È™§ÁöÑÂç∑ÁßØÔºåÂÖ∂‰∏≠ <em>Depthwise Convolution</em> ÁöÑÂç∑ÁßØÊ†∏‰∏∫$D_k \times D_k \times 1$Ôºå <em>Pointwise Convolution</em> ÁöÑÂç∑ÁßØÊ†∏‰∏∫$1 \times 1 \times M$„ÄÇÈÇ£‰πàÂèØ‰ª•ÂæóÂá∫Â¶Ç‰∏ãÁªìËÆ∫Ôºö</p>
<p>Ê†áÂáÜÂç∑ÁßØÁöÑËøêÁÆóÈáèÔºö
$$
D_k \cdot D_k \cdot M \cdot N \cdot D_F \cdot D_F = D_F \cdot D_F \cdot M \cdot (D^2_K \cdot N)
$$
Ê∑±Â∫¶ÂèØÂàÜÁ¶ªÂç∑ÁßØÁöÑËøêÁÆóÈáèÔºö
$$
D_k \cdot D_k \cdot M \cdot D_F \cdot D_F + M \cdot N \cdot D_F \cdot D_F = D_F \cdot D_F \cdot M \cdot (D^2_K + N)
$$
ËøêÁÆóÈáèÂØπÊØîÔºö
$$
\frac {D_F \cdot D_F \cdot M \cdot (D^2_K + N)} {D_F \cdot D_F \cdot M \cdot (D^2_k \cdot N)} = \frac {1} {N} + \frac {1} {D^2_K}
$$</p>
<p>Ê∑±Â∫¶ÂèØÂàÜÁ¶ªÂç∑ÁßØÁöÑtensorflow‰ª£Á†ÅÂÆûÁé∞Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">layers</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">backend</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">DepthwiseConv2DÁöÑÂéüÂáΩÊï∞ÂÆö‰πâ:
</span></span></span><span class="line"><span class="cl"><span class="s2">tf.keras.layers.DepthwiseConv2D(
</span></span></span><span class="line"><span class="cl"><span class="s2">    kernel_size,
</span></span></span><span class="line"><span class="cl"><span class="s2">    strides=(1, 1),
</span></span></span><span class="line"><span class="cl"><span class="s2">    padding=&#34;valid&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    depth_multiplier=1,
</span></span></span><span class="line"><span class="cl"><span class="s2">    data_format=None,
</span></span></span><span class="line"><span class="cl"><span class="s2">    dilation_rate=(1, 1),   # ËÜ®ËÉÄÁéá
</span></span></span><span class="line"><span class="cl"><span class="s2">    activation=None,
</span></span></span><span class="line"><span class="cl"><span class="s2">    use_bias=True,  # ÊòØÂê¶‰ΩøÁî®ÂÅèÁΩÆÂêëÈáè
</span></span></span><span class="line"><span class="cl"><span class="s2">    depthwise_initializer=&#34;glorot_uniform&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    bias_initializer=&#34;zeros&#34;,   # ÂÅèÁΩÆÂêëÈáèÁöÑÂàùÂßãÂÄº
</span></span></span><span class="line"><span class="cl"><span class="s2">    depthwise_regularizer=None,
</span></span></span><span class="line"><span class="cl"><span class="s2">    bias_regularizer=None,
</span></span></span><span class="line"><span class="cl"><span class="s2">    activity_regularizer=None,
</span></span></span><span class="line"><span class="cl"><span class="s2">    depthwise_constraint=None,
</span></span></span><span class="line"><span class="cl"><span class="s2">    bias_constraint=None,
</span></span></span><span class="line"><span class="cl"><span class="s2">    **kwargs
</span></span></span><span class="line"><span class="cl"><span class="s2">)
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">_depthwise_conv_block</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">inputs</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">pointwise_conv_filters</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">alpha</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">depth_multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">block_id</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ÈÄöÈÅìÁöÑÂ§ÑÁêÜchannel&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">channel_axis</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">backend</span><span class="o">.</span><span class="n">image_data_format</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;channels_first&#34;</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;alphaË∂ÖÂèÇÊï∞&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">pointwise_conv_filters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pointwise_conv_filters</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Ê≠•ÈïøÁöÑÂ§ÑÁêÜpadding&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">strides</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">ZeroPadding2D</span><span class="p">(((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_pad_</span><span class="si">%d</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">block_id</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ÈÄêÈÄöÈÅìÂç∑ÁßØ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">DepthwiseConv2D</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span> <span class="k">if</span> <span class="n">strides</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&#34;valid&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">depth_multiplier</span><span class="o">=</span><span class="n">depth_multiplier</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_dw_</span><span class="si">%d</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">block_id</span>
</span></span><span class="line"><span class="cl">            <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_dw_</span><span class="si">%d</span><span class="s2">_bn&#34;</span> <span class="o">%</span> <span class="n">block_id</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_dw_</span><span class="si">%d</span><span class="s2">_relu&#34;</span> <span class="o">%</span> <span class="n">block_id</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ÈÄêÁÇπÂç∑ÁßØ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">pointwise_conv_filters</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_pw_</span><span class="si">%d</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">block_id</span>
</span></span><span class="line"><span class="cl">            <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Batch NormalizationÊòØ2015Âπ¥‰∏ÄÁØáËÆ∫Êñá‰∏≠ÊèêÂá∫ÁöÑÊï∞ÊçÆÂΩí‰∏ÄÂåñÊñπÊ≥ïÔºåÂæÄÂæÄÁî®Âú®Ê∑±Â∫¶Á•ûÁªèÁΩëÁªú‰∏≠ÊøÄÊ¥ªÂ±Ç‰πãÂâç„ÄÇ
</span></span></span><span class="line"><span class="cl"><span class="s2">    ÂÖ∂‰ΩúÁî®ÂèØ‰ª•Âä†Âø´Ê®°ÂûãËÆ≠ÁªÉÊó∂ÁöÑÊî∂ÊïõÈÄüÂ∫¶Ôºå‰ΩøÂæóÊ®°ÂûãËÆ≠ÁªÉËøáÁ®ãÊõ¥Âä†Á®≥ÂÆöÔºåÈÅøÂÖçÊ¢ØÂ∫¶ÁàÜÁÇ∏ÊàñËÄÖÊ¢ØÂ∫¶Ê∂àÂ§±„ÄÇÂπ∂‰∏îËµ∑Âà∞‰∏ÄÂÆöÁöÑÊ≠£ÂàôÂåñ‰ΩúÁî®ÔºåÂá†‰πé‰ª£Êõø‰∫ÜDropout„ÄÇ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_pw_</span><span class="si">%d</span><span class="s2">_bn&#34;</span> <span class="o">%</span> <span class="n">block_id</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_pw_</span><span class="si">%d</span><span class="s2">_relu&#34;</span> <span class="o">%</span> <span class="n">block_id</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>&ldquo;Conv2D Âíå Depthwise_conv2DÁöÑÂå∫Âà´&rdquo;</p>
<ul>
<li>
<p>Conv2dÂú®ÊØè‰∏™ÈÄöÈÅì‰∏äÂç∑ÁßØÔºåÁÑ∂ÂêéÊ±ÇÂíåÔºåDepthwise_conv2DÂç∑ÁßØÔºå‰∏çÊ±ÇÂíå„ÄÇ</p>
</li>
<li>
<p>Depthwise_conv2DÁöÑËæìÂá∫Áª¥Â∫¶ÂíåËæìÂÖ•Áª¥Â∫¶ÂßãÁªàÊòØ‰∏ÄËá¥ÁöÑ„ÄÇ</p>
</li>
</ul>
<div class="table-wrapper"><table>
<thead>
<tr>
<th></th>
<th>Ê†áÂáÜÂç∑ÁßØ</th>
<th>Ê∑±Â∫¶ÂèØÂàÜÁ¶ªÂç∑ÁßØ</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ËøêÁÆóÁâπÁÇπ</strong></td>
<td>ÊØè‰∏™Âç∑ÁßØÊ†∏ÁöÑÈÄöÈÅì‰∏éËæìÂÖ•ÈÄöÈÅìÁõ∏ÂêåÔºåÊØè‰∏™ÈÄöÈÅìÂçïÁã¨ÂÅöÂç∑ÁßØËøêÁÆóÁÑ∂ÂêéÁõ∏Âä†</td>
<td>DWÂç∑ÁßØÔºö‰∏Ä‰∏™Âç∑ÁßØÊ†∏Âè™Êúâ‰∏Ä‰∏™ÈÄöÈÅìÔºåÂçïÁã¨Ë¥üË¥£‰∏Ä‰∏™ÈÄöÈÅì<br>PWÂç∑ÁßØÔºöÂ∞Ü‰∏ä‰∏ÄÊ≠•ÁöÑÁâπÂæÅÂõæÂú®ÈÄöÈÅìÊñπÂêë‰∏äËøõË°åÊâ©Â±ï</td>
</tr>
</tbody>
</table></div>
</li>
</ul>
<ol start="2">
<li><strong>Ë∂ÖÂèÇÊï∞</strong> $\alpha$ $\rho$</li>
</ol>
<ul>
<li>$\alpha$ ÂÆΩÂ∫¶Á≥ªÊï∞ÔºåÂØπÁΩëÁªú‰∏≠ÊØè‰∏ÄÂ±ÇÂç∑ÁßØÁöÑÈÄöÈÅìÊï∞‰πò‰ª• $\alpha$ ÂèñÂÄºËåÉÂõ¥[0,1]ÔºåÊØîËæÉÂÖ∏ÂûãÁöÑÂÄº‰∏∫1„ÄÅ0.75„ÄÅ0.5„ÄÅ0.35</li>
</ul>
<p>$$
ËÆ°ÁÆóÈáè: \qquad D_k \cdot D_k \cdot \alpha M \cdot D_F \cdot D_F + \alpha M \cdot \alpha N \cdot D_F \cdot D_F
$$</p>
<ul>
<li>$\rho$ ÂàÜËæ®ÁéáÁ≥ªÊï∞ÔºåÂè™ÊîπÂèòÁΩëÁªúÁöÑËÆ°ÁÆóÈáèËÄå‰∏çÂΩ±ÂìçÁΩëÁªúÁöÑÂèÇÊï∞Èáè</li>
</ul>
<p>$$
ËÆ°ÁÆóÈáè: \qquad D_k \cdot D_k \cdot \alpha M \cdot \rho D_F \cdot \rho D_F + \alpha M \cdot \alpha N \cdot \rho D_F \cdot \rho D_F
$$</p>
<blockquote>
<p>DepthWiseÈÉ®ÂàÜÁöÑÂç∑ÁßØÊ†∏ÂÆπÊòìÂ∫üÊéâÔºåÂç≥Âç∑ÁßØÊ†∏ÂèÇÊï∞Â§ßÈÉ®ÂàÜ‰∏∫Èõ∂„ÄÇÔºàÂæàÈáçË¶ÅÁöÑ‰∏Ä‰∏™ÂéüÂõ†ÊòØÂõ†‰∏∫ <em>ReLU</em> ÊøÄÊ¥ªÂáΩÊï∞ÂØπ0ÂÄºÁöÑÊ¢ØÂ∫¶ÊòØ0ÔºåÂêéÁª≠Êó†ËÆ∫ÊÄé‰πàËø≠‰ª£Ëøô‰∏™ËäÇÁÇπÈÉΩ‰∏ç‰ºöÊÅ¢Â§çÔºåÂç≥‚ÄúÂ∫üÊéâ‰∫Ü‚ÄùÔºâ</p>
</blockquote>
<ul>
<li>
<p>&ldquo;‰Ω†Áü•ÈÅìÂêóÔºü&rdquo;</p>
<p><strong>Ê∑±Â∫¶ÂèØÂàÜÁ¶ªÂç∑ÁßØÂ∞Ü‰∏Ä‰∏™Ê†áÂáÜÂç∑ÁßØÂàÜÂâ≤Êàê‰∫Ü‰∏§‰∏™Âç∑ÁßØÔºàÈÄêÊ∑±Â∫¶ÔºåÈÄêÁÇπÔºâÔºåÂõ†Ê≠§ÂáèÂ∞è‰∫ÜÂèÇÊï∞ÈáèÔºåÂØπÂ∫î‰πüÂáèÂ∞è‰∫ÜÊÄªËÆ°ÁÆóÈáè„ÄÇ</strong> Ê∑±Â∫¶ÂèØÂàÜÁ¶ªÂç∑ÁßØÊÄªËÆ°ÁÆóÈáèÂèòÂ∞è‰∫ÜÔºå‰ΩÜÊòØÊ∑±Â∫¶ÂèØÂàÜÁ¶ªÂç∑ÁßØÁöÑ<strong>Â±ÇÊï∞ÂèòÂ§ö‰∫Ü</strong>„ÄÇ</p>
<p>GPUÊòØÂπ∂Ë°åÂ§ÑÁêÜÂ§ßËßÑÊ®°Êï∞ÊçÆ(Áü©ÈòµÂÜÖÁßØ)ËøêÁÆóÁöÑÂπ≥Âè∞ÔºåËÄåCPUÂàôÊõ¥ÂÄæÂêë‰∫éÂØπÊï∞ÊçÆ‰∏≤Ë°åËÆ°ÁÆó„ÄÇ</p>
<p>Âõ†Ê≠§ÂΩ±ÂìçGPUÊÄªËøêÁÆóÊó∂Èó¥ÁöÑ‰∏ªÂØºÂõ†Á¥†‰∏ÄËà¨ÊòØ<strong>ÁΩëÁªúÁöÑÂ±ÇÊï∞</strong>„ÄÇ</p>
<p>ËÄåÂΩ±ÂìçCPUÊÄªËøêÁÆóÊó∂Èó¥ÁöÑ‰∏ªÂØºÂõ†Á¥†ÊòØ<strong>ÊÄªËÆ°ÁÆóÈáè</strong>„ÄÇ</p>
<p>ÊâÄ‰ª•Êâç‰ºöÂá∫Áé∞MobileNetÂú®Êüê‰∫õËÆ°ÁÆóËÉΩÂäõÊúâÈôêÁöÑCPUÂπ≥Âè∞‰∏äÈÄüÂ∫¶Á´üÁÑ∂È´ò‰∫éÊüê‰∫õGPUÂπ≥Âè∞‰∏äÁöÑÈÄüÂ∫¶„ÄÇ</p>
</li>
</ul>
<p>MobileNetÁöÑtensorflow‰ª£Á†ÅÂÆûÁé∞Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">backend</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">layers</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Model</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.applications</span> <span class="kn">import</span> <span class="n">imagenet_utils</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.applications.efficientnet</span> <span class="kn">import</span> <span class="n">block</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">MobileNet</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">img_input</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (224, 224, 3)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_conv_block</span><span class="p">(</span><span class="n">img_input</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (112, 112, 32)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (112, 112, 64)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (56, 56, 64)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (56, 56 ,128)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (28, 28, 256)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (28, 28, 256)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (14, 14, 512)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># (14, 14, 512)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># (7, 7, 1024)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_depthwise_conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">depth_multiplier</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># (7, 7, 1024)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">GlobalAveragePooling2D</span><span class="p">(</span><span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;drpout&#34;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_preds&#34;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Reshape</span><span class="p">((</span><span class="n">classes</span><span class="p">,),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;reshape_2&#34;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&#34;softmax&#34;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;predictions&#34;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">img_input</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;mobilenet&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">model</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">_conv_block</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">filters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filters</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">filters</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">kernel</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv1&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv1_bn&#34;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv1_relu&#34;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">_depthwise_conv_block</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">inputs</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">pointwise_conv_filters</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">alpha</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">depth_multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">block_id</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ÈÄöÈÅìÁöÑÂ§ÑÁêÜchannel&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">channel_axis</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">backend</span><span class="o">.</span><span class="n">image_data_format</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;channels_first&#34;</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;alphaË∂ÖÂèÇÊï∞&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">pointwise_conv_filters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pointwise_conv_filters</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Ê≠•ÈïøÁöÑÂ§ÑÁêÜpadding&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">strides</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">ZeroPadding2D</span><span class="p">(((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_pad_</span><span class="si">%d</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">block_id</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ÈÄêÈÄöÈÅìÂç∑ÁßØÔºàÂ§ÑÁêÜÈïøÂÆΩÊñπÂêëÁöÑ‰ø°ÊÅØÔºâ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">DepthwiseConv2D</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span> <span class="k">if</span> <span class="n">strides</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&#34;valid&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">depth_multiplier</span><span class="o">=</span><span class="n">depth_multiplier</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_dw_</span><span class="si">%d</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">block_id</span>
</span></span><span class="line"><span class="cl">            <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_dw_</span><span class="si">%d</span><span class="s2">_bn&#34;</span> <span class="o">%</span> <span class="n">block_id</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_dw_</span><span class="si">%d</span><span class="s2">_relu&#34;</span> <span class="o">%</span> <span class="n">block_id</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ÈÄêÁÇπÂç∑ÁßØÔºàÂ§ÑÁêÜË∑®ÈÄöÈÅìÊñπÂêëÁöÑ‰ø°ÊÅØÔºâ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">pointwise_conv_filters</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_pw_</span><span class="si">%d</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">block_id</span>
</span></span><span class="line"><span class="cl">            <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_pw_</span><span class="si">%d</span><span class="s2">_bn&#34;</span> <span class="o">%</span> <span class="n">block_id</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;conv_pw_</span><span class="si">%d</span><span class="s2">_relu&#34;</span> <span class="o">%</span> <span class="n">block_id</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">MobileNet</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="mobilenet-v2">MobileNet v2</h4>
<div align=center><img src="./MobileNetV2.png" alt="ÁΩëÁªúÁªìÊûÑ" /></div>
<ol>
<li>
<p>Inverted Residuals(<strong>ÂÄíÊÆãÂ∑ÆÁªìÊûÑ</strong>)</p>
<p>ÂÄíÊÆãÂ∑ÆÁªìÊûÑÊòØ‰ªé<strong>ResNet</strong>‰∏≠ÁöÑÊÆãÂ∑ÆÁªìÊûÑËÄåÊù•ÁöÑ„ÄÇResNet‰∏≠ResidualsÁªìÊûÑ‰∏≠ÔºåÂÖàÁî®1x1ÁöÑÂç∑ÁßØÂÆûÁé∞‰∫ÜÈôçÁª¥ÔºåÁÑ∂ÂêéÈÄöËøá3x3Âç∑ÁßØÔºåÊúÄÂêéÈÄöËøá1x1Âç∑ÁßØÂÆûÁé∞ÂçáÁª¥ÔºåÂç≥<strong>‰∏§Â§¥Â§ß‰∏≠Èó¥Â∞è</strong>„ÄÇ</p>
<p>ËÄåÂú®<strong>MobileNetV2</strong>‰∏≠ÔºåÂÖàÁî®1x1ÁöÑÂç∑ÁßØÂçáÁª¥ÔºåÁÑ∂ÂêéÂ∞Ü3x3Âç∑ÁßØÊç¢‰∏∫3x3DWÂç∑ÁßØÔºåÂÜçÁî®1x1ÁöÑÂç∑ÁßØÂÆûÁé∞ÈôçÁª¥ÔºåÂç≥<strong>‰∏§Â§¥Â∞è‰∏≠Èó¥Â§ß</strong>„ÄÇ</p>
<p>MobileNetV2ÁöÑÂÄíÊÆãÂ∑ÆÁªìÊûÑÁ§∫ÊÑèÂõæÔºö</p>
</li>
</ol>
<div align=center>
<div class="mermaid">
  
   stateDiagram
   Direction LR
   [*] --> Conv1x1,ReLU6 :ÂçáÁª¥
   Conv1x1,ReLU6 --> Dwise3x3,ReLU6
   Dwise3x3,ReLU6 --> conv1x1,Linear 
   conv1x1,Linear --> Add :ÈôçÁª¥ÔºåÁ∫øÊÄßÊøÄÊ¥ª
   [*] --> Add :ÊÆãÂ∑ÆËøûÊé•
   Add --> [*]

</div>

</div>
<p><strong>ReLU6</strong>ÊøÄÊ¥ªÂáΩÊï∞:
$$
y = ReLU6(x) = min(max(x, 0), 6)
$$</p>
<ol start="2">
<li>
<p>Linear Bottlenecks(Á∫øÊÄßÁì∂È¢àÂ±Ç)</p>
<p>‰ΩúËÄÖÂèëÁé∞ÂΩì‰ø°ÊÅØ‰ªéÈ´òÁª¥Á©∫Èó¥ÁªèËøáÈùûÁ∫øÊÄßÊò†Â∞ÑÂà∞‰ΩéÁª¥Á©∫Èó¥Êó∂Ôºå‰ºöÂèëÁîü‰ø°ÊÅØÂùçÂ°åÔºåÊâÄ‰ª•Âú®<strong>ÂÄíÊÆãÂ∑ÆÁªìÊûÑËøõË°åÈôçÁª¥Êìç‰ΩúÁöÑÊó∂ÂÄô</strong>Ôºå‰ΩøÁî®‰∫Ü<strong>Á∫øÊÄßÊøÄÊ¥ªÂáΩÊï∞</strong>ÔºàÂÆûÁé∞ÊñπÂºèÂ∞±ÊòØ‰∏ç‰ΩøÁî®ÊøÄÊ¥ªÂáΩÊï∞Ôºâ„ÄÇ</p>
<p>&ldquo;ÊÄùËÄÉ&rdquo;</p>
<p>‰πãÊâÄ‰ª•‰ΩøÁî®ÂÄíÊÆãÂ∑ÆÁªìÊûÑÔºåÂíåÁ∫øÊÄßÁì∂È¢àÂ±ÇÔºåÊòØÂõ†‰∏∫‰ΩúËÄÖÈÄöËøáÊï∞Â≠¶ËØÅÊòéÁöÑÊñπÂºèÔºåÂæóÂá∫‰∫Ü<strong>Âú®ÈôçÁª¥ËøáÂ∫¶Êó∂ÔºåReLU‰ºöÈÄ†ÊàêÂ§ßÈáèÁöÑ‰ø°ÊÅØ‰∏¢Â§±</strong>ÔºåÂç≥<strong>ÂçáÁª¥‰πãÂêéÊõ¥ÂÆπÊòì‰øùÊåÅÂèØÈÄÜ</strong></p>
</li>
</ol>
<p>MobileNetV2ÁöÑtensorflowÂÆûÁé∞Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">backend</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">layers</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Model</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">keras.applications</span> <span class="kn">import</span> <span class="n">imagenet_utils</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">MobileNetV2</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">img_input</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">channel_axis</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">backend</span><span class="o">.</span><span class="n">image_data_format</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;channels_first&#34;</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">first_block_filters</span> <span class="o">=</span> <span class="n">_make_divisible</span><span class="p">(</span><span class="mi">32</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ËæìÂÖ•(224, 224, 3)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">first_block_filters</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Conv1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)(</span><span class="n">img_input</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;bn_Conv1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Conv1_relu&#34;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># (112, 112, 32)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># (112, 112, 16)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># (56, 56, 24)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># (28, 28, 32)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># (14, 14, 64)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">96</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">96</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">96</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># (14, 14, 96)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">160</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">160</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">160</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># (7, 7, 160)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">_inverted_res_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="mi">320</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expansion</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂÆΩÂ∫¶Âõ†Â≠êŒ±</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">last_block_filters</span> <span class="o">=</span> <span class="n">_make_divisible</span><span class="p">(</span><span class="mi">1280</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">last_block_filters</span> <span class="o">=</span> <span class="mi">1280</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># (7, 7, 320)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">last_block_filters</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Conv_1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Conv_1_bn&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;out_relu&#34;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># (7, 7, 1280)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">GlobalAveragePooling2D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">imagenet_utils</span><span class="o">.</span><span class="n">validate_activation</span><span class="p">(</span><span class="s2">&#34;softmax&#34;</span><span class="p">,</span> <span class="s2">&#34;imagenet&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&#34;softmax&#34;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;predictions&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># È¢ÑÊµãÂ±Ç(1, 1, classes)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ËøîÂõûÊ®°ÂûãÂÆû‰æã</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Model</span><span class="p">(</span><span class="n">img_input</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;mobilenetv2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">_inverted_res_block</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">expansion</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">block_id</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ÂÄíÊÆãÂ∑ÆÁªìÊûÑ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">channel_axis</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">backend</span><span class="o">.</span><span class="n">image_data_format</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;channels_first&#34;</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">in_channels</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">int_shape</span><span class="p">(</span><span class="n">inputs</span><span class="p">)[</span><span class="n">channel_axis</span><span class="p">]</span> <span class="c1"># ËøîÂõûÂº†ÈáèÊàñÂèòÈáèÁöÑshapeÔºå‰Ωú‰∏∫intÊàñËÄÖNoneÊù°ÁõÆÁöÑÂÖÉÁªÑ</span>
</span></span><span class="line"><span class="cl">    <span class="n">pointwise_conv_filters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filters</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Á°Æ‰øùÊúÄÂêé‰∏Ä‰∏™1x1Âç∑ÁßØ‰∏äÁöÑÊª§Ê≥¢Âô®‰∏™Êï∞ÂèØ‰ª•Ë¢´8Êï¥Èô§</span>
</span></span><span class="line"><span class="cl">    <span class="n">pointwise_filters</span> <span class="o">=</span> <span class="n">_make_divisible</span><span class="p">(</span><span class="n">pointwise_conv_filters</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>
</span></span><span class="line"><span class="cl">    <span class="n">prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;block_</span><span class="si">{</span><span class="n">block_id</span><span class="si">}</span><span class="s2">_&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">block_id</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ÁÇπÂç∑ÁßØÂçáÁª¥</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">expansion</span> <span class="o">*</span> <span class="n">in_channels</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">name</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&#34;expand&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">momentum</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">name</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&#34;expand_BN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&#34;expand_relu&#34;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&#34;expanded_conv_&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># DwÂç∑ÁßØ</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">stride</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">ZeroPadding2D</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">padding</span><span class="o">=</span><span class="n">imagenet_utils</span><span class="o">.</span><span class="n">correct_pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&#34;pad&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">DepthwiseConv2D</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">strides</span><span class="o">=</span><span class="n">stride</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span> <span class="k">if</span> <span class="n">stride</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&#34;valid&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&#34;depthwise&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">momentum</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&#34;depthwise_BN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&#34;depthwise_relu&#34;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÁÇπÂç∑ÁßØÈôçÁª¥ÔºåÁ∫øÊÄßÊøÄÊ¥ªÂáΩÊï∞ÔºàÂç≥NoneÔºâ</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">pointwise_filters</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&#34;project&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">momentum</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&#34;project_BN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">in_channels</span> <span class="o">==</span> <span class="n">pointwise_filters</span> <span class="ow">and</span> <span class="n">stride</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">layers</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&#34;add&#34;</span><span class="p">)([</span><span class="n">inputs</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">_make_divisible</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">divisor</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">min_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">min_value</span> <span class="o">=</span> <span class="n">divisor</span>
</span></span><span class="line"><span class="cl">    <span class="n">new_v</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_value</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="n">divisor</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="n">divisor</span> <span class="o">*</span> <span class="n">divisor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Á°Æ‰øùÂêë‰∏ãËàçÂÖ•‰∏ç‰ºö‰∏ãÈôçË∂ÖËøá10%</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">new_v</span> <span class="o">&lt;</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">v</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">new_v</span> <span class="o">+=</span> <span class="n">divisor</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">new_v</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">MobileNetV2</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ÂæÖÁª≠Êú™ÂÆå„ÄÇ„ÄÇ„ÄÇ</p>
</blockquote>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E6%9C%BA%E5%99%A8%E8%A7%86%E8%A7%89/">Êú∫Âô®ËßÜËßâ</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            ÊúÄÂêéÊõ¥Êñ∞‰∫é 2024-02-21 12:35 CST
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.staticfile.org/KaTeX/0.16.8/katex.min.css"integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6&#43;HX0sLNAK3q71HotJqlAn"crossorigin="anonymous"
            ><script 
                src="https://cdn.staticfile.org/KaTeX/0.16.8/katex.min.js"integrity="sha384-cpW21h6RZv/phavutF&#43;AuVYrr&#43;dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.staticfile.org/KaTeX/0.16.8/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Áõ∏ÂÖ≥ÊñáÁ´†</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/tensorflow%E5%85%A5%E9%97%A8/">
        
        
            <div class="article-image">
                <img src="/p/tensorflow%E5%85%A5%E9%97%A8/Tensorflow.8a910a1f19ce6f79e1377de657ac4299_hud8524d9562d7473f3449c190ff1a23cc_42729_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post TensorflowÂÖ•Èó®"
                        
                        data-hash="md5-ipEKHxnOb3nhN33mV6xCmQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">TensorflowÂÖ•Èó®</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E8%A7%86%E8%A7%89%E5%AF%BC%E8%88%AA%E7%BB%BC%E8%BF%B0/">
        
        
            <div class="article-image">
                <img src="/p/%E8%A7%86%E8%A7%89%E5%AF%BC%E8%88%AA%E7%BB%BC%E8%BF%B0/R-C.16e81f38818857b4f78ae52960801bb9_hua8e57d294448123456c3e7a479108155_17488_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ËßÜËßâÂØºËà™ÁªºËø∞"
                        
                        data-hash="md5-FugfOIGIV7T3iuUpYIAbuQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ËßÜËßâÂØºËà™ÁªºËø∞</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pytorch%E5%85%A5%E9%97%A8/">
        
        
            <div class="article-image">
                <img src="/p/pytorch%E5%85%A5%E9%97%A8/PyTorch.3467f8688ecab9a3a5a10b6adc491830_hu9f713ad84f2edfa72e78551edd5f644f_73867_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PytorchÂÖ•Èó®"
                        
                        data-hash="md5-NGf4aI7KuaOloQtq3EkYMA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PytorchÂÖ•Èó®</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E4%BC%A0%E7%BB%9F%E6%9C%BA%E5%99%A8%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/">
        
        
            <div class="article-image">
                <img src="/p/%E4%BC%A0%E7%BB%9F%E6%9C%BA%E5%99%A8%E8%A7%86%E8%A7%89%E5%9F%BA%E7%A1%80/R-C.d67e3b6f1bb78779f5bd074efaf98994_hu897fca54ae8e34409121667f57e687d2_226190_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ‰º†ÁªüÊú∫Âô®ËßÜËßâÂü∫Á°Ä"
                        
                        data-hash="md5-1n47bxu3h3n1vQdO&#43;vmJlA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">‰º†ÁªüÊú∫Âô®ËßÜËßâÂü∫Á°Ä</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/c%E8%AF%AD%E8%A8%80%E6%9D%82%E8%AE%B0/">
        
        
            <div class="article-image">
                <img src="/p/c%E8%AF%AD%E8%A8%80%E6%9D%82%E8%AE%B0/CLanguage.f870404c5bc35c1f21eb47034bf943e3_hu49e21fe23b7011216ea2a8bfb0c93686_71510_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post CËØ≠Ë®ÄÊùÇËÆ∞"
                        
                        data-hash="md5-&#43;HBATFvDXB8h60cDS/lD4w==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">CËØ≠Ë®ÄÊùÇËÆ∞</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="haoleng-Wick/haoleng-Wick.github.io"
    data-repo-id="R_kgDOLVRoiA"
    data-category="Announcements"
    data-category-id="DIC_kwDOLVRoiM4CeWbt"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('noborder_dark');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2023 - 
        
        2024 Ê¨¢ËøéÂâçÊù•Á™úÈó®Â≠ê
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.js"integrity="sha512-2R4VJGamBudpzC1NTaSkusXP7QkiUYvEKhpJAxeVCqLDsgW4OqtzorZGpulE3eEA7p&#43;&#43;U0ZYmqBwO3m&#43;R2hRjA=="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe-ui-default.min.js"integrity="sha512-SxO0cwfxj/QhgX1SgpmUr0U2l5304ezGVhc0AO2YwOQ/C8O67ynyTorMKGjVv1fJnPQgjdxRz6x70MY9r0sKtQ=="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdnjs.cloudflare.com/ajax/libs/vibrant.js/1.0.0/Vibrant.min.js"integrity="sha512-V6rhYmJy8NZQF8F0bhJiTM0iI6wX/FKJoWvYrCM15UIeb6p38HjvTZWfO0IxJnMZrHWUJZJqLuWK0zslra2FVw=="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<script src="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.css" crossorigin="anonymous" />
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>

    </body>
</html>
